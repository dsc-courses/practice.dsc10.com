# BEGIN PROB

Suppose we have another DataFrame called `trade_partners` that has a row
for every country that the United States trades with. `trade_partners`
is indexed by `"Country"` and has two columns:

-   The `"Proportion"` column contains `float`s representing the
    proportion of US imports coming from each country.

-   The `"Continent"` column contains the name of the continent where
    the country is located.

All countries in `tariffs` are included in `trade_partners` (including
`"European Union"`), but not all countries in `trade_partners` are
included in `tariffs`. The first three rows of `trade_partners` are
shown below.

<center><img src="../assets/images/sp25-midterm/trade_partners.jpg" width=300></center>

# BEGIN SUBPROB

Write one line of code to merge `tariffs` with `trade_partners` and
store the result in `merged`.

# BEGIN SOLUTION

**Answer:** `merged = tariffs.merge(trade_partners, left_on="Country", right_index=True)`

`tariffs` and `trade_partners` are both dataframes which correspond to the US's relationship with other Countries. Since both dataframes contain one row for each country we need to merge them with the column which corresponds to the country name. In `tariffs` that would be the `Country` column and in `trade_partners` that is the index. 

<average>80</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

How many rows does `merged` have?

# BEGIN SOLUTION

**Answer:** $50$

Since each DataFrame has exactly one row per country, the merged result will also have one row for every country they share. And because every country in `tariffs` appears in `trade_partners` (though not vice versa), the merged DataFrame will contain exactly as many rows as there are countries in `tariffs` (which is 50).

<average>83</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

In which of the following DataFrames does the `"Proportion"` column sum
to $1$? Select all that apply.

[ ] `trade_partners`
[ ] `trade_partners.groupby("Continent").mean()`
[ ] `trade_partners.groupby("Continent").sum()`
[ ] `merged`
[ ] None of the above.

# BEGIN SOLUTION

**Answer:** `trade_partners` and `trade_partners.groupby("Continent").sum()`

<average>88</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

Write one line of code that would produce an appropriate data
visualization showing the **median reciprocal tariff for each
continent**.

# BEGIN SOLUTION

**Answer:** `merged.groupby("Continent").median().plot(kind="barh", y="Reciprocal Tariff");`

<average>68</average>

# END SOLUTION

# END SUBPROB

# END PROB