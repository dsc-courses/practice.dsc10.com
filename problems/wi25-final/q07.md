# BEGIN PROB


Professor Minerva McGonagall, head of Gryffindor, may also be awarding
house points unfairly. For this question, we'll assume that all four of
the houses contain the same number of students, and we'll investigate
whether McGonagall awards points equally to all four houses.

Below is the distribution of points that Professor McGonagall awarded
during the last academic year.


<center><img src='../assets/images/wi25-final/points.png' width=400></center>


You want to test the following hypotheses:

-   **Null Hypothesis**: The distribution of points awarded by Professor
    McGonagall is uniform across all of the houses.

-   **Alternative Hypothesis**: The distribution of points awarded by
    Professor McGonagall is not uniform across all of the houses.

# BEGIN SUBPROB

Which of the following test statistics is appropriate for this
hypothesis test? Select all that apply.

[ ] The absolute difference between the number of points awarded to Gryffindor and the proposed proportion of points awarded to Gryffindor.
[ ] The difference between the number of points awarded to the house with the most points and the house with the least points.
[ ] The sum of the squared differences in proportions between McGonagall's distribution and `[0.5, 0.5, 0.5, 0.5]`.
[ ] The sum of the differences in proportions between McGonagall's distribution and `[0.25, 0.25, 0.25, 0.25]`.
[ ] The sum of the squared differences in proportions between McGonagall's distribution and `[0.25, 0.25, 0.25, 0.25]`.
[ ] None of the above.

# BEGIN SOLUTION

# END SOLUTION

# END SUBPROB

<center><img src='../assets/images/wi25-final/points.png' width=400></center>

For the rest of this problem, we will use the following test statistic:

::: center
**The sum of the absolute differences in proportions between
McGonagall's distribution and `[0.25, 0.25, 0.25, 0.25]`.**
:::

# BEGIN SUBPROB

Choose the correct way to implement the function `calculate_test_stat`,
which takes in two distributions as arrays and returns the value of this
test statistic.

        def calculate_test_stat(dist_1, dist_2):
            return _____

( ) `np.abs(sum(dist_1 - dist_2))`.
( ) `abs(sum(dist_1 - dist_2))`.
( ) `sum(np.abs(dist_1 - dist_2))`. 
( ) `sum(abs(dist_1 - dist_2))`.

# BEGIN SOLUTION

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

(10 pts) Fill in the blanks in the code below so that `simulated_ts` is
an array containing 10,000 simulated values of the test statistic under
the null. Note that your answer to blank `(c)` is **used in more than
one place** in the code.

        mc_gon = np.arange(__(a)__) # Careful: np.arange, not np.array!
        null = np.array([0.25, 0.25, 0.25, 0.25])
        observed_ts = calculate_test_stat(__(b)__)

        simulated_ts = np.array([])

        for i in np.arange(10000):
            sim = np.random.multinomial(__(c)__, __(d)__) / __(c)__
            one_simulated_ts = calculate_test_stat(__(e)__)
            simulated_ts = np.append(simulated_ts, one_simulated_ts)


What goes in blank (a)?
# BEGIN SOLUTION

**Answer:** 0.1, 0.5, 0.1 (or equivalent)

Based on the distribution shown in the bar chart above, we want our resulting array to contain the proportions `[0.4, 0.2, 0.3, 0.1]` (40/100 for Gryffindor, 20/100 for Hufflepuff, 30/100 for Ravenclaw, and 10/100 for Slytherin). Note that the order of these proportions does not matter because: 1) we are calculating the absolute difference between each value and the null proportion (0.25), and 2) we will sum all the differences together.

Since these proportions are incrementally increasing, we can use `np.arange()` to construct `mc_gon`. There are multiple correct approaches to this problem, as long as the resulting array contains all four proportions. Some alternative correct approaches include:
- `np.arange(0.4, 0.0, -0.1)`
- `np.arange(0.1, 0.41, 0.1)` (The middle argument can be any value greater than 0.4 and less than or equal to 0.5)

<average>57</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB
What goes in blank (b)?

# BEGIN SOLUTION

**Answer:** `null`, `mc_gon`

Note that the order of `mc_gon` and `null` does not matter, as `calculate_test_stat` calculates the absolute difference between the two.

<average>78</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB
What goes in blank (c)?

# BEGIN SOLUTION

**Answer:** 100

Blank (c) represents the total number of trials in each simulated sample. Using 100 ensures that each sample is large enough to approximate the expected proportions while maintaining computational efficiency. Additionally, (c) is used to divide all values, converting counts into proportions.

<average>48</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB
What goes in blank (d)?

# BEGIN SOLUTION

**Answer:** `null`

Blank (d) is null because each simulated sample is generated under the null hypothesis. This means the probabilities used in `np.random.multinomial` should match the expected proportions from the null distribution.

<average>77</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB
What goes in blank (e)?

# BEGIN SOLUTION

**Answer:** `sim`, `null`

Note that the order of `null` and `sim` does not matter, as `calculate_test_stat` calculates the absolute difference between the two.

<average>67</average>

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

Fill in the blank so that `reject_null` evaluates to `True` if we reject
the null hypothesis at the $0.05$ significance level, and `False`
otherwise.

        reject_null = __(f)__


# BEGIN SOLUTION

# END SOLUTION

# END SUBPROB

# BEGIN SUBPROB

Your friend performs the same hypothesis test as you, but uses the total
variation distance (TVD) as their test statistic instead of the one
described in the problem. Which of the following statements is true?

( ) Your friend's simulated statistics will be larger than yours, because TVD accounts for the magnitude *and* direction of the differences in proportions.
( ) Your friend's simulated statistics will be larger than yours, but **not** because it accounts for the magnitude and direction of the differences in proportions.
( ) Your friend's simulated statistics will be smaller than yours, because TVD accounts for the magnitude *and* direction of the differences in proportions.
( ) Your friend's simulated statistics will be smaller than yours, but **not** because it accounts for the magnitude and direction of the differences in proportions.
( ) There is no relationship between the statistic you used and the statistic your friend used (TVD).

# BEGIN SOLUTION

# END SOLUTION

# END SUBPROB

# END PROB