<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Extra Practice Session 2: Arrays, DataFrames, Querying and Grouping</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="..\assets\theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Extra Practice Session 2: Arrays, DataFrames, Querying
and Grouping</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc10.com</a></p>
<hr />
<p>Welcome! The problems shown below should be worked on <strong>on
paper</strong>, since the quizzes and exams you take in this course will
also be on paper. You do not need to submit your solutions anywhere.
<br><br>We encourage you to work through some of these problems in
groups during an extra practice session on Friday, January 19. Solutions
will be posted after all sessions have finished. This problem set is
meant to be a comprehensive collection of past questions on this week’s
course content. You won’t be able to get through all of them in one
session, and that’s okay! You can always come back to this page later
throughout the quarter if you need to review these concepts.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Consider the following assignment statement.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>puffin <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">21</span>])</span></code></pre></div>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>Provide arguments to call <code>np.arange</code> with so that the
array <code>penguin</code> is identical to the array
<code>puffin</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>penguin <span class="op">=</span> np.arange(____)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: We need to provide <code>np.arange</code>
with three arguments: 5, anything in <span class="math inline">(21,
25]</span>, 4. For instance, something line
<code>penguin = np.arange(5, 25, 4)</code> would work.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 90%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Fill in the blanks so that the array <code>parrot</code> is also
identical to the array <code>puffin</code>.<br />
<em>Hint: Start by choosing</em> <code>y</code> <em>so that</em>
<code>parrot</code> <em>has length 5.</em></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>parrot <span class="op">=</span> __(x)__ <span class="op">*</span> np.arange(<span class="dv">0</span>, __(y)__, <span class="dv">2</span>) <span class="op">+</span> __(z)__</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<ul>
<li><code>x</code>: <code>2</code></li>
<li><code>y</code>: anything in <span class="math inline">(8,
10]</span></li>
<li><code>z</code>: <code>5</code></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Suppose <code>students</code> is a DataFrame of all students who took
DSC 10 last quarter. <code>students</code> has one row per student,
where:</p>
<ul>
<li><p>The index contains students’ PIDs as strings starting with
<code>"A"</code>.</p></li>
<li><p>The <code>"Overall"</code> column contains students’ overall
percentage grades as floats.</p></li>
<li><p>The <code>"Animal"</code> column contains students’ favorite
animals as strings.</p></li>
</ul>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>What type is <code>students.get("Overall")</code>? If this expression
errors, select “this errors."</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> float</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> this errors</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Series</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 73%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>What type is <code>students.get("PID")</code>? If this expression
errors, select “this errors."</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> float</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> this errors</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: this errors</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 67%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p>Vanessa is one student who took DSC 10 last quarter. Her PID is
A12345678, she earned the sixth-highest overall percentage grade in the
class, and her favorite animal is the giraffe.</p>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Supposing that <code>students</code> is already sorted by
<code>"Overall"</code> in <strong>descending</strong> order, fill in the
blanks so that <code>animal_one</code> and <code>animal_two</code>
<strong>both</strong> evaluate to <code>"giraffe"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>animal_one <span class="op">=</span> students.get(__(x)__).loc[__(y)__]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>animal_two <span class="op">=</span> students.get(__(x)__).iloc[__(z)__]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<ul>
<li><code>x</code>: <code>"Animal"</code></li>
<li><code>y</code>: <code>"A12345678"</code></li>
<li><code>z</code>: <code>5</code></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.4">Problem 2.4</h3>
<p>If <code>students</code> wasn’t already sorted by
<code>"Overall"</code> in descending order, which of your answers would
need to change?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Neither <code>y</code> nor <code>z</code> would need to change</p></li>
<li><p><input type="radio" disabled="" /> Both <code>y</code> and <code>z</code> would need to change</p></li>
<li><p><input type="radio" disabled="" /> <code>y</code> only</p></li>
<li><p><input type="radio" disabled="" /> <code>z</code> only</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_4" aria-expanded="true" aria-controls="collapse2_4">
Click to view the solution.
</button>
</h2>
<div id="collapse2_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <code>z</code> only</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 82%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>The DataFrame <code>items</code> describes various items available to
collect or purchase using bells, the currency used in the game _Animal
Crossing: New Horizons.</p>
<p>For each item, we have:</p>
<ul>
<li><code>"Item" (str)</code>: The name of the item.</li>
<li><code>"Cost" (int)</code>: The cost of the item in bells. Items that
cost 0 bells cannot be purchased and must be collected through other
means (such as crafting).</li>
<li><code>"Location" (str)</code>: The store or action through which the
item can be obtained.</li>
</ul>
<p>The first 6 rows of <code>items</code> are below, though
<code>items</code> has more rows than are shown here.</p>
<center><img src="../../assets/images/fa23-quizzes/items.png" width=300></center>
<p><br><br></p>
<p>Fill in the blanks so that <code>count_1</code> and
<code>count_2</code> both evaluate to the number of items in
<code>items</code> with a <code>"Cost"</code> of 0.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>count_1 <span class="op">=</span> items.groupby(__(a)__).__(b)__().get(<span class="st">&quot;Item&quot;</span>).loc[__(c)__]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>count_2 <span class="op">=</span> items[__(d)__].shape[<span class="dv">0</span>]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="true" aria-controls="collapse3">
Click to view the solution.
</button>
</h2>
<div id="collapse3" class="accordion-collapse collapse collapse"
aria-labelledby="heading3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<ul>
<li><code>a</code>: <code>"Cost"</code></li>
<li><code>b</code>: <code>count</code></li>
<li><code>c</code>: <code>0</code></li>
<li><code>d</code>: <code>items.get("Cost") == 0</code></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 81%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>You are given a DataFrame called <code>sports</code>, indexed by
<code>'Sport'</code> containing one column,
<code>'PlayersPerTeam'</code>. The first few rows of the DataFrame are
shown below:</p>
<table>
<thead>
<tr class="header">
<th>Sport</th>
<th>PlayersPerTeam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>baseball</td>
<td>9</td>
</tr>
<tr class="even">
<td>basketball</td>
<td>5</td>
</tr>
<tr class="odd">
<td>field hockey</td>
<td>11</td>
</tr>
</tbody>
</table>
<p><br /> Which of the following evaluates to
<code>'basketball'</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>sports.loc[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.iloc[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.index[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sports.get('Sport').iloc[1]</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="true" aria-controls="collapse4">
Click to view the solution.
</button>
</h2>
<div id="collapse4" class="accordion-collapse collapse collapse"
aria-labelledby="heading4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>sports.index[1]</code></p>
<p>We are told that the DataFrame is indexed by <code>'Sport'</code> and
<code>'basketball'</code> is one of the elements of the index. To access
an element of the index, we use <code>.index</code> to extract the index
and square brackets to extract an element at a certain position.
Therefore, <code>sports.index[1]</code> will evaluate to
<code>'basketball'</code>.</p>
<p>The first two answer choices attempt to use <code>.loc</code> or
<code>.iloc</code> directly on a DataFrame. We typically use
<code>.loc</code> or <code>.iloc</code> on a Series that results from
using <code>.get</code> on some column. Although we don’t typically do
it this way, it is possible to use <code>.loc</code> or
<code>.iloc</code> directly on a DataFrame, but doing so would produce
an entire row of the DataFrame. Since we want just one word,
<code>'basketball'</code>, the first two answer choices must be
incorrect.</p>
<p>The last answer choice is incorrect because we can’t use
<code>.get</code> with the index, only with a column. The index is never
considered a column.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 88%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>Suppose you are given a DataFrame of employees for a given company.
The DataFrame, called <code>employees</code>, is indexed by
<code>'employee_id'</code> (string) with a column called
<code>'years'</code> (int) that contains the number of years each
employee has worked for the company.</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Suppose that the code</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>employees.sort_values(by<span class="op">=</span><span class="st">&#39;years&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).index[<span class="dv">0</span>]</span></code></pre></div>
<p>outputs <code>'2476'</code>.</p>
<p>True or False: The number of years that employee 2476 has worked for
the company is greater than the number of years that any other employee
has worked for the company.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> False</p>
<p>This is false because there could be other employees who worked at
the company equally long as employee 2476.</p>
<p>The code says that when the <code>employees</code> DataFrame is
sorted in descending order of <code>'years'</code>, employee 2476 is in
the first row. There might, however, be a tie among several employees
for their value of <code>'years'</code>. In that case, employee 2476 may
wind up in the first row of the sorted DataFrame, but we cannot say that
the number of years employee 2476 has worked for the company is greater
than the number of years that any other employee has worked for the
company.</p>
<p>If the statement had said <em>greater than or equal to</em> instead
of <em>greater than</em>, the statement would have been true.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 29%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>What will be the output of the following code?</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>employees.assign(start<span class="op">=</span><span class="dv">2021</span><span class="op">-</span>employees.get(<span class="st">&#39;years&#39;</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>employees.sort_values(by<span class="op">=</span><span class="st">&#39;start&#39;</span>).index.iloc[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> the employee id of an employee who has worked there for the most
years</p></li>
<li><p><input type="radio" disabled="" /> the employee id of an employee who has worked there for the fewest
years</p></li>
<li><p><input type="radio" disabled="" /> an error message complaining about <code>iloc[-1]</code></p></li>
<li><p><input type="radio" disabled="" /> an error message complaining about something else</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> an error message complaining about
something else</p>
<p>The problem is that the first line of code does not actually add a
new column to the <code>employees</code> DataFrame because the
expression is not saved. So the second line tries to sort by a column,
<code>'start'</code>, that doesn’t exist in the <code>employees</code>
DataFrame and runs into an error when it can’t find a column by that
name.</p>
<p>This code also has a problem with <code>iloc[-1]</code>, since
<code>iloc</code> cannot be used on the index, but since the problem
with the missing <code>'start'</code> column is encountered first, that
will be the error message displayed.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 27%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>Suppose <code>df</code> is a DataFrame and <code>b</code> is any
boolean array whose length is the same as the number of rows of
<code>df</code>.</p>
<p>True or False: For any such boolean array <code>b</code>,
<code>df[b].shape[0]</code> is less than or equal to
<code>df.shape[0]</code>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6" aria-expanded="true" aria-controls="collapse6">
Click to view the solution.
</button>
</h2>
<div id="collapse6" class="accordion-collapse collapse collapse"
aria-labelledby="heading6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> True</p>
<p>The brackets in <code>df[b]</code> perform a query, or filter, to
keep only the rows of <code>df</code> for which <code>b</code> has a
<code>True</code> entry. Typically, <code>b</code> will come from some
condition, such as the entry in a certain column of <code>df</code>
equaling a certain value. Regardless, <code>df[b]</code> contains a
subset of the rows of <code>df</code>, and <code>.shape[0]</code> counts
the number of rows, so <code>df[b].shape[0]</code> must be less than or
equal to <code>df.shape[0]</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>You are given a DataFrame called <code>books</code> that contains
columns <code>'author'</code> (string), <code>'title'</code> (string),
<code>'num_chapters'</code> (int), and <code>'publication_year'</code>
(int).</p>
<p>Suppose that after doing <code>books.groupby('Author').max()</code>,
one row says</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>author</th>
<th>title</th>
<th>num_chapters</th>
<th>publication_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Charles Dickens</td>
<td>Oliver Twist</td>
<td>53</td>
<td>1838</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p>Based on this data, can you conclude that Charles Dickens is the
alphabetically last of all author names in this dataset?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_1" aria-expanded="true" aria-controls="collapse7_1">
Click to view the solution.
</button>
</h2>
<div id="collapse7_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading7_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>When we group by <code>'Author'</code>, all books by the same author
get aggregated together into a single row. The aggregation function is
applied separately to each other column besides the column we’re
grouping by. Since we’re grouping by <code>'Author'</code> here, the
<code>'Author'</code>column never has the <code>max()</code> function
applied to it. Instead, each unique value in the <code>'Author'</code>
column becomes a value in the index of the grouped DataFrame. We are
told that the Charles Dickens row is just one row of the output, but we
don’t know anything about the other rows of the output, or the other
authors. We can’t say anything about where Charles Dickens falls when
authors are ordered alphabetically (but it’s probably not last!)</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote
<em>Oliver Twist</em>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_2" aria-expanded="true" aria-controls="collapse7_2">
Click to view the solution.
</button>
</h2>
<div id="collapse7_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading7_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Yes</p>
<p>Grouping by <code>'Author'</code> collapses all books written by the
same author into a single row. Since we’re applying the
<code>max()</code> function to aggregate these books, we can conclude
that <em>Oliver Twist</em> is alphabetically last among all books in the
<code>books</code> DataFrame written by Charles Dickens. So Charles
Dickens did write <em>Oliver Twist</em> based on this data.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.3">Problem 7.3</h3>
<p>Based on this data, can you conclude that <em>Oliver Twist</em> has
53 chapters?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_3" aria-expanded="true" aria-controls="collapse7_3">
Click to view the solution.
</button>
</h2>
<div id="collapse7_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading7_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>The key to this problem is that <code>groupby</code> applies the
aggregation function, <code>max()</code> in this case, independently to
each column. The output should be interpreted as follows:</p>
<ul>
<li>Among all books in <code>books</code> written by Charles Dickens,
<em>Oliver Twist</em> is the title that is alphabetically last.</li>
<li>Among all books in <code>books</code> written by Charles Dickens, 53
is the greatest number of chapters.</li>
<li>Among all books in <code>books</code> written by Charles Dickens,
1838 is the latest year of publication.</li>
</ul>
<p>However, the book titled <em>Oliver Twist</em>, the book with 53
chapters, and the book published in 1838 are not necessarily all the
same book. We cannot conclude, based on this data, that <em>Oliver
Twist</em> has 53 chapters.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.4">Problem 7.4</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote a
book with 53 chapters that was published in 1838?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_4" aria-expanded="true" aria-controls="collapse7_4">
Click to view the solution.
</button>
</h2>
<div id="collapse7_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading7_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>As explained in the previous question, the <code>max()</code>
function is applied separately to each column, so the book written by
Charles Dickens with 53 chapters may not be the same book as the book
written by Charles Dickens published in 1838.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 73%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p>You have a DataFrame called <code>prices</code> that contains
information about food prices at 18 different grocery stores. There is
column called <code>'broccoli'</code> that contains the price in dollars
for one pound of broccoli at each grocery store. There is also a column
called <code>'ice_cream'</code> that contains the price in dollars for a
pint of store-brand ice cream.</p>
<p><br></p>
<h3 id="problem-8.1">Problem 8.1</h3>
<p>What should <code>type(prices.get('broccoli').iloc[0])</code>
output?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int</p></li>
<li><p><input type="radio" disabled="" /> float</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_1" aria-expanded="true" aria-controls="collapse8_1">
Click to view the solution.
</button>
</h2>
<div id="collapse8_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading8_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> float</p>
<p>This code extracts the first entry of the <code>'broccoli'</code>
column. Since this column contains prices in dollars for a pound of
broccoli, it makes sense to represent such a price using a float,
because the price of a pound of broccoli is not necessarily an
integer.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 92%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p>One way to use <code>np.arange</code> to produce the sequence
<code>[2, 6, 10, 14]</code> is <code>np.arange(2, 15, 4)</code>. This
gives three inputs to np.arange.</p>
<p>Fill in the blanks below to show a different way to produce the same
sequence, this time using only one input to np.arange. Each blank below
must be filled in with a single number only, and the final result,
<code>x*np.arange(y)+z</code>, must produce the sequence
<code>[2, 6, 10, 14]</code>.</p>
<p>Using <code>x*np.arange(y)+z</code> fill in the missing values:</p>
<p><code>x = _</code></p>
<p><code>y = _</code></p>
<p><code>z = _</code></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9" aria-expanded="true" aria-controls="collapse9">
Click to view the solution.
</button>
</h2>
<div id="collapse9" class="accordion-collapse collapse collapse"
aria-labelledby="heading9" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong></p>
<p><code>x = 4</code>, <code>y = 4</code>, <code>z = 2</code></p>
<p>The question states that we are trying to create the sequence
<code>[2, 6, 10, 14]</code> by filling in the blanks for the statement
<code>x*np.arange(y)+z</code>. If we look at the sequence we are
attempting to derive, we can see that each step in the sequence
increments by 4. Similarly, we can see that the sequence begins at 2. We
know that passing an argument by itself in <code>np.arange</code> will
increment up to that number (for example <code>np.arange(4)</code> will
produce the sequence <code>[0,1,2,3]</code>). Knowing this, we can
create this sequence by setting y to 4. Attempting to reach the desired
sequence of <code>[2, 6, 10, 14]</code> from <code>[0, 1, 2, 3]</code>
we can multiply each number by 4 by setting x to 4 and instantiate the
sequence at 2 by setting z as 2.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 96%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p>You are given a table called books that contains columns
<code>'author'</code> (<code>str</code>), <code>'title'</code>
(<code>str</code>), <code>'num_chapters'</code> (<code>int</code>), and
<code>'publication_year'</code> (<code>int</code>). <br></p>
<h3 id="problem-10.1">Problem 10.1</h3>
<p>What will be the output of the following code?
<code>books.groupby(“publication_year”).mean().shape[1]</code></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>1</code></p></li>
<li><p><input type="radio" disabled="" /> <code>2</code></p></li>
<li><p><input type="radio" disabled="" /> <code>3</code></p></li>
<li><p><input type="radio" disabled="" /> <code>4</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_1" aria-expanded="true" aria-controls="collapse10_1">
Click to view the solution.
</button>
</h2>
<div id="collapse10_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading10_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>1</code></p>
<p>The output will return 1. Notice that the final function call is to
<code>.shape[1]</code>. We know that <code>.shape[1]</code> is a call to
see how many columns are in the resulting data frame. When we group by
publication year, there is only one column that will be aggregated by
the groupby call (which is the <code>'num_chapters'</code> column). The
other columns are string, and therefore, will not be aggregated in the
groupby call (since you can’t take the mean of a string). Consequently
<code>.shape[1]</code> will only result one column for the mean of the
<code>'num_chapters'</code> column.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 67%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p>King Triton, UCSD’s mascot, is quite the traveler! For this question,
we will be working with the <code>flights</code> DataFrame, which
details several facts about each of the flights that King Triton has
been on over the past few years. The first few rows of
<code>flights</code> are shown below.</p>
<center><img src='../assets/images/fa21-midterm/flights.png' width=40%></center>
<p><br></p>
<p>Here’s a description of the columns in <code>flights</code>:</p>
<ul>
<li><code>'DATE'</code>: the date on which the flight occurred. Assume
that there were no “redeye” flights that spanned multiple days.</li>
<li><code>'FLIGHT'</code>: the flight number. Note that this is not
unique; airlines reuse flight numbers on a daily basis.</li>
<li><code>'FROM'</code> and <code>'TO'</code>: the 3-letter airport code
for the departure and arrival airports, respectively. Note that it’s not
possible to have a flight from and to the same airport.</li>
<li><code>'DIST'</code>: the distance of the flight, in miles.</li>
<li><code>'HOURS'</code>: the length of the flight, in hours.</li>
<li><code>'SEAT'</code>: the kind of seat King Triton sat in on the
flight; the only possible values are <code>'WINDOW'</code>,
<code>'MIDDLE'</code>, and <code>'AISLE'</code>. <br><br></li>
</ul>
<h3 id="problem-11.1">Problem 11.1</h3>
<p>Which of these would it make sense to use as the index of
<code>flights</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'DATE'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FLIGHT'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FROM'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'TO'</code></p></li>
<li><p><input type="radio" disabled="" /> None of these are good choices for the index</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_1" aria-expanded="true" aria-controls="collapse11_1">
Click to view the solution.
</button>
</h2>
<div id="collapse11_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading11_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> None of these are good choices for the
index</p>
<p>When choosing an index, we have to make sure that the index is
different for each row of the DataFrame. The index in this case should
uniquely identify the flight.</p>
<p><code>'DATE'</code>does not uniquely identify a flight because there
are many different flights in a single day. <code>'FLIGHT'</code> does
not uniquely identify a flight because airlines reuse flight numbers on
a daily basis, as we are told in the data description. Neither
<code>'FROM'</code> nor <code>'TO'</code> uniquely identifies a flight,
as there are many flights each day that depart from each airport and
arrive at each airport.</p>
<p>Therefore, there is no single column that’s sufficient to uniquely
identify a flight, but if we could use multiple columns to create what’s
called a multi-index, we’d probably want to use <code>'DATE'</code> and
<code>'FLIGHT'</code> because each row of our DataFrame should have a
unique pair of values in these columns. That’s because airlines don’t
reuse flight numbers within a single day.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 57%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-11.2">Problem 11.2</h3>
<p>What type of variable is <code>'FLIGHT'</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Categorical</p></li>
<li><p><input type="radio" disabled="" /> Numerical</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_2" aria-expanded="true" aria-controls="collapse11_2">
Click to view the solution.
</button>
</h2>
<div id="collapse11_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading11_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Categorical</p>
<p><code>'FLIGHT'</code> is a categorical variable because it doesn’t
make sense to do arithmetic with the values in the <code>'FLIGHT'</code>
column. <code>'FLIGHT'</code> is just a label for each flight, and the
fact that it includes some numbers does not make it numerical. We could
have just as well used letter codes to distinguish flights.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 98%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-12">Problem 12</h2>
<p><br></p>
<h3 id="problem-12.1">Problem 12.1</h3>
<p>Which of these correctly evaluates to the number of flights King
Triton took to San Diego (airport code <code>'SAN'</code>)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>flights.loc['SAN'].shape[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[flights.get('TO') == 'SAN'].shape[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[flights.get('TO') == 'SAN'].shape[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>len(flights.sort_values('TO', ascending=False).loc['SAN'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading12_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12_1" aria-expanded="true" aria-controls="collapse12_1">
Click to view the solution.
</button>
</h2>
<div id="collapse12_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading12_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>flights[flights.get('TO') == 'SAN'].shape[0]</code></p>
<p>The strategy is to create a DataFrame with only the flights that went
to San Diego, then count the number of rows. The first step is to query
with the condition <code>flights.get('TO') == 'SAN'</code> and the
second step is to extract the number of rows with
<code>.shape[0]</code>.</p>
<p>Some of the other answer choices use <code>.loc['SAN']</code> but
<code>.loc</code> only works with the index, and <code>flights</code>
does not have airport codes in its index.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-12.2">Problem 12.2</h3>
<p>Fill in the blanks below so that the result also evaluates to the
number of flights King Triton took to San Diego (airport code
<code>'SAN'</code>).</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(__(a)__).count().get(<span class="st">&#39;FLIGHT&#39;</span>).__(b)__            </span></code></pre></div>
<p>What goes in blank (a)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'DATE'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FLIGHT'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FROM'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'TO'</code></p></li>
</ul>
<p>What goes in blank (b)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.index[-1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.loc['SAN']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.iloc['SAN']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.iloc[0]</code></p></li>
</ul>
<p>True or False: If we change <code>.get('FLIGHT')</code> to
<code>.get('SEAT')</code>, the results of the above code block will not
change. (You may assume you answered the previous two subparts
correctly.)</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading12_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12_2" aria-expanded="true" aria-controls="collapse12_2">
Click to view the solution.
</button>
</h2>
<div id="collapse12_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading12_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>'TO'</code>,
<code>.loc['SAN']</code>, True</p>
<p>The strategy here is to group all of King Triton’s flights according
to where they landed, and count up the number that landed in San Diego.
The expression <code>flights.groupby('TO').count()</code> evaluates to a
DataFrame indexed by arrival airport where, for any arrival airport,
each column has a count of the number of King Triton’s flights that
landed at that airport. To get the count for San Diego, we need the
entry in any column for the row corresponding to San Diego. The code
<code>.get('FLIGHT')</code> says we’ll use the <code>'FLIGHT'</code>
column, but any other column would be equivalent. To access the entry of
this column corresponding to San Diego, we have to use <code>.loc</code>
because we know the name of the value in the index should be
<code>'SAN'</code>, but we don’t know the row number or integer
position.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-12.3">Problem 12.3</h3>
<p>Consider the DataFrame <code>san</code>, defined below.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>san <span class="op">=</span> flights[(flights.get(<span class="st">&#39;FROM&#39;</span>) <span class="op">==</span> <span class="st">&#39;SAN&#39;</span>) <span class="op">&amp;</span> (flights.get(<span class="st">&#39;TO&#39;</span>) <span class="op">==</span> <span class="st">&#39;SAN&#39;</span>)]</span></code></pre></div>
<p>Which of these DataFrames <strong>must</strong> have the same number
of rows as <code>san</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'SAN') and (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'SAN') | (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading12_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12_3" aria-expanded="true" aria-controls="collapse12_3">
Click to view the solution.
</button>
</h2>
<div id="collapse12_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading12_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code></p>
<p>The DataFrame <code>san</code> contains all rows of
<code>flights</code> that have a departure airport of <code>'SAN'</code>
and an arrival airport of <code>'SAN'</code>. But as you may know, and
as you’re told in the data description, there are no flights from an
airport to itself. So <code>san</code> is actually an empty DataFrame
with no rows!</p>
<p>We just need to find which of the other DataFrames would necessarily
be empty, and we can see that
<code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code>
will be empty for the same reason.</p>
<p>Note that none of the other answer choices are correct. The first
option uses the Python keyword <code>and</code> instead of the symbol
<code>&amp;</code>, which behaves unexpectedly but does not give an
empty DataFrame. The second option will be non-empty because it will
contain all flights that have San Diego as the departure airport or
arrival airport, and we already know from the first few rows of
<code>flight</code> that there are some of these. The third option will
contain all the flights that King Triton has taken from
<code>'LAX'</code> to <code>'SAN'</code>. Perhaps he’s never flown this
route, or perhaps he has. This DataFrame could be empty, but it’s not
necessarily going to be empty, as the question requires.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 70%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-13">Problem 13</h2>
<p>Welcome to the Final Exam! In honor of the (at the time) brand-new
Comic-Con Museum that just opened at Balboa Park here in San Diego, this
exam will contain questions about various museums and zoos around the
world.</p>
<p>In this question, we’ll work with the DataFrame
<code>art_museums</code>, which contains the name, city, number of
visitors in 2019, and rank (based on number of visitors) for the 100
most visited art museums in 2019. The first few rows of
<code>art_museums</code> are shown below.</p>
<center><img src='../assets/images/fa21-final/art_museums.png' width=40%></center>
<p><br> <br><br></p>
<p>In this question, we’ll keep working with the
<code>art_museums</code> DataFrame.</p>
<p><br></p>
<h3 id="problem-13.1">Problem 13.1</h3>
<p>(Remember to keep the data description from the top of the exam open
in another tab!)</p>
<p><code>'Tate Modern'</code> is the most popular art museum in London.
But what’s the most popular art museum in each city?</p>
<p>It turns out that there’s no way to answer this easily using the
tools that you know about so far. To help, we’ve created a new Series
method, <code>.last()</code>. If <code>s</code> is a Series,
<code>s.last()</code> returns the last element of <code>s</code>
(i.e. the element at the very end of <code>s</code>).
<code>.last()</code> works with <code>.groupby</code>, too (just like
<code>.mean()</code> and <code>.count()</code>).</p>
<p>Fill in the blanks so that the code below correctly assigns
<code>best_per_city</code> to a DataFrame with one row per city, that
describes the name, number of visitors, and rank of the most visited art
museum in each city. <code>best_per_city</code> should be sorted in
decreasing order of number of visitors. The first few rows of
<code>best_per_city</code> are shown below.</p>
<center><img src='../assets/images/fa21-final/best_per_city.png' width=40%></center>
<p><br></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>best_per_city <span class="op">=</span> __(a)__.groupby(__(b)__).last().__(c)__</span></code></pre></div>
<ol type="1">
<li>What goes in blank (a)?</li>
<li>What goes in blank (b)?</li>
<li>What goes in blank (c)?</li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading13_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse13_1" aria-expanded="true" aria-controls="collapse13_1">
Click to view the solution.
</button>
</h2>
<div id="collapse13_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading13_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li><code>art_museums.sort_values('Visitors', ascending=True)</code></li>
<li><code>'City'</code></li>
<li><code>sort_values('Visitors', ascending=False)</code></li>
</ol>
<p>Let’s take a look at the completed implementation.</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>best_per_city <span class="op">=</span> art_museums.sort_values(<span class="st">'Visitors'</span>, ascending<span class="op">=</span><span class="va">True</span>).groupby(<span class="st">'City'</span>).last().sort_values(<span class="st">'Visitors'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>We first sort the row in <code>art_museums</code> by the number of
<code>'Visitors'</code> in <code>ascending</code> order. Then
<code>goupby('City')</code>, so that we have one row per city. Recall,
we need an aggregation method after using <code>groupby()</code>. In
this question, we use <code>last()</code> to only keep the one last row
for each city. Since in blank (a) we have sorted the rows by
<code>'Visitors'</code>, so <code>last()</code> keeps the row that
contains the name of the most visited museum in that city. At last we
sort this new DataFrame by <code>'Visitors'</code> in descending order
to fulfill the question’s requirement.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 65%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-13.2">Problem 13.2</h3>
<p>Assume you’ve defined <code>best_per_city</code> correctly.</p>
<p>Which of the following options evaluates to the number of visitors to
the most visited art museum in Amsterdam? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>best_per_city.get('Visitors').loc['Amsterdam']</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading13_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse13_2" aria-expanded="true" aria-controls="collapse13_2">
Click to view the solution.
</button>
</h2>
<div id="collapse13_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading13_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>best_per_city.get('Visitors').loc['Amsterdam']</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code>
(Select all except “None of the above”)</p>
<p><code>best_per_city.get('Visitors').loc['Amsterdam']</code> We first
use <code>.get(column_name)</code> to get a series with number of
visitors to the most visited art museum, and then locate the number of
visitors to the most visited art museum in Amsterdam using
<code>.loc[index]</code> since we have <code>"City"</code> as index.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>iloc[0]</code> to access the first and the only value in this
column.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>iloc[-1]</code> to access the last and the only value in this
column.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>loc['Amsterdam']</code> to access the value in this column with
index <code>'Amsterdam'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-14">Problem 14</h2>
<p>For the next several questions, we will work with a dataset
consisting of various skyscrapers in the US, which we’ve loaded into a
DataFrame called <code>sky</code>. The first few rows of
<code>sky</code> are shown below (though the full DataFrame has more
rows):</p>
<center><img src='../assets/images/wi22-midterm/sky.png' width=60%></center>
<p>&nbsp;</p>
<p>Each row of <code>sky</code> corresponds to a single skyscraper. For
each skyscraper, we have:</p>
<ul>
<li><p>its name, which is stored in the index of <code>sky</code>
(string)</p></li>
<li><p>the <code>'material'</code> it is made up of (string)</p></li>
<li><p>the <code>'city'</code> in the US where it is located
(string)</p></li>
<li><p>the number of <code>'floors'</code> (levels) it contains
(int)</p></li>
<li><p>its <code>'height'</code> in meters (float), and</p></li>
<li><p>the <code>'year'</code> in which it was opened (int)</p></li>
</ul>
<p>Note that the height of a floor may be different in each building.
<br><br></p>
<p>Below, identify the data type of the result of each of the following
expressions, or select “error” if you believe the expression results in
an error.</p>
<p><br></p>
<h3 id="problem-14.1">Problem 14.1</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_1" aria-expanded="true" aria-controls="collapse14_1">
Click to view the solution.
</button>
</h2>
<div id="collapse14_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p><code>sky</code> is a DataFrame. All the <code>sort_values</code>
method does is change the order of the rows in the Series/DataFrame it
is called on, it does not change the data structure. As such,
<code>sky.sort_values('height')</code> is also a DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 87%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.2">Problem 14.2</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).loc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_2" aria-expanded="true" aria-controls="collapse14_2">
Click to view the solution.
</button>
</h2>
<div id="collapse14_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> error</p>
<p><code>sky.sort_values('height')</code> is a DataFrame, and
<code>sky.sort_values('height').get('material')</code> is a Series
corresponding to the <code>'material'</code> column, sorted by
<code>'height'</code> in increasing order. So far, there are no
errors.</p>
<p>Remember, the <code>.loc</code> <em>accessor</em> is used to access
elements in a Series based on their index.
<code>sky.sort_values('height').get('material').loc[0]</code> is asking
for the element in the
<code>sky.sort_values('height').get('material')</code> Series with index
0. However, the index of <code>sky</code> is made up of building names.
Since there is no building named <code>0</code>, <code>.loc[0]</code>
causes an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.3">Problem 14.3</h3>
<div class="sourceCode" id="cb13"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_3" aria-expanded="true" aria-controls="collapse14_3">
Click to view the solution.
</button>
</h2>
<div id="collapse14_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p>As we mentioned above,
<code>sky.sort_values('height').get('material')</code> is a Series
containing values from the <code>'material'</code> column (but sorted).
Remember, there is no element in this Series with an index of 0, so
<code>sky.sort_values('height').get('material').loc[0]</code> errors.
However, <code>.iloc[0]</code> works differently than
<code>.loc[0]</code>; <code>.iloc[0]</code> will give us the first
element in a Series (independent of what’s in the index). So,
<code>sky.sort_values('height').get('material').iloc[0]</code> gives us
back a value from the <code>'material'</code> column, which is made up
of strings, so it gives us a string. (Specifically, it gives us the
<code>'material'</code> type of the skyscraper with the smallest
<code>'height'</code>.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.4">Problem 14.4</h3>
<div class="sourceCode" id="cb14"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;floors&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_4" aria-expanded="true" aria-controls="collapse14_4">
Click to view the solution.
</button>
</h2>
<div id="collapse14_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> int or float</p>
<p>The Series <code>sky.get('floors')</code> is made up of integers, and
<code>sky.get('floors').max()</code> evaluates to the largest number in
the Series, which is also an integer.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.5">Problem 14.5</h3>
<div class="sourceCode" id="cb15"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sky.groupby(<span class="st">&#39;material&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_5" aria-expanded="true" aria-controls="collapse14_5">
Click to view the solution.
</button>
</h2>
<div id="collapse14_5" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p>When grouping and using an aggregation method, the result is always a
DataFrame. The DataFrame <code>sky.groupby('material').max()</code>
contains all of the columns in <code>sky</code>, minus
<code>'material'</code>, which has been moved to the index. It contains
one row for each unique <code>'material'</code>.</p>
<p>Note that no columns were “dropped”, as may happen when using
<code>.mean()</code>, because <code>.max()</code> can work on Series’ of
any type. You can take the max of strings, while you cannot take the
mean of strings.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.6">Problem 14.6</h3>
<div class="sourceCode" id="cb16"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sky.index[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_6" aria-expanded="true" aria-controls="collapse14_6">
Click to view the solution.
</button>
</h2>
<div id="collapse14_6" class="accordion-collapse collapse collapse"
aria-labelledby="heading14_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p><code>sky.index</code> contains the values
<code>'Bayard-Condict Building'</code>,
<code>'The Yacht Club at Portofino'</code>,
<code>'City Investing Building'</code>, etc. <code>sky.index[0]</code>
is then <code>'Bayard-Condict Building'</code>, which is a string.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-15">Problem 15</h2>
<p>In this question, we’ll write code to learn more about the
skyscrapers in the beautiful city of San Diego. (Unrelated fun fact –
since the San Diego Airport is so close to downtown, buildings in
downtown San Diego legally cannot be taller than 152 meters.)</p>
<p><br></p>
<h3 id="problem-15.1">Problem 15.1</h3>
<p>Below, fill in the blank to create a DataFrame, named
<code>san_tall</code>, consisting of just the skyscrapers in San Diego
that are over 100 meters tall.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> ______</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>san_tall <span class="op">=</span> sky[(sky.get(<span class="st">&#39;city&#39;</span>) <span class="op">==</span> <span class="st">&#39;San Diego&#39;</span>) <span class="op">&amp;</span> condition]</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading15_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15_1" aria-expanded="true" aria-controls="collapse15_1">
Click to view the solution.
</button>
</h2>
<div id="collapse15_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading15_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>sky.get('height') &gt; 100</code></p>
<p>We need to query for all of the skyscrapers that satisfy two
conditions – the <code>'city'</code> must be <code>'San Diego'</code>
and the <code>'height'</code> must be above 100. The first condition was
already implemented for us, so we just need to construct a Boolean
Series that implements the second condition.</p>
<p>Here, we want all of the rows where <code>'height'</code> is above
100, so we <code>get</code> the <code>'height'</code> column and compare
it to 100 like so: <code>sky.get('height') &gt; 100</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-15.2">Problem 15.2</h3>
<p>Suppose <code>san_tall</code> from the previous part was created
correctly. Fill in the blanks so that <code>height_many_floors</code>
evaluates to the <strong>height (in meters)</strong> of the skyscraper
with the <strong>most floors</strong>, amongst all skyscrapers in San
Diego that are over 100 meters tall.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>height_many_floors <span class="op">=</span> san_tall.______.iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading15_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15_2" aria-expanded="true" aria-controls="collapse15_2">
Click to view the solution.
</button>
</h2>
<div id="collapse15_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading15_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>sort_values('floors', ascending=False).get('height')</code></p>
<p>The end of the line given to us is <code>.iloc[0]</code>. We know
that <code>.iloc[0]</code> extracts the first element in whatever Series
it is called on, so what comes before <code>.iloc[0]</code> must be a
Series where the first element is the <code>'height'</code> of the
skyscraper with the most floors, among all skyscrapers in San Diego that
are over 100 meters tall. The DataFrame we are working with,
<code>san_tall</code>, already only has skyscrapers in San Diego that
are over 100 meters tall.</p>
<p>This means that in the blank, all we need to do is:</p>
<ol type="1">
<li>Sort skyscrapers by <code>'floors'</code> in decreasing order (so
that the first row is the skyscraper with the most
<code>'floors'</code>).</li>
<li>Extract the <code>'height'</code> column.</li>
</ol>
<p>As such, a complete answer is
<code>height_many_floors = san_tall.sort_values('floors', ascending=False).get('height').iloc[0]</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-15.3">Problem 15.3</h3>
<p><code>height_many_floors</code>, the value you computed in the
previous part (2.2) was a number.</p>
<p><strong>True or False:</strong> Assuming that the DataFrame
<code>san_tall</code> contains all skyscrapers in San Diego,
<code>height_many_floors</code> is the height (in meters) of the
<strong>tallest</strong> skyscraper in San Diego.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading15_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15_3" aria-expanded="true" aria-controls="collapse15_3">
Click to view the solution.
</button>
</h2>
<div id="collapse15_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading15_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> False</p>
<p><code>height_many_floors</code> is the height of the skyscraper with
the most <code>'floors'</code>. However, this is not necessarily the
tallest skyscraper (i.e. the skyscraper with the largest
<code>'height'</code>)! Consider the following scenario:</p>
<ul>
<li>Building A: 15 floors, height of 150 feet</li>
<li>Building B: 20 floors, height of 100 feet</li>
</ul>
<p><code>height_many_floors</code> would be 100, but it is not the
<code>'height'</code> of the taller building.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-16">Problem 16</h2>
<p>For this question, we will use data from the 2021 Women’s National
Basketball Association (WNBA) season for the next several problems. In
basketball, players score points by shooting the ball into a hoop. The
team that scores the most points wins the game.</p>
<p>Kelsey Plum, a WNBA player, attended La Jolla Country Day School,
which is adjacent to UCSD’s campus. Her current team is the Las Vegas
Aces (three-letter code <code>'LVA'</code>). <strong>In 2021, the Las
Vegas Aces played 31 games, and Kelsey Plum played in all
31.</strong></p>
<p>The DataFrame <code>plum</code> contains her stats for all games the
Las Vegas Aces played in 2021. The first few rows of <code>plum</code>
are shown below (though the full DataFrame has 31 rows, not 5):</p>
<center><img src='../assets/images/wi22-final/plum.png' width=40%></center>
<p>Each row in <code>plum</code> corresponds to a single game. For each
game, we have:</p>
<ul>
<li><code>'Date'</code> (<code>str</code>), the date on which the game
was played</li>
<li><code>'Opp'</code> (<code>str</code>), the three-letter code of the
opponent team</li>
<li><code>'Home'</code> (<code>bool</code>), <code>True</code> if the
game was played in Las Vegas (“home”) and <code>False</code> if it was
played at the opponent’s arena (“away”)</li>
<li><code>'Won'</code> (<code>bool</code>), <code>True</code> if the Las
Vegas Aces won the game and <code>False</code> if they lost</li>
<li><code>'PTS'</code> (<code>int</code>), the number of points Kelsey
Plum scored in the game</li>
<li><code>'AST'</code> (<code>int</code>), the number of assists
(passes) Kelsey Plum made in the game</li>
<li><code>'TOV'</code> (<code>int</code>), the number of turnovers
Kelsey Plum made in the game (a turnover is when you lose the ball –
turnovers are bad!) <br><br></li>
</ul>
<h3 id="problem-16.1">Problem 16.1</h3>
<p>There is exactly one team in the WNBA that Plum’s team did not win
any games against during the 2021 season. Fill in the blanks below so
that <code>never_beat</code> evaluates to a string containing the
three-letter code of that team.</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>never_beat <span class="op">=</span> plum.groupby(__(a)__).<span class="bu">sum</span>().__(b)__</span></code></pre></div>
<ol type="1">
<li><p>What goes in blank (a)?</p></li>
<li><p>What goes in blank (b)?</p></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading16_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse16_1" aria-expanded="true" aria-controls="collapse16_1">
Click to view the solution.
</button>
</h2>
<div id="collapse16_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading16_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ol type="1">
<li><p><code>'Opp'</code></p></li>
<li><p><code>sort_values('Won').index[0]</code></p></li>
</ol>
<p>The key insight here is that the values in the <code>'Won'</code>
column are Boolean, and when Boolean values are used in arithmetic they
are treated as 1s (<code>True</code>) and 0s (<code>False</code>). The
<code>sum</code> of several <code>'Won'</code> values is the same as the
number of wins.</p>
<p>If we group <code>plum</code> by <code>'Opp'</code> and use
<code>.sum()</code>, the resulting <code>'Won'</code> column contains
the number of wins that Plum’s team had against each unique opponent. If
we sort this DataFrame by <code>'Won'</code> in increasing order (which
is the default behavior of <code>sort_values</code>), the row at the top
will correspond to the <code>'Opp'</code> that Plum’s team had no wins
against. Since we grouped by <code>'Opp'</code>, team names are stored
in the index, so <code>.index[0]</code> will give us the name of the
desired team.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 67%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-17">Problem 17</h2>
<p>In addition to the <code>plum</code> DataFrame, we also have access
to the <code>season</code> DataFrame, which contains statistics on all
players in the WNBA in the 2021 season. The first few rows of
<code>season</code> are shown below. (Remember to keep the data
description from the top of the exam open in another tab!)</p>
<center><img src='../assets/images/wi22-final/seasons.png' width=40%></center>
<p>Each row in <code>season</code> corresponds to a single player. For
each player, we have: - <code>'Player'</code> (<code>str</code>), their
name - <code>'Team'</code> (<code>str</code>), the three-letter code of
the team they play on - <code>'G'</code> (<code>int</code>), the number
of games they played in the 2021 season - <code>'PPG'</code>
(<code>float</code>), the number of points they scored per game played -
<code>'APG'</code> (<code>float</code>), the number of assists (passes)
they made per game played - <code>'TPG'</code> (<code>float</code>), the
number of turnovers they made per game played</p>
<p>Note that all of the numerical columns in <code>season</code> must
contain values that are greater than or equal to 0.</p>
<p><br></p>
<h3 id="problem-17.1">Problem 17.1</h3>
<p>Which of the following is the best choice for the index of
<code>season</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'Player'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'Team'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'G'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'PPG'</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading17_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse17_1" aria-expanded="true" aria-controls="collapse17_1">
Click to view the solution.
</button>
</h2>
<div id="collapse17_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading17_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>'Player'</code></p>
<p>Ideally, the index of a DataFrame is unique, so that we can use it to
“identify” the rows. Here, each row is about a player, so
<code>'Player'</code> should be the index. <code>'Player'</code> is the
only column that is likely to be unique; it is possible that two players
have the same name, but it’s still a <em>better</em> choice of index
than the other three options, which are definitely not unique.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-18">Problem 18</h2>
<p><center><img src='../assets/images/sp22-midterm/cartoon.png' width=20%></center></p>
<p>Included is a DataFrame named <code>sungod</code> that contains
information on the artists who have performed at Sun God in years past.
<strong>For each year that the festival was held, we have one row for
each artist that performed that year.</strong> The columns are:</p>
<ul>
<li><code>'Year'</code> (<code>int</code>): the year of the
festival</li>
<li><code>'Artist'</code> (<code>str</code>): the name of the
artist</li>
<li><code>'Appearance_Order'</code> (<code>int</code>): the order in
which the artist appeared in that year’s festival (1 means they came
onstage first)</li>
</ul>
<p>The rows of <code>sungod</code> are arranged in <strong>no particular
order</strong>. The first few rows of <code>sungod</code> are shown
below (though <code>sungod</code> has <strong>many more rows</strong>
than pictured here).</p>
<center><img src='../assets/images/sp22-midterm/sungod.png' width=30%></center>
<p>Assume:</p>
<ul>
<li><p>Only one artist ever appeared at a time (for example, we can’t
have two separate artists with a <code>'Year'</code> of 2015 and an
<code>'Appearance_Order'</code> of 3).</p></li>
<li><p>An artist may appear in multiple different Sun God festivals
(they could be invited back).</p></li>
<li><p>We have already run <code>import babypandas as bpd</code> and
<code>import numpy as np</code>. <br><br></p></li>
</ul>
<p>Which of the following is a valid reason <strong>not</strong> to set
the index of <code>sungod</code> to <code>'Artist'</code>?
<strong>Select all correct answers.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Two different artists have the same name.</p></li>
<li><p><input type="checkbox" disabled="" /> An artist performed at Sun God in more than one year.</p></li>
<li><p><input type="checkbox" disabled="" /> Several different artists performed at Sun God in the same year.</p></li>
<li><p><input type="checkbox" disabled="" /> Many different artists share the same value of
<code>'Appearance_Order'</code>.</p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading18">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse18" aria-expanded="true" aria-controls="collapse18">
Click to view the solution.
</button>
</h2>
<div id="collapse18" class="accordion-collapse collapse collapse"
aria-labelledby="heading18" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Two different artists have the same name.,
An artist performed at Sun God in more than one year.</p>
<p>For this question, it is crucial to know that an index should not
contain duplicate values, so we need to consider reasons why
<code>'Artist'</code> might contain two values that are the same. Let’s
go through the answer choices in order.</p>
<p>For the first option, if two different artists had the same name,
this would lead to duplicate values in the <code>'Artist'</code> column.
Therefore, this is a valid reson not to index <code>sungod</code> by
<code>'Artist'</code>.</p>
<p>For the second option, if one artist performed at Sun God in more
than one year, their name would appear multiple times in the
<code>'Artist'</code> column, once for each year they performed. This
would also be a valid reason not to index <code>sungod</code> by
<code>'Artist'</code>.</p>
<p>For the third option, if several different artists performed at Sun
God in the same year, that would not necessarily create duplicates in
the <code>'Artist'</code> column, unless of course two of the artists
had the same name, which we’ve already addressed in the first answer
choice. This is not a valid reason to avoid indexing <code>sungod</code>
by <code>'Artist'</code>.</p>
<p>For the last answer choice, if many different artists share the same
value of <code>'Appearance_Order'</code>, this would not create
duplicates in the <code>'Artist'</code> column. Therefore, this is also
not a valid reason to avoid indexing <code>sungod</code> by
<code>'Artist'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 83%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-19">Problem 19</h2>
<p>Suppose in a new cell, we type the following.</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>    sungod.sort_values(by<span class="op">=</span><span class="st">&#39;Year&#39;</span>)</span></code></pre></div>
<p>After we run that cell, we type the following in a second cell.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>    sungod.get(<span class="st">&#39;Artist&#39;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>What is the output when we run the second cell? Note that the first
Sun God festival was held in 1983.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'Blues Traveler'</code></p></li>
<li><p><input type="radio" disabled="" /> The artist who appeared on stage first in 1983.</p></li>
<li><p><input type="radio" disabled="" /> An artist who appeared in 1983, but not necessarily the one who
appeared first.</p></li>
<li><p><input type="radio" disabled="" /> Not enough information to tell.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19" aria-expanded="true" aria-controls="collapse19">
Click to view the solution.
</button>
</h2>
<div id="collapse19" class="accordion-collapse collapse collapse"
aria-labelledby="heading19" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>'Blues Traveler'</code></p>
<p>In the first cell, although we seem to be sorting <code>sungod</code>
by <code>'Year'</code>, we aren’t actually changing the DataFrame
<code>sungod</code> at all because we don’t save the sorted DataFrame.
Remember that DataFrame methods don’t actually change the underlying
DataFrame unless you explicitly make that happen by saving the output as
the name of the DataFrame. So the first <code>'Artist'</code> name will
still be <code>'Blues Traveler'</code>.</p>
<p>Suppose we had saved the sorted DataFrame as in the code below.</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>    sungod <span class="op">=</span> sungod.sort_values(by<span class="op">=</span><span class="st">'Year'</span>)   </span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>    sungod.get(<span class="st">'Artist'</span>).iloc[<span class="dv">0</span>]</span></code></pre>
</div>
<p>In this case, the output would be the name of an artist who appeared
in 1983, but not necessarily the one who appeared first. There will be
several artists associated with the year 1983, and we don’t know which
of them will be first in the sorted DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 12%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-20">Problem 20</h2>
<p>Write one line of code below to create a DataFrame called
<code>openers</code> containing the artists that appeared first on stage
at a past Sun God festival. The DataFrame <code>openers</code> should
have all the same columns as <code>sungod</code>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading20">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse20" aria-expanded="true" aria-controls="collapse20">
Click to view the solution.
</button>
</h2>
<div id="collapse20" class="accordion-collapse collapse collapse"
aria-labelledby="heading20" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>openers = sungod[sungod.get('Appearance_Order')==1]</code></p>
<p>Since we want only certain rows of <code>sungod</code>, we need to
query. The condition to satisfy is that the ‘Appearance_Order’ column
should have a value of 1 to indicate that this artist performed first in
a certain year’s festival.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-21">Problem 21</h2>
<p>What was the largest number of artists that ever performed in a
single Sun God festival? <strong>Select all expressions that evaluate to
the correct answer.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Appearance_Order').count().get('Year').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Year').count().get('Artist').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.get('Appearance_Order').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Year').max().get('Year').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading21">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse21" aria-expanded="true" aria-controls="collapse21">
Click to view the solution.
</button>
</h2>
<div id="collapse21" class="accordion-collapse collapse collapse"
aria-labelledby="heading21" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>sungod.groupby('Year').count().get('Artist').max()</code>,
<code>sungod.get('Appearance_Order').max()</code></p>
<p>Let’s go through all the answer choices.</p>
<p>For the first option,
<code>sungod.groupby('Appearance_Order').count()</code> will create a
DataFrame with one row for each unique value of
<code>'Appearance_Order'</code>, and each column will contain the same
value, which represents the number of Sun God festivals that had at
least a certain amount of performers. For example, the first row of
<code>sungod.groupby('Appearance_Order').count()</code> will correspond
to an <code>'Appearance_Order'</code> of 1, and each column will contain
a count of the number of Sun God festivals with at least one performer.
Since every festival has at least one performer, the largest count in
any column, including <code>'Year'</code> will be in this first row. So
<code>sungod.groupby('Appearance_Order').count().get('Year').max()</code>
represents the total number of Sun God festivals, which is not the
quantity we’re trying to find.</p>
<p>For the second option, <code>sungod.groupby('Year').count()</code>
will create a DataFrame with one row per year, with each column
containing a count of the number of artists that performed in that
year’s festival. If we take the largest such count in any one column, we
are finding the largest number of artists that ever performed in a
single Sun God festival. Therefore,
<code>sungod.groupby('Year').count().get('Artist').max()</code> is
correct.</p>
<p>The third option works because we can find the desired quantity by
simply looking for the largest value in the
<code>'Appearance_Order'</code> column. For example, if the largest
number of artists to ever perform in a Sun God festival was, say, 17,
then for that year’s festival, the last artist to appear would have a
value of 17 in the <code>'Appearance_Order'</code> column. There can be
no 18 anywhere in the <code>'Appearance_Order'</code> column, otherwise
that would mean there was some festival with 18 performers. Therefore,
<code>sungod.get('Appearance_Order').max()</code> is correct.</p>
<p>The fourth option is not even correct Python code. The DataFrame
produced by <code>sungod.groupby('Year').max()</code> is indexed by
<code>'Year'</code> and no longer has <code>'Year'</code> as a column.
So we’d get an error if we tried to access this nonexistent column, as
in <code>sungod.groupby('Year').max().get('Year')</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-22">Problem 22</h2>
<p>IKEA is a Swedish furniture company that designs and sells
ready-to-assemble furniture and other home furnishings. IKEA has
locations worldwide, including one in San Diego. IKEA is known for its
cheap prices, modern designs, huge showrooms, and wordless instruction
manuals. They also sell really good Swedish meatballs in their cafe!</p>
<p>Here are the DataFrames you’ll be working with:</p>
<ol type="1">
<li><code>ikea</code></li>
</ol>
<p>The <code>ikea</code> DataFrame has a row for each ready-to-assemble
IKEA furniture product. The columns are:</p>
<ul>
<li><code>'product'</code> (<code>str</code>): the name of the product,
which includes the product line as the first word, followed by a
description of the product</li>
<li><code>'category'</code> (<code>str</code>): a categorical
description of the type of product</li>
<li><code>'price'</code> (<code>int</code>): the current price of the
product, in dollars</li>
<li><code>'assembly_cost'</code> (<code>int</code>): the additional cost
to have the product assembled, in dollars</li>
<li><code>'packages'</code> (<code>int</code>): the number of packages
in which the product is boxed</li>
</ul>
<p>The first few rows of <code>ikea</code> are shown below, though
<code>ikea</code> has many more rows than pictured.</p>
<center><img src='../assets/images/sp22-final/ikeadf.png' height=250></center>
<p><br></p>
<ol start="2" type="1">
<li><code>app_data</code></li>
</ol>
<p>An IKEA fan created an app where people can log the amount of time it
took them to assemble their IKEA furniture. The DataFrame
<code>app_data</code> has a row for each product build that was logged
on the app. The columns are:</p>
<ul>
<li><code>'product'</code> (<code>str</code>): the name of the product,
which includes the product line as the first word, followed by a
description of the product</li>
<li><code>'category'</code> (<code>str</code>): a categorical
description of the type of product</li>
<li><code>'assembly_time'</code> (<code>str</code>): the amount of time
to assemble the product, formatted as <code>'x hr, y min'</code> where
<code>x</code> and <code>y</code> represent integers, possibly zero</li>
<li><code>'minutes'</code> (<code>int</code>): integer values
representing the number of minutes it took to assemble each product</li>
</ul>
<p>The first few rows of <code>app_data</code> are shown below, though
<code>app_data</code> has many more rows than pictured (5000 rows
total).</p>
<center><img src='../assets/images/sp22-final/appdatadf.png' height=180></center>
<p><br></p>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>.</p>
<p><br><br></p>
<p>Complete the expression below so that it evaluates to the name of the
product for which the average assembly cost per package is lowest.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(ikea.assign(assembly_per_package <span class="op">=</span> ___(a)___)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;assembly_per_package&#39;</span>).___(b)___)</span></code></pre></div>
<p><br></p>
<h3 id="problem-22.1">Problem 22.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_1" aria-expanded="true" aria-controls="collapse22_1">
Click to view the solution.
</button>
</h2>
<div id="collapse22_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading22_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>ikea.get('assembly_cost')/ikea.get('packages')</code></p>
<p>This column, as its name suggests, contains the average assembly cost
per package, obtained by dividing the total cost of each product by the
number of packages that product comes in. This code uses the fact that
arithmetic operations between two Series happens element-wise.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-22.2">Problem 22.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_2" aria-expanded="true" aria-controls="collapse22_2">
Click to view the solution.
</button>
</h2>
<div id="collapse22_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading22_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>get('product').iloc[0]</code></p>
<p>After adding the <code>'assembly_per_package'</code> column and
sorting by that column in the default ascending order, the product with
the lowest <code>'assembly_per_package'</code> will be in the very first
row. To access the name of that product, we need to <code>get</code> the
column containing product names and use <code>iloc</code> to access an
element of that Series by integer position.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 66%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-23">Problem 23</h2>
<p>Complete the expression below so that it evaluates to a DataFrame
indexed by <code>'category'</code> with one column called
<code>'price'</code> containing the median cost of the products in each
category.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ikea.___(a)___.get(___(b)___)</span></code></pre></div>
<p><br></p>
<h3 id="problem-23.1">Problem 23.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading23_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse23_1" aria-expanded="true" aria-controls="collapse23_1">
Click to view the solution.
</button>
</h2>
<div id="collapse23_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading23_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>groupby('category').median()</code></p>
<p>The question prompt says that the resulting DataFrame should be
indexed by <code>'category'</code>, so this is a hint that we may want
to group by <code>'category'</code>. When using <code>groupby</code>, we
need to specify an aggregation function, and since we’re looking for the
median cost of all products in a category, we use the
<code>.median()</code> aggregation function.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 90%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-23.2">Problem 23.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading23_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse23_2" aria-expanded="true" aria-controls="collapse23_2">
Click to view the solution.
</button>
</h2>
<div id="collapse23_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading23_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>['price']</code></p>
<p>The question prompt also says that the resulting DataFrame should
have just one column, the <code>'price'</code> column. To keep only
certain columns in a DataFrame, we use <code>.get</code>, passing in a
list of columns to keep. Remember to include the square brackets,
otherwise <code>.get</code> will return a Series instead of a
DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-24">Problem 24</h2>
<p>Recall that an IKEA fan created an app for people to log the amount
of time it takes them to assemble an IKEA product. We have this data in
<code>app_data</code>.</p>
<p><br></p>
<h3 id="problem-24.1">Problem 24.1</h3>
<p>Suppose that when someone downloads the app, the app requires them to
choose a username, which must be different from all other registered
usernames.</p>
<p><strong>True or False</strong>: If <code>app_data</code> had included
a column with the username of the person who reported each product
build, it would make sense to index <code>app_data</code> by
username.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading24_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse24_1" aria-expanded="true" aria-controls="collapse24_1">
Click to view the solution.
</button>
</h2>
<div id="collapse24_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading24_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> False</p>
<p>Even though people must have distinct usernames, one person can build
multiple different IKEA products and log their time for each build. So
we don’t expect every row of <code>app_data</code> to have a distinct
username associated with it, and therefore username would not be
suitable as an index, since the index should have distinct values.
</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>The average score on this problem was
52%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-24.2">Problem 24.2</h3>
<p>What does the code below evaluate to?</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(app_data.take(np.arange(<span class="dv">4</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>         .sort_values(by<span class="op">=</span><span class="st">&#39;assembly_time&#39;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         .get(<span class="st">&#39;assembly_time&#39;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         .iloc[<span class="dv">0</span>])</span></code></pre></div>
<p><em>Hint:</em> The <code>'assembly_time'</code> column contains
strings.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading24_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse24_2" aria-expanded="true" aria-controls="collapse24_2">
Click to view the solution.
</button>
</h2>
<div id="collapse24_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading24_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>'1 hr, 45 min'</code></p>
<p>The code says that we should take the first four rows of
<code>app_data</code> (which we can see in the preview at the start of
this exam), sort the rows in ascending order of
<code>'assembly_time'</code>, and extract the very first entry of the
<code>'assembly_time'</code> column. In other words, we have to find the
<code>'assembly_time'</code> value that would be first when sorted in
ascending order. As given in the hint, the <code>'assembly_time'</code>
column contains strings, and strings get sorted alphabetically, so we
are looking for the assembly time, among the first four, that would come
first alphabetically. This is <code>'1 hr, 45 min'</code>.</p>
<p>Note that first alphabetically does not correspond to the least
amount of time. <code>'1 hr, 5 min'</code> represents less time than
<code>'1 hr, 45 min'</code>, but in alphabetical order
<code>'1 hr, 45 min'</code> comes before <code>'1 hr, 5 min'</code>
because both start with the same characters <code>'1 hr, '</code> and
comparing the next character, <code>'4'</code> comes before
<code>'5'</code>. </p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>The average score
on this problem was 46%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-25">Problem 25</h2>
<p>For Problem 1 we will be using this DataFrame:</p>
<p>The American Kennel Club (AKC) organizes information about dog
breeds. We’ve loaded their dataset into a DataFrame called
<code>df</code>. The index of <code>df</code> contains the dog breed
names as <code>str</code> values.</p>
<p>The columns are:</p>
<ul>
<li><code>'kind' (str)</code>: the kind of dog (herding, hound, toy,
etc.). There are six total kinds.</li>
<li><code>'size' (str)</code>: small, medium, or large.</li>
<li><code>'longevity' (float)</code>: typical lifetime (years).</li>
<li><code>'price' (float)</code>: average purchase price (dollars).</li>
<li><code>'kids' (int)</code>: suitability for children. A value of
<code>1</code> means high suitability, <code>2</code> means medium, and
<code>3</code> means low.</li>
<li><code>'weight' (float)</code>: typical weight (kg).</li>
<li><code>'height' (float)</code>: typical height (cm).</li>
</ul>
<p>The rows of <code>df</code> are arranged in <strong>no particular
order</strong>. The first five rows of <code>df</code> are shown below
(though <code>df</code> has <strong>many more rows</strong> than
pictured here).</p>
<center><img src='../assets/images/su22-final/df.png' width=90%></center>
<p>Assume: - We have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>.</p>
<p><br><br></p>
<p>The following code computes the breed of the cheapest toy dog.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df[__(a)__].__(b)__.__(c)__</span></code></pre></div>
<p><br></p>
<h3 id="problem-25.1">Problem 25.1</h3>
<p>Fill in part (a).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading25_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse25_1" aria-expanded="true" aria-controls="collapse25_1">
Click to view the solution.
</button>
</h2>
<div id="collapse25_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading25_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>df.get('kind') == 'toy'</code></p>
<p>To find the cheapest toy dog, we can start by narrowing down our
dataframe to only include dogs that are of kind toy. We do this by
constructing the following boolean condition:
<code>df.get('kind') == 'toy'</code>, which will check whether a dog is
of kind toy (i.e. whether or not a given row’s <code>'kind'</code> value
is equal to <code>'toy'</code>). As a result,
<code>df[df.get('kind') == 'toy']</code> will retrieve all rows for
which the <code>'kind'</code> column is equal to <code>'toy'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-25.2">Problem 25.2</h3>
<p>Fill in part (b).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading25_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse25_2" aria-expanded="true" aria-controls="collapse25_2">
Click to view the solution.
</button>
</h2>
<div id="collapse25_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading25_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.sort_values('price')</code></p>
<p>Next, we can sort the resulting dataframe by price, which will make
the minimum price (i.e. the cheapest toy dog) easily accessible to us
later on. To sort the dataframe, simply use <code>.sort_values()</code>,
with parameter <code>'price'</code> as follows:
<code>.sort_values('price')</code></p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-25.3">Problem 25.3</h3>
<p>Which of the following can fill in blank (c)? <strong>Select all that
apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>loc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>index[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>min()</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading25_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse25_3" aria-expanded="true" aria-controls="collapse25_3">
Click to view the solution.
</button>
</h2>
<div id="collapse25_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading25_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>index[0]</code></p>
<ul>
<li><code>loc[0]</code>: <code>loc</code> retrieves an element by the
row label, which in this case is by <code>'breed'</code>, not by index
value. Furthermore, <code>loc</code> actually returns the entire row,
which is not what we are looking for. (Note that we are trying to find
the singular <code>'breed'</code> of the cheapest toy dog.)<br/>
</li>
<li><code>iloc[0]</code>: While <code>iloc</code> does retrieve elements
by index position, <code>iloc</code> actually returns the entire row,
which is not what we are looking for.</li>
<li><code>index[0]</code>: Note that since <code>'breed'</code> is the
index column of our dataframe, and since we have already filtered and
sorted the dataframe, simply taking the <code>'breed'</code> at index 0,
or <code>index[0]</code> will return the <code>'breed'</code> of the
cheapest toy dog.</li>
<li><code>min()</code>: <code>min()</code> is a method used to find the
smallest value on a series not a dataframe.</li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 81%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-26">Problem 26</h2>
<p>The following code computes an array containing the unique kinds of
dogs that are heavier than 20 kg <strong>or</strong> taller than 40 cm
on average.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> df.__(a)__.__(b)__</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>np.array(foo[__(c)__].__d__)</span></code></pre></div>
<p><br></p>
<h3 id="problem-26.1">Problem 26.1</h3>
<p>Fill in blank (a).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_1" aria-expanded="true" aria-controls="collapse26_1">
Click to view the solution.
</button>
</h2>
<div id="collapse26_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading26_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>groupby('kind')</code></p>
<p>We start this problem by grouping the dataframe by
<code>'kind'</code> since we’re only interested in whether each unique
<code>'kind'</code> of dog fits some sort of constraint. We don’t quite
perform querying yet since we need to group the DataFrame first. In
other words, we first need to group the DataFrame into each
<code>'kind'</code> before we could apply any sort of boolean
conditionals.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 97%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.2">Problem 26.2</h3>
<p>Fill in blank (b).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_2" aria-expanded="true" aria-controls="collapse26_2">
Click to view the solution.
</button>
</h2>
<div id="collapse26_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading26_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.mean()</code></p>
<p>After we do <code>.groupby('kind')</code>, we need to apply
<code>.mean()</code> since the problem asks if each unique
<code>'kind'</code> of dog satisfies certain constraints <strong>on
average</strong>. <code>.mean()</code> calculates the average of each
column of each group which is what we want.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.3">Problem 26.3</h3>
<p>Fill in blank (c).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_3" aria-expanded="true" aria-controls="collapse26_3">
Click to view the solution.
</button>
</h2>
<div id="collapse26_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading26_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>(foo.get('weight') &gt; 20 | foo.get(</code>height<code>) &gt; 40)</code></p>
<p>Once we have grouped the dogs by <code>'kind'</code> and have
calculated the average stats of each kind of dog, we can do some
querying with two conditionals: <code>foo.get('weight') &gt; 20</code>
gets the kinds of dogs that are heavier than 20 kg on average and
<code>foo.get('height') &gt; 40)</code> gets the kinds of dogs that are
taller than 40 cm on average. We combine these two conditions with the
<code>|</code> operator since we want the kind of dogs that satisfy
either condition.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 93%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.4">Problem 26.4</h3>
<p>Which of the following should fill in blank (d)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.unique()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get('kind')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get(['kind'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_4" aria-expanded="true" aria-controls="collapse26_4">
Click to view the solution.
</button>
</h2>
<div id="collapse26_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading26_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.index</code></p>
<p>Note that earlier, we did <code>groupby('kind')</code>, which
automatically sets each unique <code>'kind'</code> as the index. Since
this is what we want anyways, simply doing <code>.index</code> will give
us all the kinds of dogs that satisfy the given conditions.</p>
<p></p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>The average score on this problem was
94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-27">Problem 27</h2>
<p>Answer the following true/false questions.</p>
<p><br></p>
<h3 id="problem-27.1">Problem 27.1</h3>
<p><code>df.groupby("kind").mean()</code> will have 5 columns.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_1" aria-expanded="true" aria-controls="collapse27_1">
Click to view the solution.
</button>
</h2>
<div id="collapse27_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading27_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> True</p>
<p>Referring to <code>df</code> at the beginning of the exam, we could
see that 5 of the columns have numerical values as inputs, and thus
<code>df.groupby("kind").mean()</code> will return the mean of these 5
numerical columns</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-28">Problem 28</h2>
<p>In September 2020, Governor Gavin Newsom announced that by 2035, all
new vehicles sold in California must be zero-emissions vehicles.
Electric vehicles (EVs) are among the most popular zero-emissions
vehicles (though other examples include plug-in hybrids and hydrogen
fuel cell vehicles).</p>
<center><img src='../assets/images/fa22-midterm/data22.png' width=20%></center>
<p><br></p>
<p>The DataFrame <code>evs</code> consists of <strong>32</strong> rows,
each of which contains information about a different EV model.</p>
<ul>
<li><code>"Brand"</code> (str): The vehicle’s manufacturer.</li>
<li><code>"Model"</code> (str): The vehicle’s model name.</li>
<li><code>"BodyStyle"</code> (str): The vehicle’s body style.</li>
<li><code>"Seats"</code> (int): The vehicle’s number of seats.</li>
<li><code>"TopSpeed"</code> (int): The vehicle’s top speed, in
kilometers per hour.</li>
<li><code>"Range"</code> (int): The vehicle’s range, or distance it can
travel on a single charge, in kilometers.</li>
</ul>
<p>The first few rows of <code>evs</code> are shown below (though
remember, <code>evs</code> has 32 rows total).</p>
<center><img src='../assets/images/fa22-midterm/form22.png' width=60%></center>
<p><br></p>
<p>Assume that:</p>
<ul>
<li>The only four values in the <code>"Brand"</code> column are
<code>"Tesla"</code>, <code>"BMW"</code>, <code>"Audi"</code>, and
<code>"Nissan"</code>.</li>
<li>We have already run <code>import babypandas as bpd</code> and
<code>import numpy as np</code>.</li>
</ul>
<p><br><br></p>
<p>Suppose we’ve run the following line of code. ​</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> evs.groupby(<span class="st">&quot;Brand&quot;</span>).count()</span></code></pre></div>
<p><br></p>
<h3 id="problem-28.1">Problem 28.1</h3>
<p>What value does <code>counts.get("Range").sum()</code> evaluate
to?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading28_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse28_1" aria-expanded="true" aria-controls="collapse28_1">
Click to view the solution.
</button>
</h2>
<div id="collapse28_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading28_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 32</p>
<p><code>counts</code> is a DataFrame with one row per
<code>"Brand"</code>, since we grouped by <code>"Brand"</code>. Since we
used the <code>.count()</code> aggregation method, the columns in
<code>counts</code> will all be the same – they will all contain the
number of rows in <code>evs</code> for each <code>"Brand"</code>
(i.e. they will all contain the distribution of <code>"Brand"</code>).
If we sum up the values in any one of the columns in
<code>counts</code>, then, the result will be the total number of rows
in <code>evs</code>, which we know to be 32. Thus,
<code>counts.get("Range").sum()</code> is 32.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 56%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-28.2">Problem 28.2</h3>
<p>What value does <code>counts.index[3]</code> evaluate to?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading28_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse28_2" aria-expanded="true" aria-controls="collapse28_2">
Click to view the solution.
</button>
</h2>
<div id="collapse28_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading28_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>"Tesla"</code></p>
<p>Since we grouped by <code>"Brand"</code> to create
<code>counts</code>, the index of <code>counts</code> will be
<code>"Brand"</code>, sorted alphabetically (this sorting happens
automatically when grouping). This means that <code>counts.index</code>
will be the array-like sequence
<code>["Audi", "BMW", "Nissan", "Tesla"]</code>, and
<code>counts.index[3]</code> is <code>"Tesla"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 33%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-29">Problem 29</h2>
<p>Consider the following incomplete assignment statement.</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> evs______.mean()</span></code></pre></div>
<p>In each part, fill in the blank above so that result evaluates to the
specified quantity.</p>
<p><br></p>
<h3 id="problem-29.1">Problem 29.1</h3>
<p>A DataFrame, indexed by <code>"Brand"</code>, whose
<code>"Seats"</code> column contains the average number of
<code>"Seats"</code> per <code>"Brand"</code>. (The DataFrame may have
other columns in it as well.)</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading29_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse29_1" aria-expanded="true" aria-controls="collapse29_1">
Click to view the solution.
</button>
</h2>
<div id="collapse29_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading29_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>.groupby("Brand")</code></p>
<p>When we group by a column, the resulting DataFrame contains one row
for every unique value in that column. The question specified that we
wanted some information <em>per</em> <code>"Brand"</code>, which implies
that grouping by <code>"Brand"</code> is necessary.</p>
<p>After grouping, we need to use an aggregation method. Here, we wanted
the resulting DataFrame to be such that the <code>"Seats"</code> column
contained the average number of <code>"Seats"</code> per
<code>"Brand"</code>; this is accomplished by using
<code>.mean()</code>, which is already done for us.</p>
<p>Note: With the provided solution, the resulting DataFrame also has
other columns. For instance, it has a <code>"Range"</code> column that
contains the average <code>"Range"</code> for each <code>"Brand"</code>.
That’s fine, since we were told that the resulting DataFrame may have
other columns in it as well. If we wanted to ensure that the only column
in the resulting DataFrame was <code>"Seats"</code>, we could have used
<code>.get(["Brand", "Seats"])</code> before grouping, though this was
not necessary.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-29.2">Problem 29.2</h3>
<p>A number, corresponding to the average <code>"TopSpeed"</code> of all
EVs manufactured by Audi in evs</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading29_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse29_2" aria-expanded="true" aria-controls="collapse29_2">
Click to view the solution.
</button>
</h2>
<div id="collapse29_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading29_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>[evs.get("Brand") == "Audi"].get("TopSpeed")</code></p>
<p>There are two parts to this problem:</p>
<ol type="1">
<li><p>Querying, to make sure that we only keep the rows corresponding
to Audis. This is accomplished by:</p>
<ul>
<li>Using <code>evs.get("Brand") == "Audi"</code> to create a Boolean
Series, with <code>True</code>s for the rows we want to keep and
<code>False</code>s for the other rows.</li>
<li>Using Boolean indexing to keep only the rows in which the
aforementioned Series is <code>True</code>. This is accomplished by
<code>evs[evs.get("Brand") == "Audi"]</code> (though the
<code>evs</code> part at the front was already provided).</li>
</ul></li>
<li><p>Accessing the <code>"TopSpeed"</code> column. This is
accomplished by using <code>.get("TopSpeed")</code>.</p></li>
</ol>
<p>Then, <code>evs[evs.get("Brand") == "Audi"].get("TopSpeed")</code> is
a Series contaning the <code>"TopSpeed"</code>s of all Audis, and mean
of this Series is the result we’re looking for. The call to
<code>.mean()</code> was already provided for us.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 77%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-30">Problem 30</h2>
<p>Tropical cyclones, such as hurricanes, are storms characterized by
high wind speeds. These storms can cause great devastation when they
make landfall. In the US, the National Hurricane Center (NHC) is the
government entity responsible for tracking and predicting these tropical
weather systems. The NHC names tropical storms of sufficient intensity,
using a list of people’s names that gets reused every six years. For
example, there have been many different storms named Cindy, all
occurring in different years. We’ll assume that no tropical storm has
ever spanned more than one calendar year.</p>
<p>The DataFrame <code>storms</code> contains information about all
named tropical storms in the Atlantic Ocean between 1965 and 2015. Each
row corresponds to a data entry describing the storm at a particular
moment in time, and one storm usually has many data entries throughout
the duration of the storm. The columns of <code>storms</code> are as
follows.</p>
<ul>
<li><code>"Name"</code> (<code>str</code>): The name of the storm.</li>
<li><code>"Date"</code> (<code>int</code>): The year, month, and day of
the data entry, stored as an 8-digit integer. For example,
<code>20151113</code> corresponds to November 13, 2015.</li>
<li><code>"Time"</code> (<code>str</code>): The time of the data
entry.</li>
<li><code>"Status"</code> (<code>str</code>): A categorical variable
describing the intensity of the storm at the time of the data entry.
There are many possible values, for example <code>"TD"</code> stands for
“tropical depression” and <code>"TS"</code> stands for “tropical
storm.”</li>
<li><code>"Latitude"</code> (<code>str</code>): The latitude of the
center of the storm at the time of the data entry. Describes the
north-south location of the storm.</li>
<li><code>"Longitude"</code> (<code>str</code>): The longitude of the
center of the storm at the time of the data entry. Describes the
east-west location of the storm.</li>
</ul>
<p>A preview of <code>storms</code> is shown below.</p>
<center><img src='../assets/images/wi23-midterm/df.jpg' width=45%></center>
<p><br></p>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>. <br><br></p>
<h3 id="problem-30.1">Problem 30.1</h3>
<p>Which column would be an appropriate index for storms?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'Name'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'Date'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'Time'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'Latitude'</code></p></li>
<li><p><input type="radio" disabled="" /> None of these</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading30_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse30_1" aria-expanded="true" aria-controls="collapse30_1">
Click to view the solution.
</button>
</h2>
<div id="collapse30_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading30_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> None of these.</p>
<p>An index should be unique. In this case <code>'Name'</code>,
<code>'Date'</code>, <code>'Time'</code>, and <code>'Latitude'</code>
have repetative values, which does <strong>not</strong> make them
unique. Remember <code>'Name'</code> will be reused every six years,
multiple hurricanes could happen on the same date, time, or
latitude.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-31">Problem 31</h2>
<p><br></p>
<h3 id="problem-31.1">Problem 31.1</h3>
<p>The DataFrame <code>amelia</code> was created by the code below, and
is shown in its entirety.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>amelia <span class="op">=</span> (storms[(storms.get(<span class="st">&quot;Name&quot;</span>) <span class="op">==</span> <span class="st">&quot;AMELIA&quot;</span>) <span class="op">&amp;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>         (storms.get(<span class="st">&quot;Year&quot;</span>) <span class="op">==</span> <span class="dv">1978</span>)]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         .get([<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Status&quot;</span>, <span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>]))</span></code></pre></div>
<center><img src='../assets/images/wi23-midterm/q3_wi23-midterm.png' width=45%></center>
<p><br></p>
<p>Use the space provided to show the DataFrame that results from</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>        amelia.groupby(<span class="st">&quot;Status&quot;</span>).<span class="bu">max</span>()</span></code></pre></div>
<p>The column labels should go in the top row, and the row labels
(index) should go in the leftmost row. You may not need to use all the
rows and columns provided.</p>
<center><img src='../assets/images/wi23-midterm/empty_table.png' width=45%></center>
<p><br></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_1" aria-expanded="true" aria-controls="collapse31_1">
Click to view the solution.
</button>
</h2>
<div id="collapse31_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading31_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<table>
<thead>
<tr class="header">
<th>Status</th>
<th>Year</th>
<th>Month</th>
<th>Day</th>
<th>Time</th>
<th>Latitude</th>
<th>Longtitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TD</td>
<td>1978</td>
<td>8</td>
<td>31</td>
<td>6pm</td>
<td>29.3N</td>
<td>99.2W</td>
</tr>
<tr class="even">
<td>TS</td>
<td>1978</td>
<td>7</td>
<td>31</td>
<td>6am</td>
<td>28.0N</td>
<td>98.2W</td>
</tr>
</tbody>
</table>
<p>Remember that calling <code>.groupby('column name')</code> sets the
column name to the index. This means the <code>'Status'</code> column
will become the new bolded index, which is found in the leftmost column
of the data frame. Another thing to know is Python will organize strings
in the <strong>index</strong> in alphabetical order, so for example
<code>TS</code> and <code>TD</code> both start with <code>T</code>, but
<code>D</code> comes sooner in the alphabet than <code>S</code>, which
makes row <code>TD</code> come <strong>before</strong> row
<code>TS</code>.</p>
<p>Next it is important to look at the <code>.max()</code>, which tells
us that we want the maximum element of each column that correspond to
the unique <code>'Status'</code>. Recall how <code>.max()</code>
interacts with strings: <code>.max()</code> will organize strings in the
columns in descending order, so the last alphabetically/numerically.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 59%.</p>
<p><average></average></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-32">Problem 32</h2>
<p><br></p>
<h3 id="problem-32.1">Problem 32.1</h3>
<p>Suppose there are <code>n</code> different storms included in
<code>storms</code>. Say we create a new DataFrame from
<code>storms</code> by adding a column called <code>'Duration'</code>
that contains the number of minutes since the first data entry for that
storm, as an <code>int</code>. The first few rows of this new DataFrame
are shown below.</p>
<center><img src='../assets/images/wi23-midterm/q4_wi23-midterm.png' width=60%></center>
<p><br></p>
<p>Next we sort this DataFrame in ascending order of
<code>'Duration'</code> and save the result as
<code>storms_by_duration</code>. Which of the following statements must
be true? <strong>Select all that apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> The first <code>n</code> rows of <code>storms_by_duration</code> will
all correspond to different storms, because they will contain the first
reading from each storm in the data set.</p></li>
<li><p><input type="checkbox" disabled="" /> The last <code>n</code> rows of <code>storms_by_duration</code> will
all correspond to different storms, because they will contain the last
reading from each storm in the data set.</p></li>
<li><p><input type="checkbox" disabled="" /> <code>storms_by_duration</code> will contain exactly n rows.</p></li>
<li><p><input type="checkbox" disabled="" /> <code>len(storms_by_duration.take(np.arange(n)).get("Name").unique())</code>
will evaluate to <code>n</code>.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_1" aria-expanded="true" aria-controls="collapse32_1">
Click to view the solution.
</button>
</h2>
<div id="collapse32_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading32_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> “The first <code>n</code> rows of
<code>storms_by_duration</code> will all correspond to different storms,
because they will contain the first reading from each storm in the data
set.”</p>
<p>Let’s first analyze the directions. According to the directions, we
added the column <code>'Duration'</code>, so we know how long each storm
lasted. Then we sorted the DataFrame in ascending order, which will put
the storms with the shortest duration at the top.</p>
<p>Each row will be tied to a unique storm because each storm can only
have one minimum. This means <code>storms_by_duration</code>’s first
<code>n</code> rows will contain the shortest duration for each unique
storm, which corresponds to the first option.</p>
<p><strong>Option 2:</strong> This is incorrect because even though the
DataFrame is sorted in ascending order it is possible for a storm to
have multiple close values in <code>'Duration'</code>, which does not
guarantee unique storms in the last <code>n</code> rows. For example if
you had the storm <code>'alice'</code>, which one time had a duration of
60 and the longest duration of 62. The values will be sorted such that
60 will come before 62, but they are within the last <code>n</code>
values of the DataFrame, causing <code>'alice'</code> to appear
twice.</p>
<p><strong>Option 3:</strong> This is incorrect because there can be
more than <code>n</code> rows. It is possible that a storm appears
multiple times. For example the storm <code>Anna</code> occured three
different times on August 21, 1965 without sorting.</p>
<p><strong>Option 4:</strong> This is incorrect. The code written will
take the first <code>n</code> rows of the table, get the names, and find
the number of unique named storms. Names are not unique, so it is
possible for the storms to share the same name. This can be seen in the
DataFrame example above.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 66%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-33">Problem 33</h2>
<p>The DataFrame <code>games</code> contains information about a sample
of popular games, including board games, dice games, and card games. The
data comes from Board Game Geek, a popular website and vibrant online
community for game enthusiasts.</p>
<p>The columns of games are as follows.</p>
<ul>
<li><code>"Name"</code> (<code>str</code>): The name of the game.</li>
<li><code>"Mechanics"</code> (<code>str</code>): A sequence of
descriptors for how the game is played. A game can have several
descriptors, each of which is separated by a comma.</li>
<li><code>"Domains"</code> (<code>str</code>): A sequence of domains to
which the game belongs. A game can belong to multiple domains.</li>
<li><code>"Play Time"</code> (<code>int</code>): The average play time
of the game, in minutes, as suggested by the game’s creators.</li>
<li><code>"Complexity"</code> (<code>float</code>): The average
complexity of the game, on a scale of 1 to 5 points, as reported by
Board Game Geek community members.</li>
<li><code>"Rating"</code> (<code>str</code>): The average rating of the
game, on a scale of 1 to 10 points, as rated by Board Game Geek
community members. Note that while this data should be numerical, it is
actually stored as a string, because some entries use a comma in place
of a decimal point. For example 8,79 actually represents the number
8.79.</li>
<li><code>"BGG Rank"</code> (<code>int</code>): The rank of the game in
Board Game Geek’s database. The formula for how this rank is calculated
is not publicly known, but it likely includes many factors, such as
<code>"Rating"</code>, number of registered owners of the game, and
number of reviews.</li>
</ul>
<p>The first few rows of <code>games</code> are shown below (though
<code>games</code> has many more rows than pictured here).</p>
<center><img src='../assets/images/wi23-final/preview.jpg' width=100%></center>
<p><br></p>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>. <br><br></p>
<p>You are unsure whether it would make sense to use
<code>"BGG Rank"</code> as the index of the <code>games</code>
DataFrame, because you are unsure whether this column has duplicate
values. Perhaps, for example, two games are tied and both have a rank of
6.</p>
<p>Select all of the expressions below that evaluate to True when the
<code>"BGG Rank"</code> column could be used as the index (no
duplicates), and False when it could not be used as the index
(duplicates). In other words, these are the expressions that can be used
to detect the presence of duplicate values.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>(games.get("BGG Rank") - np.arange(games.shape[0])).max() == 1</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.groupby("BGG Rank").count().get("Name").max() == 1</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.shape[0] - len(np.unique(games.get("BGG Rank"))) == 0</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.get("BGG Rank").max() - games.shape[0] == 0</code></p></li>
</ul>
<p><strong>Note:</strong> We will not set the index of
<code>games</code>, instead we’ll leave it with the default index.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading33">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse33" aria-expanded="true" aria-controls="collapse33">
Click to view the solution.
</button>
</h2>
<div id="collapse33" class="accordion-collapse collapse collapse"
aria-labelledby="heading33" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Options 2 and 3</p>
<p><strong>Option 2:</strong>
<code>games.groupby(“BGG Rank”).count()</code> gets all of the unique
<code>“BGG Rank”</code>’s and puts them into the index. Then by using
the aggregate function <code>.count()</code> we are able to turn all the
remaining columns into the number of times each <code>“BGG Rank”</code>
appears. Since all of the columns are the same we just need to get one
of them to access the counts. In this case we get the column “Name” by
doing <code>.get(“Name”)</code>. Finally, when we do
<code>.max() == 1</code> we are checking to see if the maximum count for
the number of unique <code>“BGG Rank”</code>’s is one, which would mean
there are no duplicates.</p>
<p><strong>Option 3:</strong> Let’s work from the inside out for this
line of code: <code>len(np.unique(games.get(“BGG Rank”)))</code>. Like
all the others we are getting a Series of <code>“BGG Rank”</code>.
<code>np.unique()</code> gives us an array with unique elements inside
of the Series. When we do <code>len()</code> we are figuring out how
many unique elements there are inside of <code>“BGG Rank”</code>. Recall
<code>games.shape[0]</code> gets us the number of rows in
<code>games</code>. This means that we are trying to see if the number
of rows is the same as the number of unique elements inside of
<code>“BGG Rank”</code>, and if they are then that means they are all
unique and should equal 0.</p>
<p><strong>Option 1:</strong> <code>games.get(“BGG Rank”)</code> will
get you a Series of the <code>“BGG Rank”</code> column.
<code>np.arange(games.shape[0])</code> will create a numpy array that
will go from zero to <code>games.shape[0]</code>, which is the number of
rows in the <code>games</code> DataFrame. So it would look something
like: <code>arr([0, 1, 2, . . ., n])</code>, where <code>n</code> is the
number of rows in <code>games</code>. By doing:
<code>games.get(“BGG Rank”) - np.arange(games.shape[0])</code> one is
decreasing each rank by an increasing factor of one each time. This
essentially gives a Series of numbers, but it doesn’t actually have
anything to do with uniqueness. We are simply finding if the difference
between <code>“BGG Rank”</code> and the numpy array leads to a maximum
of 1. So although the code works it does not tell us if there are
duplicates.</p>
<p><strong>Option 4:</strong> <code>games.get(“BGG Rank”).max()</code>
will give us the maximum element inside of <code>“BGG Rank”</code>.
Note, <code>games.shape[0]</code> gets us the number of rows in
<code>games</code>. We should never make assumptions about what is
inside of <code>“BGG Rank”</code>. This means we don’t know if the
values line up nicely like: 1, 2, 3, . . . <code>games.shape[0]</code>,
so the maximum element could be unique, but be bigger than
<code>games.shape[0]</code>. Knowing this, when we do the whole line for
Option 4 it is not guaranteed to be zero when <code>“BGG Rank”</code> is
unique or not, so it does not detect duplicates.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-34">Problem 34</h2>
<p>Recall, at the start of the quarter, you were asked to complete a
Welcome Survey to tell us about your background coming into the course.
You were also asked to share seemingly irrelevant details, like the
number of followers you have on Instagram and the number of unread
emails in your primary email account. Well, those details are no longer
irrelevant – in this exam, we will work with the data from this
quarter’s Welcome Survey!</p>
<p>Each row in the DataFrame <code>survey</code> represents one student
in DSC 10. The information stored in the columns of <code>survey</code>
are as follows:</p>
<ul>
<li><code>"Section"</code> (<code>str</code>): The lecture section the
student is enrolled in (either <code>"A"</code> or
<code>"B"</code>).</li>
<li><code>"IG Followers"</code> (<code>int</code>): The number of
followers the student has on Instagram. If the student does not have an
Instagram account, this number is 0.</li>
<li><code>"Unread Emails"</code> (<code>int</code>): The number of
unread emails in the student’s primary email account.</li>
<li><code>"College"</code> (<code>str</code>): The college the student
is a member of (either <code>"ERC"</code>, <code>"Marshall"</code>,
<code>"Muir"</code>, <code>"Revelle"</code>, <code>"Seventh"</code>,
<code>"Sixth"</code> or <code>"Warren"</code>).</li>
<li><code>"Major"</code> (<code>str</code>): The student’s primary
major, in major code form. For instance, the major code for the Data
Science major is <code>"DS25"</code>.</li>
<li><code>"Class Standing"</code> (<code>str</code>): The student’s
class standing (either <code>"Freshman"</code>,
<code>"Sophomore"</code>, <code>"Junior"</code>, or
<code>"Senior"</code>).</li>
</ul>
<p>The first few rows of <code>survey</code> are shown below, though
<code>survey</code> has many more rows than are pictured below (since
there are more than 5 students in DSC 10 this quarter).</p>
<center><img src='../assets/images/sp23-midterm/df-preview.png' width=60%></center>
<p><br></p>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>. <br><br></p>
<h3 id="problem-34.1">Problem 34.1</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_1" aria-expanded="true" aria-controls="collapse34_1">
Click to view the solution.
</button>
</h2>
<div id="collapse34_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: DataFrame</p>
<p>The method <code>.sort_values(by="Class Standing")</code> sorts the
<code>survey</code> DataFrame by the <code>"Class Standing"</code>
column and returns a new DataFrame (without modifying the original one).
The resulting DataFrame will be sorted by class standing in ascending
order unless specified otherwise by providing the
<code>ascending=False</code> argument.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-34.2">Problem 34.2</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_2" aria-expanded="true" aria-controls="collapse34_2">
Click to view the solution.
</button>
</h2>
<div id="collapse34_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: DataFrame</p>
<p>The method <code>.sort_values(by="Class Standing")</code> sorts the
<code>survey</code> DataFrame based on the entries in the
<code>"Class Standing"</code> column and produces a new DataFrame.
Following this, <code>.groupby("College")</code> organizes the sorted
DataFrame by grouping entries using the <code>"College"</code> column.
After that, the <code>.count()</code> aggregation method computes the
number of rows for each <code>"College"</code>. The result is a
DataFrame whose index contains the unique values in
<code>"College"</code> and whose columns all contain the same values –
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>.</p>
<p>Note that if we didn’t sort before grouping – that is, if our
expression was just <code>survey.groupby("College").count()</code> – the
resulting DataFrame would be the same! That’s because the order of the
rows in <code>survey</code> does not impact the number of rows in
<code>survey</code> that belong to each <code>"College"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 93%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-34.3">Problem 34.3</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_3" aria-expanded="true" aria-controls="collapse34_3">
Click to view the solution.
</button>
</h2>
<div id="collapse34_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Series</p>
<p>The above expression, before <code>.get("IG Followers")</code>, is
the same as in the previous subpart. We know that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>).groupby(<span class="st">"College"</span>).count()</span></code></pre>
</div>
<p>is a DataFrame indexed by <code>"College"</code> with multiple
columns, each of which contain the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>. Then, using <code>.get("IG Followers")</code>
extracts just the <code>"IG Followers"</code> column from the
aforementioned counts DataFrame, and we know that columns are stored as
Series. We know that this column exists, because
<code>survey.sort_values(by="Class Standing").groupby("College").count()</code>
will have the same columns as <code>survey</code>, minus
<code>"College"</code>, which was moved to the index.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 92%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-34.4">Problem 34.4</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a> .iloc[<span class="dv">0</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_4" aria-expanded="true" aria-controls="collapse34_4">
Click to view the solution.
</button>
</h2>
<div id="collapse34_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: int or float</p>
<p>In the previous subpart, we saw that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>).groupby(<span class="st">"College"</span>).count().get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series whose index contains the unique names of
<code>"College"</code>s and whose values are the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each college.
The number of rows in
<code>survey.sort_values(by="Class Standing")</code> for any particular
college – say, <code>"Sixth"</code> – is a number, and so the values in
this Series are all numbers. As such, the answer is int or float.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-34.5">Problem 34.5</h3>
<p>What <strong>value</strong> does the following expression evaluate
to? If you believe the expression errors, provide a one sentence
explanation of why.</p>
<p>For example, if you think the expression evaluates to an int, don’t
write “int" or”the largest value in the <code>"IG Followers"</code>
column", write the specific int, like “23".</p>
<p><em>Hint: You have enough information to answer the problem; don’t
forget to look at the data description page.</em></p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>.groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>.get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>.index[<span class="dv">0</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_5" aria-expanded="true" aria-controls="collapse34_5">
Click to view the solution.
</button>
</h2>
<div id="collapse34_5" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <code>"ERC"</code></p>
<p>From the previous subpart, we saw that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>.groupby(<span class="st">"College"</span>).count()</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>.get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series, indexed by <code>"College"</code>, whose values contain
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>. When we group by <code>"College"</code>, the
resulting DataFrame (and hence, our Series) is sorted in ascending order
by <code>"College"</code>. This means that the index of our Series is
sorted alphabetically by <code>"College"</code> names. Of the
<code>"College"</code> names mentioned in the data description
(<code>"ERC"</code>, <code>"Marshall"</code>, <code>"Muir"</code>,
<code>"Revelle"</code>, <code>"Seventh"</code>, <code>"Sixth"</code>,
and <code>"Warren"</code>), the first name alphabetically is
<code>"ERC"</code>, so using <code>.index[0]</code> on the above index
gives us <code>"ERC"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 32%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-34.6">Problem 34.6</h3>
<p>Consider again the expression from 1.5. Suppose we remove the
piece</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span></code></pre></div>
<p>but keep all other parts the same. Does this change the value the
expression evaluates to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes, this changes the value the expression evaluates to.</p></li>
<li><p><input type="radio" disabled="" /> No, this does not change the value the expression evaluates to.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_6" aria-expanded="true" aria-controls="collapse34_6">
Click to view the solution.
</button>
</h2>
<div id="collapse34_6" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: No, this does not change the value the
expression evaluates to.</p>
<p>We addressed this in the second subpart of the problem: “<em>Note
that if we didn’t sort before grouping – that is, if our expression was
just <code>survey.groupby("College").count()</code> – the resulting
DataFrame would be the same! That’s because the order of the rows in
<code>survey</code> does not impact the number of rows in
<code>survey</code> that belong to each
<code>"College"</code>.</em>”</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 80%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-34.7">Problem 34.7</h3>
<p>What <strong>value</strong> does the following expression evaluate
to? If you believe the expression errors, provide a one sentence
explanation of why.</p>
<p>For example, if you think the expression evaluates to an int, don’t
write “int” or “the largest value in the <code>"IG Followers"</code>
column”, write the specific int, like “23”.</p>
<p><em>Hint: You have enough information to answer the problem; don’t
forget to look at the data description page.</em></p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a> .loc[<span class="dv">0</span>]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34_7" aria-expanded="true" aria-controls="collapse34_7">
Click to view the solution.
</button>
</h2>
<div id="collapse34_7" class="accordion-collapse collapse collapse"
aria-labelledby="heading34_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The code produces an error because, after
the grouping operation, the resulting Series uses the unique college
names as indices, and there isn’t a college named <code>0</code>.</p>
<p>In the previous few subparts, we’ve established that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>.groupby(<span class="st">"College"</span>).count()</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>.get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series, indexed by <code>"College"</code>, whose values contain
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>.</p>
<p>The <code>.loc</code> accessor is used to extract a value from a
Series given its label, or index value. However, since the index values
in the aforementioned Series are <code>"College"</code> names, there is
no value whose index is <code>0</code>, so this throws an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 54%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-35">Problem 35</h2>
<p><br></p>
<h3 id="problem-35.1">Problem 35.1</h3>
<p>We’d like to find the mean number of Instagram followers of all
students in DSC 10. One <strong>correct</strong> way to do so is given
below.</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>    mean_1 <span class="op">=</span> survey.get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span></code></pre></div>
<p>Another two <strong>possible</strong> ways to do this are given
below.</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 1.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    mean_2 <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).mean().get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 2.</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).<span class="bu">sum</span>().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).count().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    mean_3 <span class="op">=</span> X <span class="op">/</span> Y</span></code></pre></div>
<p>Is <code>mean_2</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<p>Is <code>mean_3</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading35_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse35_1" aria-expanded="true" aria-controls="collapse35_1">
Click to view the solution.
</button>
</h2>
<div id="collapse35_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading35_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p><strong>Is <code>mean_2</code> is equal to <code>mean_1</code>? Yes,
if both sections have the same number of students, otherwise
maybe.</strong></p>
<p><code>mean_2</code> is the “mean of means” – it finds the mean number
of <code>"IG Followers"</code> for each section, then finds the mean of
those two numbers. This is not in general to the overall mean, because
it doesn’t consider the fact that Section A may have more students than
Section B (or vice versa); if this is the case, then Section A needs to
be weighted more heavily in the calculation of the overall mean.</p>
<p>Let’s look at a few examples to illustrate our point. - Suppose
Section A has 2 students who both have 10 followers, and Section B has 1
student who has 5 followers. The overall mean number of followers is
<span class="math inline">\frac{10 + 10 + 5}{3} = 8.33..</span>, while
the mean of the means is <span class="math inline">\frac{10 + 5}{2} =
7.5</span>. These are not the same number, so <code>mean_2</code> is not
always equal to <code>mean_1</code>. We can rule out “Yes” as an option.
- Suppose Section A has 2 students where one has 5 followers and one has
7, and Section B has 2 students where one has 3 followers and one has 15
followers. Then, the overall mean is <span class="math inline">\frac{5 +
7 + 3 + 13}{4} = \frac{28}{4} = 7</span>, while the mean of the means is
<span class="math inline">\frac{\frac{5+7}{2} + \frac{3 + 13}{2}}{2} =
\frac{6 + 8}{2} = 7</span>. If you experiment (or even write out a full
proof), you’ll note that as long as Sections A and B have the same
number of students, the overall mean number of followers across their
two sections is equal to the mean of their section-specific mean numbers
of followers. We can rule out “No” as an option. - Suppose Section A has
2 students who both have 10 followers, and Section B has 3 students who
both have 10 followers. Then, the overall mean is 10, and so is the mean
of means. So, it’s possible for there to be a different number of
students in Sections A and B and for <code>mean_2</code> to be equal to
<code>mean_1</code>. It’s not always, true, though, which is why the
answer is “Yes, if both sections have the same number of students,
otherwise maybe” and we can rule out the “otherwise no” case.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 15%.</p>
<p><br/><br/></p>
<p><strong>Is <code>mean_3</code> is equal to <code>mean_1</code>?
Yes.</strong></p>
<p>Let’s break down the calculations:</p>
<ul>
<li>For <code>X</code>:
<code>survey.groupby("Section").sum().get("IG Followers")</code>
calculates the total number of followers for each section separately.
The subsequent <code>.sum()</code> then adds these totals together,
providing the total number of followers in the entire class.</li>
<li>For <code>Y</code>:
<code>survey.groupby("Section").count().get("IG Followers")</code>
counts the number of students in each section. The subsequent
<code>.sum()</code> then aggregates these counts, giving the total
number of students in the entire class.</li>
</ul>
<p>Then, <code>mean_3 = X / Y</code> divides the total number of
Instagram followers by the total number of students to get the overall
average number of followers per student for the entire dataset. This is
precisely how <code>mean_1</code> is calculated. Hence,
<code>mean_3</code> and <code>mean_1</code> will always be equal, so the
answer is “Yes.”</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 58%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-36">Problem 36</h2>
<p>You may have noticed that San Diego was quite cloudy in May (2023).
In fact, according to the National Weather Service, San Diego was the
single cloudiest city in the contiguous United States in May, with
clouds covering the sky 82% of the time. (Only a remote town in Alaska
was cloudier!)</p>
<p>We will work with the DataFrame <code>sun</code>, which describes the
number of sunshine hours per month in various cities around the world.
Each number in <code>sun</code> is an average across multiple years and
multiple sensors.</p>
<p>The first 2 columns in <code>sun</code> are <code>"Country"</code>
and <code>"City"</code>, which are strings describing a particular city.
The next 12 columns are <code>"Jan"</code>, <code>"Feb"</code>,
<code>"Mar"</code>, …, <code>"Dec"</code>, which describe the number of
sunshine hours seen each month. The last column, <code>"Year"</code>, is
the sum of the month-specific columns.</p>
<p>The first few rows of <code>sun</code> are shown below, though
<code>sun</code> has many more rows than are shown below.</p>
<center><img src='../assets/images/sp23-final/sun.png' width=1000></center>
<p><br></p>
<p>For instance, we see that Tashkent, Uzbekistan sees 164.3 sunshine
hours in March.</p>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>. <br><br></p>
<p>In the next few parts, consider the following answer choices.</p>
<ol type="A">
<li><p>The name of the country with the most cities.</p></li>
<li><p>The name of the country with the fewest cities.</p></li>
<li><p>The number of cities in the country with the most
cities.</p></li>
<li><p>The number of cities in the country with the fewest
cities.</p></li>
<li><p>The last city, alphabetically, in the first country,
alphabetically.</p></li>
<li><p>The first city, alphabetically, in the first country,
alphabetically.</p></li>
<li><p>Nothing, because it errors.</p></li>
</ol>
<p><br></p>
<h3 id="problem-36.1">Problem 36.1</h3>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sun.groupby(<span class="st">&quot;Country&quot;</span>).<span class="bu">max</span>().get(<span class="st">&quot;City&quot;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
<li><p><input type="radio" disabled="" /> E</p></li>
<li><p><input type="radio" disabled="" /> F</p></li>
<li><p><input type="radio" disabled="" /> G</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_1" aria-expanded="true" aria-controls="collapse36_1">
Click to view the solution.
</button>
</h2>
<div id="collapse36_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading36_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: E. The last city, alphabetically, in the
first country, alphabetically.<br/>
</p>
<p>Let’s break down the code:</p>
<ul>
<li><p><code>sun.groupby("Country").max()</code>: This line of code
groups the <code>sun</code> DataFrame by the <code>"Country"</code>
column and then determines the <strong>maximum</strong> for every other
column within each country group. Since the values in the
<code>"City"</code> column are stored as strings, and the maximum of a
Series of strings is the last string alphabetically, the values in the
<code>"City"</code> column of this DataFrame will contain the last city,
alphabetically, of each country.</p></li>
<li><p><code>.get("City")</code>: <code>.get("City")</code> accesses the
<code>"City"</code> column.</p></li>
<li><p><code>.iloc[0]</code>: Finally, <code>.iloc[0]</code> selects the
<code>"City"</code> value from the first row. The first row corresponds
to the first country alphabetically because <code>groupby</code> sorted
the DataFrame by <code>"Country"</code> in ascending order. The value in
the <code>"City"</code> column that <code>.iloc[0]</code> selects, then,
is the name of the last city, alphabetically, in the first country,
alphabetically.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 36%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-36.2">Problem 36.2</h3>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sun.groupby(<span class="st">&quot;Country&quot;</span>).<span class="bu">sum</span>().get(<span class="st">&quot;City&quot;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
<li><p><input type="radio" disabled="" /> E</p></li>
<li><p><input type="radio" disabled="" /> F</p></li>
<li><p><input type="radio" disabled="" /> G</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_2" aria-expanded="true" aria-controls="collapse36_2">
Click to view the solution.
</button>
</h2>
<div id="collapse36_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading36_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: G. Nothing, because it errors.<br/>
</p>
<p>Let’s break down the code:</p>
<ul>
<li><p><code>sun.groupby("Country").sum()</code>: This groups the
<code>sun</code> DataFrame by the <code>"Country"</code> column and
computes the sum for each numeric column within each country group.
Since <code>"City"</code> is non-numeric, it will be dropped.</p></li>
<li><p><code>.get("City")</code>: This operation attempts to retrieve
the <code>"City"</code> column from the resulting DataFrame. However,
since the <code>"City"</code> column was dropped in the previous step,
this will raise a KeyError, indicating that the column is not present in
the DataFrame.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 73%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-36.3">Problem 36.3</h3>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sun.groupby(<span class="st">&quot;Country&quot;</span>).count().sort_values(<span class="st">&quot;Jan&quot;</span>).index[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
<li><p><input type="radio" disabled="" /> E</p></li>
<li><p><input type="radio" disabled="" /> F</p></li>
<li><p><input type="radio" disabled="" /> G</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_3" aria-expanded="true" aria-controls="collapse36_3">
Click to view the solution.
</button>
</h2>
<div id="collapse36_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading36_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: A. The name of the country with the most
cities.<br/>
</p>
<p>Let’s break down the code:</p>
<ul>
<li><p><code>sun.groupby("Country").count()</code>: This groups the sun
DataFrame by the <code>"Country"</code> column. The
<code>.count()</code> method then returns the number of rows in each
group for each column. Since we’re grouping by <code>"Country"</code>,
and since the rows in <code>sun</code> correspond to cities, this is
counting the number of cities in each country.</p></li>
<li><p><code>.sort_values("Jan")</code>: The result of the previous
operation is a DataFrame with <code>"Country"</code> as the index and
the number of cities per country stored in every other column. The
<code>"City</code>, <code>"Jan"</code>, <code>"Feb"</code>,
<code>"Mar"</code>, etc. columns in the resulting DataFrame all contain
the same information. Sorting by <code>"Jan"</code> sorts the DataFrame
by the number of cities each country has in ascending order.</p></li>
<li><p><code>.index[-1]</code>: This retrieves the last index value from
the sorted DataFrame, which corresponds to the name of the country with
the most cities.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 61%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-36.4">Problem 36.4</h3>
<p>What does the following expression evaluate to?</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sun.groupby(<span class="st">&quot;Country&quot;</span>).count().sort_values(<span class="st">&quot;City&quot;</span>).get(<span class="st">&quot;City&quot;</span>).iloc[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> A</p></li>
<li><p><input type="radio" disabled="" /> B</p></li>
<li><p><input type="radio" disabled="" /> C</p></li>
<li><p><input type="radio" disabled="" /> D</p></li>
<li><p><input type="radio" disabled="" /> E</p></li>
<li><p><input type="radio" disabled="" /> F</p></li>
<li><p><input type="radio" disabled="" /> G</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_4" aria-expanded="true" aria-controls="collapse36_4">
Click to view the solution.
</button>
</h2>
<div id="collapse36_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading36_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: C. The number of cities in the country with
the most cities.<br/>
</p>
<p>Let’s break down the code:</p>
<ul>
<li><p><code>sun.groupby("Country").count()</code>: This groups the sun
DataFrame by the <code>"Country"</code> column. The
<code>.count()</code> method then returns the number of rows in each
group for each column. Since we’re grouping by <code>"Country"</code>,
and since the rows in <code>sun</code> correspond to cities, this is
counting the number of cities in each country.</p></li>
<li><p><code>.sort_values("City")</code>: The result of the previous
operation is a DataFrame with <code>"Country"</code> as the index and
the number of <code>"City"</code>s per <code>"Country"</code> stored in
every other column. The <code>"City</code>, <code>"Jan"</code>,
<code>"Feb"</code>, <code>"Mar"</code>, etc. columns in the resulting
DataFrame all contain the same information. Sorting by
<code>"City"</code> sorts the DataFrame by the number of cities each
country has in ascending order.</p></li>
<li><p><code>.get("City")</code>: This retrieves the <code>"City"</code>
column from the sorted DataFrame, which contains the number of cities in
each country.</p></li>
<li><p><code>.iloc[-1]</code>: This gets the last value from the
<code>"City"</code> column, which corresponds to the number of cities in
the country with the most cities.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 57%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-37">Problem 37</h2>
<p>Vanessa is a big Formula 1 racing fan, and wants to plan a trip to
Monaco, where the Monaco Grand Prix is held. Monaco is an example of a
“city-state” — that is, a city that is its own country. Singapore is
another example of a city-state.</p>
<p>We’ll say that a row of <code>sun</code> corresponds to a city-state
if its <code>"Country"</code> and <code>"City"</code> values are
equal.</p>
<p><br></p>
<h3 id="problem-37.1">Problem 37.1</h3>
<p>Fill in the blanks so that the expression below is equal to the total
number of sunshine hours in October of all city-states in
<code>sun</code>.</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>    sun[__(a)__].__(b)__</span></code></pre></div>
<p>What goes in blanks (a) and (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_1" aria-expanded="true" aria-controls="collapse37_1">
Click to view the solution.
</button>
</h2>
<div id="collapse37_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading37_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: (a):
<code>sun.get("Country") == sun.get("City")</code>, (b):
<code>.get("Oct").sum()</code></p>
<p><strong>What goes in blank (a)?</strong>
<code>sun.get("Country") == sun.get("City")</code><br/>
This expression compares the <code>"Country"</code> column to the
<code>"City"</code> column for each row in the <code>sun</code>
DataFrame. It returns a Boolean Series where each value is
<code>True</code> if the corresponding <code>"Country"</code> and
<code>"City"</code> are the same (indicating a city-state) and
<code>False</code> otherwise.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
<p><br/><br/></p>
<p><strong>What goes in blank (b)?</strong>
<code>.get("Oct").sum()</code><br/>
Here, we select the <code>"Oct"</code> column, which represents the
sunshine hours in October, and compute the sum of its values. By using
this after querying for city-states, we calculate the total sunshine
hours in October across all city-states in the <code>sun</code>
DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 85%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-38">Problem 38</h2>
<p>An area’s cost of living describes how expensive it is to live in
that area. In this exam, we’ll work with the DataFrame
<code>living_cost</code>, which describes the typical cost of living for
different types of families across all 3143 counties in the 50 United
States. The first few rows of <code>living_cost</code> are shown below,
but <code>living_cost</code> has <strong>many more rows</strong> than
shown.</p>
<center><img src='../assets/images/fa23-midterm/living_cost_preview.jpg' width=800></center>
<p><br></p>
<p>Two counties in the same state will never have the same name, but as
the last two rows above illustrate, there are some counties in different
states with the same name, like Lee County.</p>
<p>The <code>"family_type"</code> column uses a code to describe the
number of adults and children in a family. For example, a value of
<code>"2a1c"</code> represents families with two adults and one child.
There are ten unique values, as follows: <code>"1a0c"</code>,
<code>"1a1c"</code>, <code>"1a2c"</code>, <code>"1a3c"</code>,
<code>"1a4c"</code>, <code>"2a0c"</code>, <code>"2a1c"</code>,
<code>"2a2c"</code>, <code>"2a3c"</code>, <code>"2a4c"</code>. We will
assume that <strong>all families fall into one of these ten
categories</strong>, and <strong>all ten family structures are present
in each US county</strong>.</p>
<p>Each of the 31430 rows of the DataFrame represents a unique
combination of <code>"state"</code>, <code>"county"</code>, and
<code>"family_type"</code>. As a result, there will be more than one row
with a <code>"state"</code> of <code>"CA"</code> and a
<code>"county"</code> of <code>"San Diego"</code>, corresponding to
different values of <code>"family_type"</code>. Similarly, there will be
many rows such that <code>"family_type"</code> is <code>"2a1c"</code>,
all corresponding to different counties. There is <strong>only one
row</strong>, however, where <code>"state"</code> is <code>"CA"</code>,
<code>"county"</code> is <code>"San Diego"</code>, and
<code>"family_type"</code> is <code>"1a2c"</code></p>
<p>In addition to the <code>"state"</code>, <code>"county"</code>, and
<code>"family_type"</code> columns, <code>living_cost</code> includes
the following columns.</p>
<ul>
<li><code>"is_metro"</code> (<code>bool</code>): <code>True</code> if
the county is part of a metropolitan (urban) area, <code>False</code>
otherwise. This value is the same for all rows of the DataFrame
corresponding to the same county and state.</li>
<li><code>"avg_housing_cost"</code> (<code>int</code>): The average
yearly cost of housing, in dollars, for families of the given size in
the given county and state.</li>
<li><code>"avg_childcare_cost"</code> (<code>int</code>): The average
yearly cost of childcare, in dollars, for families of the given size in
the given county and state.</li>
<li><code>"median_income"</code> (<code>int</code>): The median annual
income, in dollars, for families of the given size in the given county
and state.</li>
</ul>
<p>Assume we have already run <code>import babypandas as bpd</code> and
<code>import numpy as np</code>. <br><br></p>
<h3 id="problem-38.1">Problem 38.1</h3>
<p>Suppose we run the three lines of code below.</p>
<pre><code>families = living_cost.groupby(&quot;family_type&quot;).median()
sorted_families = families.sort_values(by=&quot;avg_housing_cost&quot;)
result = sorted_families.get(&quot;avg_childcare_cost&quot;).iloc[0]</code></pre>
<p>Which of the following does <code>result</code> evaluate to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The median <code>"avg_childcare_cost"</code> of the
<code>"family_type"</code> with the lowest median
<code>"avg_housing_cost"</code>.</p></li>
<li><p><input type="radio" disabled="" /> The median <code>"avg_childcare_cost"</code> of the
<code>"family_type"</code> with the highest median
<code>"avg_housing_cost"</code>.</p></li>
<li><p><input type="radio" disabled="" /> The median <code>"avg_housing_cost"</code> of the
<code>"family_type"</code> with the lowest median
<code>"avg_childcare_cost"</code>.</p></li>
<li><p><input type="radio" disabled="" /> The median <code>"avg_housing_cost"</code> of the
<code>"family_type"</code> with the highest median
<code>"avg_childcare_cost"</code>.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_1" aria-expanded="true" aria-controls="collapse38_1">
Click to view the solution.
</button>
</h2>
<div id="collapse38_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading38_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> The median <code>"avg_childcare_cost"</code>
of the <code>"family_type"</code> with the lowest median
<code>"avg_housing_cost"</code>.<br/>
</p>
<p>When we grouped <code>living_cost</code> by
<code>"family_type"</code>, <code>families</code> is a DataFrame with
one row per <code>"family_type"</code>. Using the <code>.median()</code>
aggregation method takes the median of all numerical columns per
<code>"family_type"</code>.</p>
<p><code>sorted_families</code> is the <code>families</code> DataFrame,
but sorted in ascending order based on the
<code>"avg_housing_cost"</code> column. The first row of
<code>sorted_families</code> is the <code>"family_type"</code> with the
lowest median <code>"avg_housing_cost"</code>, and the last row of
<code>sorted_families</code> is the <code>"family_type"</code> with the
highest median <code>"avg_housing_cost"</code>.</p>
<p>In the last line of code, we’re getting the
<code>"avg_childcare_cost"</code> column from the
<code>sorted_families</code> DataFrame. We then use <code>iloc</code> to
get the first entry in the <code>"avg_childcare_cost"</code> column.
Since <code>sorted_families</code> is sorted in ascending order, this
means that we’re getting the lowest median in the column. Therefore,
<code>result</code> evaluates to the median
<code>"avg_childcare_cost"</code> of the <code>"family_type"</code> with
the lowest median <code>"avg_housing_cost"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 82%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-38.2">Problem 38.2</h3>
<p>Suppose we define <code>another_result</code> as follows.</p>
<pre><code>another_result = (living_cost.groupby(&quot;state&quot;).count()
                  .sort_values(by=&quot;median_income&quot;, ascending=False)
                  .get(&quot;median_income&quot;).index[0])</code></pre>
<p>What does <code>another_result</code> represent?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> The state with the highest median income.</p></li>
<li><p><input type="radio" disabled="" /> The median income in the state with the highest median income.</p></li>
<li><p><input type="radio" disabled="" /> The state with the most counties.</p></li>
<li><p><input type="radio" disabled="" /> The median income in the state with the most counties.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_2" aria-expanded="true" aria-controls="collapse38_2">
Click to view the solution.
</button>
</h2>
<div id="collapse38_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading38_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> The state with the most counties.<br/>
</p>
<p>The <code>living_cost</code> DataFrame is being grouped by the
<code>"state"</code> column, so there is now one row per
<code>"state"</code>. By using the <code>.count()</code> aggregation
method, the columns in the DataFrame will contain the number of rows
in <code>living_count</code> for each <code>"state"</code>. All of the
columns will also be the same after using <code>.count()</code>, so they
will all contain the distribution of <code>"state"</code>. Since
<code>living_cost</code> has data on every county in the US, the grouped
DataFrame represents the number of counties that each state has.</p>
<p>We then sort the DataFrame in descending order, so the state with the
most counties is at the top of the DataFrame. The last line of the
expression gets a column and uses <code>.index</code> to get the state
corresponding to the first entry, which happens to be the state with the
most counties and the value that gets assigned to
<code>another_result</code>.</p>
<p>Since all the columns are the same, it doesn’t matter which column we
pick to use in the <code>.sort_values()</code> method. In this case, we
used the <code>"median_income"</code> column, but picking any other
column will produce the same result.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 65%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-38.3">Problem 38.3</h3>
<p>Which of the following DataFrames has exactly four columns?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>living_cost.groupby("family_type").min()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>living_cost.groupby("family_type").sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>living_cost.groupby("family_type").count()</code></p></li>
<li><p><input type="radio" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_3" aria-expanded="true" aria-controls="collapse38_3">
Click to view the solution.
</button>
</h2>
<div id="collapse38_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading38_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>living_cost.groupby("family_type").sum()</code><br/>
</p>
<p>Since we can’t take the sum of columns with categorical data, all of
the columns in <code>living_cost</code> that contain non-numerical data
are dropped after we use the <code>.sum()</code> aggregation method.
There are four columns in <code>living_cost</code> that have numerical
data (<code>"is_metro"</code>, <code>"avg_housing_cost"</code>,
<code>"avg_childcare_cost"</code>, and <code>"median_income"</code>).
Since Python can take the sum of these numerical columns, these four
columns are kept. Therefore, the resulting DataFrame has exactly four
columns.</p>
<p>Although <code>"is_metro"</code> contains Boolean values, Python can
still calculate the sum of this column. The Boolean value
<code>True</code> corresponds to 1 and <code>False</code> corresponds to
0.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 35%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-38.4">Problem 38.4</h3>
<p>Suppose we define the Series <code>three_columns</code> to be the
concatenation of three columns of the <code>living_cost</code> DataFrame
as follows.</p>
<pre><code>three_columns = (living_cost.get(&quot;state&quot;) + &quot; &quot; +
                 living_cost.get(&quot;county&quot;) + &quot; &quot; + 
                 living_cost.get(&quot;family_type&quot;))</code></pre>
<p>For example, the first element of <code>three_columns</code> is the
string <code>"CA San Diego County 1a2c"</code> (refer back to the first
row of <code>living_cost</code> provided in the data overview).</p>
<p>What does the following expression evaluate to?</p>
<pre><code>(living_cost.assign(geo_family=three_columns)
            .groupby(&quot;geo_family&quot;).count()
            .shape[0])</code></pre>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">10</span>, the number of distinct
<code>"family_type"</code> values.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">50</span>, the number of states in the
US.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">500</span>, the number of combinations of
states in the US and <code>"family_type"</code> values.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">3143</span>, the number of counties in the
US.</p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">31430</span>, the number of rows in the
<code>living_cost</code> DataFrame.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_4" aria-expanded="true" aria-controls="collapse38_4">
Click to view the solution.
</button>
</h2>
<div id="collapse38_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading38_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <span class="math inline">31430</span>, the
number of rows in the <code>living_cost</code> DataFrame.<br/>
</p>
<p>The first line of the expression creates a new column in
<code>living_cost</code>, called <code>"geo_family"</code> that
represents the concatenation of the values in
<code>"three_columns"</code>. When we group the DataFrame by
<code>"geo_family"</code>, we create a new DataFrame that contains a row
for every unique value in <code>"three_columns"</code>.
<code>"three_columns"</code> has various combinations of
<code>"state"</code>, <code>"country"</code>, and
<code>"family_type"</code>. Since it’s given in the DataFrame
description that each of the 31430 rows of the DataFrame represents a
different combination of <code>"state"</code>, <code>"country"</code>,
and <code>"family_type"</code>, this means that the grouped DataFrame
has 31430 unique combinations as well. Therefore, when we use
<code>.shape[0]</code> to get the number of rows in the grouped
DataFrame in the last line of the expression, we get the same value as
the number of rows in the <code>living_cost</code> DataFrame, 31430.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-39">Problem 39</h2>
<p>Suppose we define the three variables below.</p>
<pre><code>J = living_cost.get(&quot;county&quot;) == &quot;Benton County&quot;
K = living_cost.get(&quot;state&quot;) == &quot;IN&quot;
L = living_cost.get(&quot;family_type&quot;) == &quot;1a2c&quot;</code></pre>
<p>Feel free to use these variables in your solutions to the following
questions.</p>
<p><br></p>
<h3 id="problem-39.1">Problem 39.1</h3>
<p>Fill in the blanks so that the expression below evaluates to the
average yearly childcare cost for families with one adult and two
children in Benton County, IN.</p>
<pre><code>    __(a)__.__(b)__.iloc[0]</code></pre>
<ol type="1">
<li><p>What goes in blank (a)?</p></li>
<li><p>What goes in blank (b)?</p></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_1" aria-expanded="true" aria-controls="collapse39_1">
Click to view the solution.
</button>
</h2>
<div id="collapse39_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading39_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ol type="1">
<li><code>living_cost[J &amp; K &amp; L]</code></li>
</ol>
<p>The first step is to query the rows in the DataFrame that meet our
specific criteria. In this case, we want the rows in the DataFrame where
the county is <code>"Benton County"</code>, the state is
<code>"IN"</code>, and the family has 1 adult and 2 children.
<code>J</code>, <code>K</code>, and <code>L</code> specify these
criteria. When used to query the <code>living_cost</code> DataFrame, we
are able to obtain a DataFrame with only one row, corresponding this
family type in this specific county.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
<p><strong>Answer:</strong></p>
<ol start="2" type="1">
<li><code>get("avg_childcare_cost")</code></li>
</ol>
<p>Once we have a DataFrame that contains the row we need, we need to
use it to get the average yearly childcare cost. To do that, we get out
the <code>"avg_childcare_cost"</code> column and access the entry in row
0 with <code>.iloc[0]</code>. This works because after querying, there
is only one row, and it corresponds exactly to the families with one
adult and two children in Benton County, IN. </p>
<hr/>
<h5>Difficulty:
⭐️⭐️⭐️</h5>
<p>The average score on this problem was 57%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-39.2">Problem 39.2</h3>
<p>Fill in the blanks so that the expression below evaluates to the
number of states with a county named Benton County.</p>
<pre><code>    __(c)__.__(d)__ / 10</code></pre>
<ol type="1">
<li><p>What goes in blank (c)?</p></li>
<li><p>What goes in blank (d)?</p></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_2" aria-expanded="true" aria-controls="collapse39_2">
Click to view the solution.
</button>
</h2>
<div id="collapse39_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading39_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ol type="1">
<li><code>living_cost[J]</code></li>
</ol>
<p>Since we want to find how many states have a county named
<code>"Benton County"</code>, we first want to obtain all the rows of
the DataFrame where the county is <code>"Benton County"</code>. Variable
<code>J</code> specifies this condition, so we use it to query and
obtain a DataFrame with the rows in <code>living_cost</code> where the
county is <code>"Benton County."</code></p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 60%.</p>
<p><strong>Answer:</strong></p>
<ol start="2" type="1">
<li><code>shape[0]</code></li>
</ol>
<p>Now that we have all the rows in the DataFrame where the county is
<code>"Benton County"</code>, let’s consider how many rows it has. Each
row of this DataFrame represents a unique combination of
<code>"state"</code> and <code>"family_type"</code> for counties called
<code>"Benton County"</code>. We know from the data description that
each of the ten family structures is present in each county. This means
that for each state with a county called <code>"Benton County"</code>,
our DataFrame has exactly ten rows. Therefore, the number of states with
a county called <code>"Benton County"</code> is the total number of rows
in our DataFrame divided by ten. Therefore, we should fill in blank (d)
with <code>.shape[0]</code> to extract the number of rows from our
DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 40%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
