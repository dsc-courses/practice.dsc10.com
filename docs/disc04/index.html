<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Discussion 4: Functions, Subgroups, Merge, and Control Flow</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Discussion 4: Functions, Subgroups, Merge, and Control
Flow</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc10.com</a></p>
<hr />
<p>The problems in this worksheet are taken from past exams. Work on
them <strong>on paper</strong>, since the exams you take in this course
will also be on paper. <br><br>We encourage you to complete this
worksheet in a live discussion section. Solutions will be made available
after all discussion sections have concluded. You don’t need to submit
your answers anywhere. <br><br><b>Note: We do not plan to cover all
problems here in the live discussion section</b>; the problems we don’t
cover can be used for extra practice.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p><center><img src='../assets/images/sp22-midterm/cartoon.png' width=20%></center></p>
<p>Included is a DataFrame named <code>sungod</code> that contains
information on the artists who have performed at Sun God in years past.
<strong>For each year that the festival was held, we have one row for
each artist that performed that year.</strong> The columns are:</p>
<ul>
<li><code>'Year'</code> (<code>int</code>): the year of the
festival</li>
<li><code>'Artist'</code> (<code>str</code>): the name of the
artist</li>
<li><code>'Appearance_Order'</code> (<code>int</code>): the order in
which the artist appeared in that year’s festival (1 means they came
onstage first)</li>
</ul>
<p>The rows of <code>sungod</code> are arranged in <strong>no particular
order</strong>. The first few rows of <code>sungod</code> are shown
below (though <code>sungod</code> has <strong>many more rows</strong>
than pictured here).</p>
<center><img src='../assets/images/sp22-midterm/sungod.png' width=30%></center>
<p>Assume:</p>
<ul>
<li><p>Only one artist ever appeared at a time (for example, we can’t
have two separate artists with a <code>'Year'</code> of 2015 and an
<code>'Appearance_Order'</code> of 3).</p></li>
<li><p>An artist may appear in multiple different Sun God festivals
(they could be invited back).</p></li>
<li><p>We have already run <code>import babypandas as bpd</code> and
<code>import numpy as np</code>. <br><br></p></li>
</ul>
<p>Fill in the blank in the code below so that
<code>chronological</code> is a DataFrame with the same rows as
<code>sungod</code>, but ordered chronologically by appearance on stage.
That is, earlier years should come before later years, and within a
single year, artists should appear in the DataFrame in the order they
appeared on stage at Sun God. Note that <code>groupby</code>
automatically sorts the index in ascending order.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>chronological <span class="op">=</span> sungod.groupby(___________).<span class="bu">max</span>().reset_index()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>['Year', 'Artist', 'Appearance_Order']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>['Year', 'Appearance_Order']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>['Appearance_Order', 'Year']</code></p></li>
<li><p><input type="radio" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="true" aria-controls="collapse1">
Click to view the solution.
</button>
</h2>
<div id="collapse1" class="accordion-collapse collapse"
aria-labelledby="heading1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>['Year', 'Appearance_Order']</code></p>
<p>The fact that <code>groupby</code> automatically sorts the index in
ascending order is important here. Since we want earlier years before
later years, we could group by <code>'Year'</code>, however if we
<em>just</em> group by year, all the artists who performed in a given
year will be aggregated together, which is not what we want. Within each
year, we want to organize the artists in ascending order of
<code>'Appearance_Order'</code>. In other words, we need to group by
<code>'Year'</code> with <code>'Appearance_Order'</code> as subgroups.
Therefore, the correct way to reorder the rows of <code>sungod</code> as
desired is
<code>sungod.groupby(['Year', 'Appearance_Order']).max().reset_index()</code>.
Note that we need to reset the index so that the resulting DataFrame has
<code>'Year'</code> and <code>'Appearance_Order'</code> as columns, like
in <code>sungod</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 85%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Another DataFrame called <code>music</code> contains a row for every
music artist that has ever released a song. The columns are:</p>
<ul>
<li><code>'Name'</code> (<code>str</code>): the name of the music
artist</li>
<li><code>'Genre'</code> (<code>str</code>): the primary genre of the
artist</li>
<li><code>'Top_Hit'</code> (<code>str</code>): the most popular song by
that artist, based on sales, radio play, and streaming</li>
<li><code>'Top_Hit_Year'</code> (<code>int</code>): the year in which
the top hit song was released</li>
</ul>
<p>You want to know how many musical genres have been represented at Sun
God since its inception in 1983. Which of the following expressions
produces a DataFrame called <code>merged</code> that could help
determine the answer?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>merged = sungod.merge(music, left_on='Year', right_on='Top_Hit_Year')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>merged = music.merge(sungod, left_on='Year', right_on='Top_Hit_Year')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>merged = sungod.merge(music, left_on='Artist', right_on='Name')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>merged = music.merge(sungod, left_on='Artist', right_on='Name')</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="true" aria-controls="collapse2">
Click to view the solution.
</button>
</h2>
<div id="collapse2" class="accordion-collapse collapse"
aria-labelledby="heading2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>merged = sungod.merge(music, left_on='Artist', right_on='Name')</code></p>
<p>The question we want to answer is about Sun God music artists’
genres. In order to answer, we’ll need a DataFrame consisting of rows of
artists that have performed at Sun God since its inception in 1983. If
we merge the <code>sungod</code> DataFrame with the <code>music</code>
DataFrame based on the artist’s name, we’ll end up with a DataFrame
containing one row for each artist that has ever performed at Sun God.
Since the column containing artists’ names is called
<code>'Artist'</code> in <code>sungod</code> and <code>'Name'</code> in
<code>music</code>, the correct syntax for this merge is
<code>merged = sungod.merge(music, left_on='Artist', right_on='Name')</code>.
Note that we could also interchange the left DataFrame with the right
DataFrame, as swapping the roles of the two DataFrames in a merge only
changes the ordering of rows and columns in the output, not the data
itself. This can be written in code as
<code>merged = music.merge(sungod, left_on='Name', right_on='Artist')</code>,
but this is not one of the answer choices.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>You generate a three-digit number by randomly choosing each digit to
be a number 0 through 9, inclusive. Each digit is equally likely to be
chosen.</p>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>What is the probability you produce the number <strong>027</strong>?
Give your answer as a decimal number between 0 and 1 with no
rounding.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 0.001</p>
<p>There is a <span class="math inline">\frac{1}{10}</span> chance that
we get 0 as the first random number, a <span class="math inline">\frac{1}{10}</span> chance that we get 2 as the
second random number, and a <span class="math inline">\frac{1}{10}</span> chance that we get 7 as the
third random number. The probability of all of these events happening is
<span class="math inline">\frac{1}{10}*\frac{1}{10}*\frac{1}{10} =
0.001</span>.</p>
<p>Another way to do this problem is to think about the possible
outcomes. Any number from 000 to 999 is possible and all are equally
likely. Since there are 1000 possible outcomes and the number 027 is
just one of the possible outcomes, the probability of getting this
outcome is <span class="math inline">\frac{1}{1000} = 0.001</span>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 92%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>What is the probability you produce a number with an odd digit in the
middle position? For example, <strong>250</strong>. Give your answer as
a decimal number between 0 and 1 with no rounding.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 0.5</p>
<p>Because the values of the left and right positions are not important
to us, think of the middle position only. When selecting a random number
to go here, we are choosing randomly from the numbers 0 through 9. Since
5 of these numbers are odd (1, 3, 5, 7, 9), the probability of getting
an odd number is <span class="math inline">\frac{5}{10} =
0.5</span>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>What is the probability you produce a number with a
<strong>7</strong> in it somewhere? Give your answer as a decimal number
between 0 and 1 with no rounding.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 0.271</p>
<p>It’s easier to calculate the probability that the number has no 7 in
it, and then subtract this probability from 1. To solve this problem
directly, we’d have to consider cases where 7 appeared multiple times,
which would be more complicated.</p>
<p>The probability that the resulting number has no 7 is <span class="math inline">\frac{9}{10}*\frac{9}{10}*\frac{9}{10} =
0.729</span> because in each of the three positions, there is a <span class="math inline">\frac{9}{10}</span> chance of selecting something
other than a 7. Therefore, the probability that the number has a 7 is
<span class="math inline">1 - 0.729 = 0.271</span>. </p>
<hr/>
<h5>Difficulty:
⭐️⭐️⭐️</h5>
<p>The average score on this problem was 69%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>We define the seasons as follows:</p>
<center>
<table class="table" style="width:30%">
  <thead>
    <tr>
      <th scope="col">Season</th>
      <th scope="col">Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">Spring</th>
      <td>March, April, May</td>
    </tr>
    <tr>
      <th scope="row">Summer</th>
      <td>June, July, August</td>
    </tr>
    <tr>
      <th scope="row">Fall</th>
      <td>September, October, November</td>
    </tr>
    <tr>
      <th scope="row">Winter</th>
      <td>December, January, February</td>
    </tr>
  </tbody>
</table>
</center>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>We want to create a function <code>date_to_season</code> that takes
in a <code>date</code> as formatted in the <code>'DATE'</code> column of
<code>flights</code> and returns the season corresponding to that date.
Which of the following implementations of <code>date_to_season</code>
works correctly? <strong>Select all that apply.</strong></p>
<p>Option 1:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> date_to_season(date):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    month_as_num <span class="op">=</span> <span class="bu">int</span>(date.split(<span class="st">&#39;-&#39;</span>)[<span class="dv">1</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> month_as_num <span class="op">&gt;=</span> <span class="dv">3</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">6</span>:</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Spring&#39;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> month_as_num <span class="op">&gt;=</span> <span class="dv">6</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">9</span>:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Summer&#39;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> month_as_num <span class="op">&gt;=</span> <span class="dv">9</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Fall&#39;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Winter&#39;</span></span></code></pre></div>
<p>Option 2:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> date_to_season(date):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    month_as_num <span class="op">=</span> <span class="bu">int</span>(date.split(<span class="st">&#39;-&#39;</span>)[<span class="dv">1</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> month_as_num <span class="op">&gt;=</span> <span class="dv">3</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">6</span>:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Spring&#39;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> month_as_num <span class="op">&gt;=</span> <span class="dv">6</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">9</span>:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Summer&#39;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> month_as_num <span class="op">&gt;=</span> <span class="dv">9</span> <span class="kw">and</span> month_as_num <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Fall&#39;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Winter&#39;</span></span></code></pre></div>
<p>Option 3:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> date_to_season(date):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    month_as_num <span class="op">=</span> <span class="bu">int</span>(date.split(<span class="st">&#39;-&#39;</span>)[<span class="dv">1</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> month_as_num <span class="op">&lt;</span> <span class="dv">3</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Winter&#39;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> month_as_num <span class="op">&lt;</span> <span class="dv">6</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Spring&#39;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> month_as_num <span class="op">&lt;</span> <span class="dv">9</span>:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Summer&#39;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> month_as_num <span class="op">&lt;</span> <span class="dv">12</span>:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Fall&#39;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Winter&#39;</span> </span></code></pre></div>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Option 1</p></li>
<li><p><input type="checkbox" disabled="" /> Option 2</p></li>
<li><p><input type="checkbox" disabled="" /> Option 3</p></li>
<li><p><input type="checkbox" disabled="" /> None of these implementations of <code>date_to_season</code> work
correctly</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Option 1, Option 2, Option 3</p>
<p>All three options start with the same first line of code:
<code>month_as_num = int(date.split('-')[1])</code>. This takes the
date, originally a string formatted such as <code>'2021-09-07'</code>,
separates it into a list of three strings such as
<code>['2021', '09', '07']</code>, extracts the element in position 1
(the middle position), and converts it to an <code>int</code> such as 9.
Now we have the month as a number we can work with more easily.</p>
<p>According to the definition of seasons, the months in each season are
as follows:</p>
<center>
<table class="table" style="width:40%">
<thead>
<tr>
<th scope="col">Season</th>
<th scope="col">Month</th>
<th scope="col">month_as_num</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">Spring</th>
<td>March, April, May</td>
<td>3, 4, 5</td>
</tr>
<tr>
<th scope="row">Summer</th>
<td>June, July, August</td>
<td>6, 7, 8</td>
</tr>
<tr>
<th scope="row">Fall</th>
<td>September, October, November</td>
<td>9, 10, 11</td>
</tr>
<tr>
<th scope="row">Winter</th>
<td>December, January, February</td>
<td>12, 1, 2</td>
</tr>
</tbody>
</table>
</center>
<p>Option 1 correctly assigns months to seasons by checking if the month
falls in the appropriate range for <code>'Spring'</code>, then
<code>'Summer'</code>, then <code>'Fall'</code>. Finally, if all of
these conditions are false, the <code>else</code> branch will return the
correct answer of <code>'Winter'</code> when <code>month_as_num</code>
is 12, 1, or 2.</p>
<p>Option 2 is also correct, and in fact, it does the same exact thing
as Option 1 even though it uses <code>if</code> where Option 1 used
<code>elif</code>. The purpose of <code>elif</code> is to check a
condition only when all previous conditions are false. So if we have an
<code>if</code> followed by an <code>elif</code>, the <code>elif</code>
condition will only be checked when the <code>if</code> condition is
false. If we have two sequential <code>if</code> conditions, typically
the second condition will be checked regardless of the outcome of the
first condition, which means two <code>if</code> statements can behave
differently than an <code>if</code> followed by an <code>elif</code>. In
this case, however, since the <code>if</code> statements cause the
function to <code>return</code> and therefore stop executing, the only
way to get to a certain <code>if</code> condition is when all previous
<code>if</code> conditions are false. If any prior <code>if</code>
condition was true, the function would have returned already! So this
means the three <code>if</code> conditions in Option 2 are equivalent to
the <code>if</code>, <code>elif</code>, <code>elif</code> structure of
Option 1. Note that the <code>else</code> case in Option 1 is reached
when all prior conditions are false, whereas the <code>else</code> in
Option 2 is paired only with the <code>if</code> statement immediately
preceding it. But since we only ever get to that third <code>if</code>
statement when the first two <code>if</code> conditions are false, we
still only reach the <code>else</code> branch when all three
<code>if</code> conditions are false.</p>
<p>Option 3 works similarly to Option 1, except it separates the months
into more categories, first categorizing January and February as
<code>'Winter'</code>, then checking for <code>'Spring'</code>,
<code>'Summer'</code>, and <code>'Fall'</code>. The only month that
winds up in the <code>else</code> branch is December. We can think of
Option 3 as the same as Option 1, except the Winter months have been
separated into two groups, and the group containing January and February
is extracted and checked first.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>Assuming we’ve defined <code>date_to_season</code> correctly in the
previous part, which of the following lines of code correctly computes
the season for each flight in <code>flights</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>date_to_season(flights.get('DATE'))</code></p></li>
<li><p><input type="radio" disabled="" /> <code>date_to_season.apply(flights).get('DATE')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights.apply(date_to_season).get('DATE')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights.get('DATE').apply(date_to_season)</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>flights.get('DATE').apply(date_to_season)</code></p>
<p>Our function <code>date_to_season</code> takes as input a single date
and converts it to a season. We cannot input a whole Series of dates, as
in the first answer choice. We instead need to <code>apply</code> the
function to the whole Series of dates. The correct syntax to do that is
to first extract the Series of dates from the DataFrame and then use
<code>.apply</code>, passing in the name of the function we wish to
apply to each element of the Series. Therefore, the correct answer is
<code>flights.get('DATE').apply(date_to_season)</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 97%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>King Triton, UCSD’s mascot, is quite the traveler! For this question,
we will be working with the <code>flights</code> DataFrame, which
details several facts about each of the flights that King Triton has
been on over the past few years. The first few rows of
<code>flights</code> are shown below.</p>
<center><img src='../assets/images/fa21-midterm/flights.png' width=40%></center>
<p><br></p>
<p>Here’s a description of the columns in <code>flights</code>:</p>
<ul>
<li><code>'DATE'</code>: the date on which the flight occurred. Assume
that there were no “redeye” flights that spanned multiple days.</li>
<li><code>'FLIGHT'</code>: the flight number. Note that this is not
unique; airlines reuse flight numbers on a daily basis.</li>
<li><code>'FROM'</code> and <code>'TO'</code>: the 3-letter airport code
for the departure and arrival airports, respectively. Note that it’s not
possible to have a flight from and to the same airport.</li>
<li><code>'DIST'</code>: the distance of the flight, in miles.</li>
<li><code>'HOURS'</code>: the length of the flight, in hours.</li>
<li><code>'SEAT'</code>: the kind of seat King Triton sat in on the
flight; the only possible values are <code>'WINDOW'</code>,
<code>'MIDDLE'</code>, and <code>'AISLE'</code>. <br><br></li>
</ul>
<p>Suppose we create a DataFrame called <code>socal</code> containing
only King Triton’s flights departing from SAN, LAX, or SNA (John Wayne
Airport in Orange County). <code>socal</code> has 10 rows; the bar chart
below shows how many of these 10 flights departed from each airport.</p>
<center><img src='../assets/images/fa21-midterm/socal.png' width=30%></center>
<p><br></p>
<p>Consider the DataFrame that results from merging <code>socal</code>
with itself, as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>double_merge <span class="op">=</span> socal.merge(socal, left_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;FROM&#39;</span>)</span></code></pre></div>
<p>How many rows does <code>double_merge</code> have?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="true" aria-controls="collapse5">
Click to view the solution.
</button>
</h2>
<div id="collapse5" class="accordion-collapse collapse"
aria-labelledby="heading5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 38</p>
<p>There are two flights from LAX. When we merge <code>socal</code> with
itself on the <code>'FROM'</code> column, each of these flights gets
paired up with each of these flights, for a total of four rows in the
output. That is, the first flight from LAX gets paired with both the
first and second flights from LAX. Similarly, the second flight from LAX
gets paired with both the first and second flights from LAX.</p>
<p>Following this logic, each of the five flights from SAN gets paired
with each of the five flights from SAN, for an additional 25 rows in the
output. For SNA, there will be 9 rows in the output. The total is
therefore <span class="math inline">2^2 + 5^2 + 3^2 = 4 + 25 + 9 =
38</span> rows.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 27%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>We define a “route” to be a departure and arrival airport pair. For
example, all flights from <code>'SFO'</code> to <code>'SAN'</code> make
up the “SFO to SAN route”. This is different from the “SAN to SFO
route”.</p>
<p>Fill in the blanks below so that
<code>most_frequent.get('FROM').iloc[0]</code> and
<code>most_frequent.get('TO').iloc[0]</code> correspond to the departure
and destination airports of the route that King Triton has spent the
<strong>most time flying on</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> flights.groupby(__(a)__).__(b)__</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent.reset_index().sort_values(__(c)__)</span></code></pre></div>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>['FROM', 'TO']</code></p>
<p>We want to organize flights by route. This means we need to group by
both <code>'FROM'</code> and <code>'TO'</code> so any flights with the
same pair of departure and arrival airports get grouped together. To
group by multiple columns, we must use a list containing all these
column names, as in <code>flights.groupby(['FROM', 'TO'])</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 72%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>What goes in blank (b)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>count()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>mean()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>max()</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>sum()</code></p>
<p>Every <code>.groupby</code> command needs an aggregation function!
Since we are asked to find the route that King Triton has spent the most
time flying on, we want to total the times for all flights on a given
route.</p>
<p>Note that <code>.count()</code> would tell us how many flights King
Triton has taken on each route. That’s meaningful information, but not
what we need to address the question of which route he spent the most
time flying on.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 58%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>What goes in blank (c)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>by='HOURS', ascending=True</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='HOURS', ascending=False</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='HOURS', descending=True</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='DIST', ascending=False</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>by='HOURS', ascending=False</code></p>
<p>We want to know the route that King Triton spent the most time flying
on. After we group flights by route, summing flights on the same route,
the <code>'HOURS'</code> column contains the total amount of time spent
on each route. We need <code>most_frequent.get('FROM').iloc[0]</code>
and <code>most_frequent.get('TO').iloc[0]</code> to correspond with the
departure and destination airports of the route that King Triton has
spent the most time flying on. To do this, we need to sort in descending
order of time, to bring the largest time to the top of the DataFrame. So
we must sort by <code>'HOURS'</code> with
<code>ascending=False</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
