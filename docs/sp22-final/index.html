<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Spring 2022 Final Exam</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Spring 2022 Final Exam</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc10.com</a></p>
<hr />
<p><strong>Instructor(s):</strong> Janine Tiefenbruck</p>
<p>This exam was administered in-person. The exam was closed-notes,
except students were provided a copy of the
<a href='https://drive.google.com/file/d/1mQApk9Ovdi-QVqMgnNcq5dZcWucUKoG-/view?usp=sharing'>DSC
10 Reference Sheet<a>. No calculators were allowed. Students had
<strong>3 hours</strong> to take this exam.</p>
<hr />
<p>Welcome to
<img src='../assets/images/sp22-final/ikea_logo.png' height=15> !</p>
<p>IKEA is a Swedish furniture company that designs and sells
ready-to-assemble furniture and other home furnishings. IKEA has
locations worldwide, including one in San Diego. IKEA is known for its
cheap prices, modern designs, huge showrooms, and wordless instruction
manuals. They also sell really good Swedish meatballs in their cafe!</p>
<center><img src='../assets/images/sp22-final/wordless_instructions.png' width=40%></center>
<p>This exam is all about IKEA. Here are the DataFrames you’ll be
working with:</p>
<ol type="1">
<li><code>ikea</code></li>
</ol>
<p>The <code>ikea</code> DataFrame has a row for each ready-to-assemble
IKEA furniture product. The columns are:</p>
<ul>
<li><code>'product'</code> (<code>str</code>): the name of the product,
which includes the product line as the first word, followed by a
description of the product</li>
<li><code>'category'</code> (<code>str</code>): a categorical
description of the type of product</li>
<li><code>'price'</code> (<code>int</code>): the current price of the
product, in dollars</li>
<li><code>'assembly_cost'</code> (<code>int</code>): the additional cost
to have the product assembled, in dollars</li>
<li><code>'packages'</code> (<code>int</code>): the number of packages
in which the product is boxed</li>
</ul>
<p>The first few rows of <code>ikea</code> are shown below, though
<code>ikea</code> has many more rows than pictured.</p>
<center><img src='../assets/images/sp22-final/ikeadf.png' height=250></center>
<ol start="2" type="1">
<li><code>offers</code></li>
</ol>
<p>IKEA sometimes runs certain special offers, including coupons, sales,
and promotions. For each offer currently available, the DataFrame
<code>offers</code> has a separate row for each category of products to
which the offer can be applied. The columns are:</p>
<ul>
<li><code>'offer'</code> (<code>str</code>): the name of the offer</li>
<li><code>'category'</code> (<code>str</code>): the category to which
the offer applies</li>
<li><code>'percent_off'</code> (<code>int</code>): the percent discount
when applying this offer to this category</li>
</ul>
<p>The full <code>offers</code> DataFrame is shown below. All rows are
pictured.</p>
<center><img src='../assets/images/sp22-final/offersdf.png' height=270></center>
<ol start="3" type="1">
<li><code>app_data</code></li>
</ol>
<p>An IKEA fan created an app where people can log the amount of time it
took them to assemble their IKEA furniture. The DataFrame
<code>app_data</code> has a row for each product build that was logged
on the app. The columns are:</p>
<ul>
<li><code>'product'</code> (<code>str</code>): the name of the product,
which includes the product line as the first word, followed by a
description of the product</li>
<li><code>'category'</code> (<code>str</code>): a categorical
description of the type of product</li>
<li><code>'assembly_time'</code> (<code>str</code>): the amount of time
to assemble the product, formatted as <code>'x hr, y min'</code> where
<code>x</code> and <code>y</code> represent integers, possibly zero</li>
</ul>
<p>The first few rows of <code>app_data</code> are shown below, though
<code>app_data</code> has many more rows than pictured (5000 rows
total).</p>
<center><img src='../assets/images/sp22-final/appdatadf.png' height=180></center>
<p>Assume that we have already run <code>import babypandas as bpd</code>
and <code>import numpy as np</code>.</p>
<p><strong>Tip:</strong> Open this page in another tab, so that it is
easy to refer to this data description as you work through the exam.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>Complete the expression below so that it evaluates to the name of the
product for which the average assembly cost per package is lowest.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(ikea.assign(assembly_per_package <span class="op">=</span> ___(a)___)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;assembly_per_package&#39;</span>).___(b)___)</span></code></pre></div>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>ikea.get('assembly_cost')/ikea.get('packages')</code></p>
<p>This column, as its name suggests, contains the average assembly cost
per package, obtained by dividing the total cost of each product by the
number of packages that product comes in. This code uses the fact that
arithmetic operations between two Series happens element-wise.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>get('product').iloc[0]</code></p>
<p>After adding the <code>'assembly_per_package'</code> column and
sorting by that column in the default ascending order, the product with
the lowest <code>'assembly_per_package'</code> will be in the very first
row. To access the name of that product, we need to <code>get</code> the
column containing product names and use <code>iloc</code> to access an
element of that Series by integer position.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p>Complete the expression below so that it evaluates to a DataFrame
indexed by <code>'category'</code> with one column called
<code>'price'</code> containing the median cost of the products in each
category.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ikea.___(a)___.get(___(b)___)</span></code></pre></div>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>groupby('category').median()</code></p>
<p>The question prompt says that the resulting DataFrame should be
indexed by <code>'category'</code>, so this is a hint that we may want
to group by <code>'category'</code>. When using <code>groupby</code>, we
need to specify an aggregation function, and since we’re looking for the
median cost of all products in a category, we use the
<code>.median()</code> aggregation function.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>['price']</code></p>
<p>The question prompt also says that the resulting DataFrame should
have just one column, the <code>'price'</code> column. To keep only
certain columns in a DataFrame, we use <code>.get</code>, passing in a
list of columns to keep. Remember to include the square brackets,
otherwise <code>.get</code> will return a Series instead of a
DataFrame.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>In the <code>ikea</code> DataFrame, the first word of each string in
the <code>'product'</code> column represents the product line. For
example the HEMNES line of products includes several different products,
such as beds, dressers, and bedside tables.</p>
<p>The code below assigns a new column to the <code>ikea</code>
DataFrame containing the product line associated with each product.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(ikea.assign(product_line <span class="op">=</span> ikea.get(<span class="st">&#39;product&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                .<span class="bu">apply</span>(extract_product_line)))</span></code></pre></div>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>What are the input and output types of the
<code>extract_product_line</code> function?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> takes a string as input, returns a string</p></li>
<li><p><input type="radio" disabled="" /> takes a string as input, returns a Series</p></li>
<li><p><input type="radio" disabled="" /> takes a Series as input, returns a string</p></li>
<li><p><input type="radio" disabled="" /> takes a Series as input, returns a Series</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> takes a string as input, returns a
string</p>
<p>To use the Series method <code>.apply</code>, we first need a Series,
containing values of any type. We pass in the name of a function to
<code>.apply</code> and essentially, <code>.apply</code> calls the given
function on each input of the Series, producing a Series with the
resulting outputs of those function calls. In this case,
<code>.apply(extract_product_line)</code> is called on the Series
<code>ikea.get('product')</code>, which contains string values. This
means the function <code>extract_product_line</code> must take strings
as inputs. We’re told that the code assigns a new column to the
<code>ikea</code> DataFrame containing the product line associated with
each product, and we know that the product line is a string, as it’s the
first word of the product name. This means the function
<code>extract_product_line</code> must output a string.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>Complete the return statement in the
<code>extract_product_line</code> function below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_product_line(x):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _________</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>x.split(' ')[0]</code></p>
<p>This function should take as input a string <code>x</code>,
representing a product name, and return the first word of that string,
representing the product line. Since words are separated by spaces, we
want to split the string on the space character <code>' '</code>.</p>
<p>It’s also correct to answer <code>x.split()[0]</code> without
specifying to split on spaces, because the default behavior of the
string <code>.split</code> method is to split on any whitespace, which
includes any number of spaces, tabs, newlines, etc. Since we’re only
extracting the first word, which will be separated from the rest of the
product name by a single space, it’s equivalent to split using single
spaces and using the default of any whitespace.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p>Recall that we have the complete set of currently available discounts
in the DataFrame <code>offers</code>.</p>
<p>The DataFrame <code>with_offers</code> is created as follows.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    (with_offers <span class="op">=</span> ikea.take(np.arange(<span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                       .merge(offers, left_on<span class="op">=</span><span class="st">&#39;category&#39;</span>,  </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                      right_on<span class="op">=</span><span class="st">&#39;eligible_category&#39;</span>))</span></code></pre></div>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>How many rows does <code>with_offers</code> have?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 11</p>
<p>First, consider the DataFrame <code>ikea.take(np.arange(6))</code>,
which contains the first six rows of <code>ikea</code>. We know the
contents of these first six rows from the preview of the DataFrame at
the start of this exam. To merge with <code>offers</code>, we need to
look at the <code>'category'</code> of each of these six rows and see
how many rows of <code>offers</code> have the same value in the
<code>'eligible_category'</code> column.</p>
<p>The first row of <code>ikea.take(np.arange(6))</code> is a
<code>'bed'</code>. There are two <code>'bed'</code> offers, so that
will be two rows in the output DataFrame. Similarly, the second row of
<code>ikea.take(np.arange(6))</code> creates two rows in the output
DataFrame because there are two <code>'outdoor'</code> offers. The third
row creates just one row in the output, since there is only one
<code>'dresser'</code> offer. Continuing row-by-row in this way, the
answer comes from <span class="math display">2+2+1+2+2+2 =
11.</span></p>
<p>Pandas Tutor is a really helpful tool to visualize the merge process.
Below is a color-coded visualization of this merge, generated by the
<a href="https://pandastutor.com/vis.html#code=import%20pandas%20as%20pd%0Aimport%20numpy%20as%20np%0Aimport%20io%0A%0Aikea%20%3D%20pd.DataFrame%28%29.assign%28product%3D%5B%22%C3%84PPLAR%C3%96%20Table%2B6%20armchairs,%20outdoor,%20brown%20stained%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SUNDS%C3%96%20Table%2B2%20chairs,%20outdoor,%20gray/gray%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22GLADSTAD%20Upholstered%20bed,%202%20storage%20boxes,%20Kabusa%20light%20gray,%20Twin%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%20Daybed%20frame%20with%203%20drawers,%20white,%20Twin%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%206-drawer%20chest,%20white%20stain,%2042%201/2x51%205/8%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22LAPPLAND%20TV%20storage%20unit,%20white,%2072x15%203/8x57%207/8%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20category%3D%5B%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22dresser%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22storage%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20price%3D%5B629,%20149,%20254,%20399,%20299,%20179%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20assembly_cost%3D%5B62,%2035,%2098,%2075,%2065,%2056%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20packages%3D%5B7,%203,%201,%201,%201,%201%5D%29.take%28%5B2,%200,%204,%205,%201,%203%5D%29.reset_index%28%29.drop%28columns%3D%22index%22%29%0Aoffers%20%3D%20pd.DataFrame%28%29.assign%28offer%3D%5B%22summer%20sale%22,%20%22summer%20sale%22,%20%22get%20organized%20promo%22,%20%22get%20organized%20promo%22,%20%22snooze%20sale%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20eligible_category%20%3D%20%5B%22outdoor%22,%20%22grill%22,%20%22storage%22,%20%22dresser%22,%20%22bed%22,%20%22outdoor%22,%20%22storage%22,%20%22bed%22%5D,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20percent_off%3D%5B15,%2015,%2010,%2010,%2020,%2015,%2015,%2015%5D%29%0Aikea.take%28np.arange%286%29%29.merge%28offers,%20left_on%3D'category',%20right_on%3D'eligible_category'%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A&amp;d=2022-07-27&amp;lang=py&amp;v=v1">code
here</a>.</p>
<center><img src="../assets/images/sp22-final/mergetutor.jpg" width="80%"/></center>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>How many rows of <code>with_offers</code> have a value of 20 in the
<code>'percent_off'</code> column?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> 2</p>
<p>There is just one offer with a value of 20 in the
<code>'percent_off'</code> column, and this corresponds to an offer on a
<code>'bed'</code>. Since there are two rows of
<code>ikea.take(np.arange(6))</code> with a <code>'category'</code> of
<code>'bed'</code>, each of these will match with the 20 percent-off
offer, creating two rows of <code>with_offers</code> with a value of 20
in the <code>'percent_off'</code> column.</p>
<p>The
<a href="https://pandastutor.com/vis.html#code=import%20pandas%20as%20pd%0Aimport%20numpy%20as%20np%0Aimport%20io%0A%0Aikea%20%3D%20pd.DataFrame%28%29.assign%28product%3D%5B%22%C3%84PPLAR%C3%96%20Table%2B6%20armchairs,%20outdoor,%20brown%20stained%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SUNDS%C3%96%20Table%2B2%20chairs,%20outdoor,%20gray/gray%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22GLADSTAD%20Upholstered%20bed,%202%20storage%20boxes,%20Kabusa%20light%20gray,%20Twin%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%20Daybed%20frame%20with%203%20drawers,%20white,%20Twin%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%206-drawer%20chest,%20white%20stain,%2042%201/2x51%205/8%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22LAPPLAND%20TV%20storage%20unit,%20white,%2072x15%203/8x57%207/8%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20category%3D%5B%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22dresser%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22storage%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20price%3D%5B629,%20149,%20254,%20399,%20299,%20179%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20assembly_cost%3D%5B62,%2035,%2098,%2075,%2065,%2056%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20packages%3D%5B7,%203,%201,%201,%201,%201%5D%29.take%28%5B2,%200,%204,%205,%201,%203%5D%29.reset_index%28%29.drop%28columns%3D%22index%22%29%0Aoffers%20%3D%20pd.DataFrame%28%29.assign%28offer%3D%5B%22summer%20sale%22,%20%22summer%20sale%22,%20%22get%20organized%20promo%22,%20%22get%20organized%20promo%22,%20%22snooze%20sale%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20eligible_category%20%3D%20%5B%22outdoor%22,%20%22grill%22,%20%22storage%22,%20%22dresser%22,%20%22bed%22,%20%22outdoor%22,%20%22storage%22,%20%22bed%22%5D,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20percent_off%3D%5B15,%2015,%2010,%2010,%2020,%2015,%2015,%2015%5D%29%0Aikea.take%28np.arange%286%29%29.merge%28offers,%20left_on%3D'category',%20right_on%3D'eligible_category'%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A&amp;d=2022-07-27&amp;lang=py&amp;v=v1">visualization
from Pandas Tutor</a> below confirms our answer. The two rows with a
value of 20 in the <code>'percent_off'</code> column. are both shown in
blue.</p>
<center><img src="../assets/images/sp22-final/mergetutor.jpg" width="80%"/></center>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.3">Problem 4.3</h3>
<p>If you can use just one offer per product, you’d want to use the one
that saves you the most money, which we’ll call the best offer.</p>
<p><strong>True or False</strong>: The expression below evaluates to a
Series indexed by <code>'product'</code> with the name of the best offer
for each product that appears in the <code>with_offers</code>
DataFrame.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>with_offers.groupby(<span class="st">&#39;product&#39;</span>).<span class="bu">max</span>().get(<span class="st">&#39;offer&#39;</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_3" aria-expanded="true" aria-controls="collapse4_3">
Click to view the solution.
</button>
</h2>
<div id="collapse4_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> False</p>
<p>Recall that <code>groupby</code> applies the aggregation function
separately to each column. The value in the <code>'offer'</code> column
for each group is the latest in alphabetical order, whereas the value in
the <code>'percent_off'</code> column is the largest numerical value.
These don’t necessarily go together in <code>with_offers</code>.</p>
<p>In particular, the element of
<code>with_offers.groupby('product').max().get('offer')</code>
corresponding to the LAPPLAND TV storage unit will be
<code>'get_organized_promo'</code>. This happens because the two rows of
<code>with_offers</code> corresponding to the LAPPLAND TV storage unit
have values of <code>'get_organized_promo'</code> and
<code>'birthday coupon'</code>, but <code>'get_organized_promo'</code>
is alphabetically later, so it’s considered the max by
<code>.groupby</code>. However, the <code>'birthday coupon'</code> is
actually a better offer, since it’s 15 percent off, while the
<code>'get_organized_promo'</code> is only 10 percent off. The
expression does not actually find the best offer for each product, but
instead finds the latest alphabetical offer for each product.</p>
<p>We can see this directly by looking at the output of Pandas Tutor
below, generated by
<a href="https://pandastutor.com/vis.html#code=import%20pandas%20as%20pd%0Aimport%20numpy%20as%20np%0Aimport%20io%0A%0Aikea%20%3D%20pd.DataFrame%28%29.assign%28product%3D%5B%22%C3%84PPLAR%C3%96%20Table%2B6%20armchairs,%20outdoor,%20brown%20stained%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22SUNDS%C3%96%20Table%2B2%20chairs,%20outdoor,%20gray/gray%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22GLADSTAD%20Upholstered%20bed,%202%20storage%20boxes,%20Kabusa%20light%20gray,%20Twin%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%20Daybed%20frame%20with%203%20drawers,%20white,%20Twin%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22HEMNES%206-drawer%20chest,%20white%20stain,%2042%201/2x51%205/8%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22LAPPLAND%20TV%20storage%20unit,%20white,%2072x15%203/8x57%207/8%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20category%3D%5B%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22outdoor%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22bed%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22dresser%22,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22storage%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20price%3D%5B629,%20149,%20254,%20399,%20299,%20179%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20assembly_cost%3D%5B62,%2035,%2098,%2075,%2065,%2056%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20packages%3D%5B7,%203,%201,%201,%201,%201%5D%29.take%28%5B2,%200,%204,%205,%201,%203%5D%29.reset_index%28%29.drop%28columns%3D%22index%22%29%0Aoffers%20%3D%20pd.DataFrame%28%29.assign%28offer%3D%5B%22summer%20sale%22,%20%22summer%20sale%22,%20%22get%20organized%20promo%22,%20%22get%20organized%20promo%22,%20%22snooze%20sale%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22,%20%22birthday%20coupon%22%5D,%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20eligible_category%20%3D%20%5B%22outdoor%22,%20%22grill%22,%20%22storage%22,%20%22dresser%22,%20%22bed%22,%20%22outdoor%22,%20%22storage%22,%20%22bed%22%5D,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20percent_off%3D%5B15,%2015,%2010,%2010,%2020,%2015,%2015,%2015%5D%29%0Awith_offers%20%3D%20ikea.take%28np.arange%286%29%29.merge%28offers,%20left_on%3D'category',%20right_on%3D'eligible_category'%29%0Awith_offers.groupby%28'product'%29.max%28%29.get%28'offer'%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A&amp;d=2022-07-27&amp;lang=py&amp;v=v1">this
code</a>.</p>
<center><img src="../assets/images/sp22-final/maxtutor.jpg" width="80%"/></center>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.4">Problem 4.4</h3>
<p>You want to add a column to <code>with_offers</code> containing the
price after the offer discount is applied.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>with_offers <span class="op">=</span> with_offers.assign(after_price <span class="op">=</span> _________)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>with_offers</span></code></pre></div>
<p>Which of the following could go in the blank? Select all that
apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>with_offers.get('price') - with_offers.get('percent_off')/100</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>with_offers.get('price')*(100 - with_offers.get('percent_off'))/100</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>with_offers.get('price') - with_offers.get('price')*with_offers.get('percent_off')/100</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_4" aria-expanded="true" aria-controls="collapse4_4">
Click to view the solution.
</button>
</h2>
<div id="collapse4_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading4_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>with_offers.get('price')*(100 - with_offers.get('percent_off'))/100</code>,
<code>(with_offers.get('price') - with_offers.get('price')*with_offers.get('percent_off')/100)</code></p>
<p>Notice that all the answer choices use
<code>with_offers.get('price')</code>, which is a Series of prices and
<code>with_offers.get('percent_off')</code>, which is a Series of
associated percentages off. Using Series artithmetic, which works
element-wise, the goal is to create a Series of prices after the
discount is applied.</p>
<p>For example, the first row of <code>with_offers</code> corresponds to
an item with a price of 254 dollars, and a discount of 20 percent off,
coming from the snooze sale. This means its price after the discount
should be 80 percent of the original value, which is <span class="math inline">254*0.8 = 203.2</span> dollars.</p>
<p>Let’s go through each answer in order, working with this example.</p>
<p>The first answer choice takes the price and subtracts the percent off
divided by 100. For our example, this would compute the discounted price
as <span class="math inline">254 - 20/100 = 253.8</span> dollars, which
is incorrect.</p>
<p>The second answer choice multiplies by the price by the quantity 100
minus the percent off, then divides by 100. This works because the when
we subtract the percent off from 100 and divide by 100, this represents
the proportion or fraction of the cost we must pay, and so multiplying
by the price gives the price after the discount. For our example, this
comes out to <span class="math inline">254*(100-20)/100= 203.2</span>
dollars.</p>
<p>The third answer choice is also correct. This corresponds to taking
original price and subtracting from it the dollar amount off, which
comes from multiplying the price by the percent off and dividing by 100.
For our example, this would be computed as <span class="math inline">254
- 254*20/100 = 203.2</span> dollars.</p>
<p>The fourth answer multiplies the price by the quantity 100 minus the
percent off divided by 100. For our example, this would compute the
discounted price as <span class="math inline">254*(100 - 20/100) =
25349.2</span> dollars, a number that’s nearly one hundred times the
original price!</p>
<p>Therefore, only the second and third answer choices are correct.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p>LEM</p>
<p>Recall that an IKEA fan created an app for people to log the amount
of time it takes them to assemble an IKEA product. We have this data in
<code>app_data</code>.</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Suppose that when someone downloads the app, the app requires them to
choose a username, which must be different from all other registered
usernames.</p>
<p><strong>True or False</strong>: If <code>app_data</code> had included
a column with the username of the person who reported each product
build, it would make sense to index <code>app_data</code> by
username.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> False</p>
<p>Even though people must have distinct usernames, one person can build
multiple different IKEA products and log their time for each build. So
we don’t expect every row of <code>app_data</code> to have a distinct
username associated with it, and therefore username would not be
suitable as an index, since the index should have distinct values.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>What does the code below evaluate to?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(app_data.take(np.arange(<span class="dv">4</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>         .sort_values(by<span class="op">=</span><span class="st">&#39;assembly_time&#39;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         .get(<span class="st">&#39;assembly_time&#39;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         .iloc[<span class="dv">0</span>])</span></code></pre></div>
<p><em>Hint:</em> The <code>'assembly_time'</code> column contains
strings.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>'1 hr, 45 min'</code></p>
<p>The code says that we should take the first four rows of
<code>app_data</code> (which we can see in the preview at the start of
this exam), sort the rows in ascending order of
<code>'assembly_time'</code>, and extract the very first entry of the
<code>'assembly_time'</code> column. In other words, we have to find the
<code>'assembly_time'</code> value that would be first when sorted in
ascending order. As given in the hint, the <code>'assembly_time'</code>
column contains strings, and strings get sorted alphabetically, so we
are looking for the assembly time, among the first four, that would come
first alphabetically. This is <code>'1 hr, 45 min'</code>.</p>
<p>Note that first alphabetically does not correspond to the least
amount of time. <code>'1 hr, 5 min'</code>represents less time than
<code>'1 hr, 45 min'</code>, but in alphabetical order
<code>'1 hr, 45 min'</code> comes before <code>'1 hr, 5 min'</code>
because both start with the same characters <code>'1 hr, '</code> and
comparing the next character, <code>'4'</code> comes before
<code>'5'</code>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Complete the implementation of the <code>to_minutes</code> function
below. This function takes as input a string formatted as
<code>x hr, y min' where</code>x<code>and</code>y<code>represent integers, and returns the corresponding number of minutes, **as an integer** (type</code>int`
in Python).</p>
<p>For example, <code>to_minutes('3 hr, 5 min')</code> should return
185.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> to_minutes(time):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    first_split <span class="op">=</span> time.split(<span class="st">&#39; hr, &#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    second_split <span class="op">=</span> first_split[<span class="dv">1</span>].split(<span class="st">&#39; min&#39;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _________</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>int(first_split[0])*60+int(second_split[0])</code></p>
<p>As the last subpart demonstrated, if we want to compare times, it
doesn’t make sense to do so when times are represented as strings. In
the <code>to_minutes</code> function, we convert a time string into an
integer number of minutes.</p>
<p>The first step is to understand the logic. Every hour contains 60
minutes, so for a time string formatted like <code>x hr, y min'</code>
the total number of minutes comes from multiplying the value of
<code>x</code> by 60 and adding <code>y</code>.</p>
<p>The second step is to understand how to extract the <code>x</code>
and <code>y</code> values from the time string using the string methods
<code>.split</code>. The string method <code>.split</code> takes as
input some separator string and breaks the string into pieces at each
instance of the separator string. It then returns a list of all those
pieces. The first line of code, therefore, creates a list called
<code>first_split</code> containing two elements. The first element,
accessed by <code>first_split[0]</code> contains the part of the time
string that comes before <code>' hr, '</code>. That is,
<code>first_split[0]</code> evaluates to the string <code>x</code>.</p>
<p>Similarly, <code>first_split[1]</code> contains the part of the time
string that comes after <code>' hr, '</code>. So it is formatted like
<code>'y min'</code>. If we split this string again using the separator
of <code>' min'</code>, the result will be a list whose first element is
the string <code>'y'</code>. This list is saved as
<code>second_split</code> so <code>second_split[0]</code> evaluates to
the string <code>y</code>.</p>
<p>Now we have the pieces we need to compute the number of minutes,
using the idea of multiplying the value of <code>x</code> by 60 and
adding <code>y</code>. We have to be careful with data types here, as
the bolded instructions warn us that the function must return an
integer. Right now, <code>first_split[0]</code> evaluates to the string
<code>x</code> and <code>second_split[0]</code> evaluates to the string
<code>y</code>. We need to convert these strings to integers before we
can multiply and add. Once we convert using the <code>int</code>
function, then we can multiply the number of hours by 60 and add the
number of minutes. Therefore, the solution is
<code>int(first_split[0])*60+int(second_split[0])</code>.</p>
<p>Note that failure to convert strings to integers using the
<code>int</code> function would lead to very different behavior. Let’s
take the example time string of <code>'3 hr, 5 min'</code> as input to
our function. With the return statement as
<code>int(first_split[0])*60+int(second_split[0])</code>, the function
would return 185 on this input, as desired. With the return statment as
<code>first_split[0]*60+second_split[0]</code>, the function would
return a string of length 61, looking something like this
<code>'3333...33335'</code>. That’s because the <code>*</code> and
<code>+</code> symbols do have meaning for strings, they’re just
different meanings than when used with integers.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.4">Problem 5.4</h3>
<p>You want to add to <code>app_data</code> a column called
<code>'minutes'</code> with integer values representing the number of
minutes it took to assemble each product.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>app_data <span class="op">=</span> app_data.assign(minutes <span class="op">=</span> _________)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>app_data</span></code></pre></div>
<p>Which of the following should go in the blank?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>to_minutes('assembly_time')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>to_minutes(app_data.get('assembly_time'))</code></p></li>
<li><p><input type="radio" disabled="" /> <code>app_data.get('assembly_time').apply(to_minutes)</code></p></li>
<li><p><input type="radio" disabled="" /> <code>app_data.get('assembly_time').apply(to_minutes(time))</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_4" aria-expanded="true" aria-controls="collapse5_4">
Click to view the solution.
</button>
</h2>
<div id="collapse5_4" class="accordion-collapse collapse collapse"
aria-labelledby="heading5_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>app_data.get('assembly_time').apply(to_minutes)</code></p>
<p>We want to create a Series of times in minutes, since it’s to be
added to the <code>app_data</code> DataFrame using <code>.assign</code>.
The correct way to do that is to use <code>.apply</code> so that our
function, which works for one input time string, can be applied
separately to every time string in the <code>'assembly_time'</code>
column of <code>app_data</code>. Remember that <code>.apply</code> takes
as input one parameter, the name of the function to apply, with no
arguments. The correct syntax is
<code>app_data.get('assembly_time').apply(to_minutes)</code>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p>We want to use <code>app_data</code> to estimate the average amount of time it takes to build an IKEA bed (any product in the ‘bed’ category). Which of the following strategies would be an appropriate way to estimate this quantity? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Query to keep only the beds. Then resample with replacement many times. For each resample, take the mean of the <code>'minutes'</code> column. Compute a 95% confidence interval based on those means.</p></li>
<li><p><input type="radio" disabled="" /> Query to keep only the beds. Group by <code>'product'</code> using the mean aggregation function. Then resample with replacement many times. For each resample, take the mean of the <code>'minutes'</code> column. Compute a 95% confidence interval based on those means.</p></li>
<li><p><input type="radio" disabled="" /> Resample with replacement many times. For each resample, first query to keep only the beds and then take the mean of the <code>'minutes'</code> column. Compute a 95% confidence interval based on those means.</p></li>
<li><p><input type="radio" disabled="" /> Resample with replacement many times. For each resample, first query to keep only the beds. Then group by <code>'product'</code> using the mean aggregation function, and finally take the mean of the <code>'minutes'</code> column. Compute a 95% confidence interval based on those means.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6" aria-expanded="true" aria-controls="collapse6">
Click to view the solution.
</button>
</h2>
<div id="collapse6" class="accordion-collapse collapse collapse" aria-labelledby="heading6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong></p>
<p>Only the first answer is correct. This is a question of parameter estimation, so our approach is to use bootstrapping to create many resamples of our original sample, computing the average of each resample. Each resample should always be the same size as the original sample. The first answer choice accomplishes this by querying first to keep only the beds, then resampling from the DataFrame of beds only. This means resamples will have the same size as the original sample. Each resample’s mean will be computed, so we will have many resample means from which to construct our 95% confidence interval.</p>
<p>In the second answer choice, we are actually taking the mean twice. We first average the build times for all builds of the same product when grouping by product. This produces a DataFrame of different products with the average build time for each. We then resample from this DataFrame, computing the average of each resample. But this is a resample of products, not of product builds. The size of the resample is the number of unique products in <code>app_data</code>, not the number of reported product builds in <code>app_data</code>. Further, we get incorrect results by averaging numbers that are already averages. For example, if 5 people build bed A and it takes them each 1 hour, and 1 person builds bed B and it takes them 10 hours, the average amount of time to build a bed is <span class="math inline">\frac{5*1+10}{6} = 2.5</span>. But if we average the times for bed A (1 hour) and average the times for bed B (5 hours), then average those, we get <span class="math inline">\frac{1+5}{2} = 3</span>, which is not the same. Taking the average of averages is not the same as taking an average, so this approach is incorrect. More generally, grouping is not a part of the bootstrapping process because we want each data value to be weighted equally.</p>
<p>The last two answer choices are incorrect because they involve resampling from the full <code>app_data</code> DataFrame before querying to keep only the beds. This is incorrect because it does not preserve the sample size. For example, if <code>app_data</code> contains 1000 reported bed builds and 4000 other product builds, then the only relevant data is the 1000 bed build times, so when we resample, we want to consider another set of 1000 beds. If we resample from the full <code>app_data</code> DataFrame, our resample will contain 5000 rows, but the number of beds will be random, not necessarily 1000. If we query first to keep only the beds, then resample, our resample will contain exactly 1000 beds every time. As an added bonus, since we only care about beds, it’s much faster to resample from a smaller DataFrame of beds only than it is to resample from all <code>app_data</code> with plenty of rows we don’t care about.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p>Laura built the LAPPLAND TV storage unit in 2 hours and 30 minutes, and she thinks she worked at an average speed. If you want to see whether the average time to build the TV storage unit is indeed 2 hours and 30 minutes using the sample of assembly times in <code>app_data</code>, which of the following tools <strong>could</strong> you use to help you? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> hypothesis testing</p></li>
<li><p><input type="radio" disabled="" /> permutation testing</p></li>
<li><p><input type="radio" disabled="" /> bootstrapping</p></li>
<li><p><input type="radio" disabled="" /> Central Limit Theorem</p></li>
<li><p><input type="radio" disabled="" /> confidence interval</p></li>
<li><p><input type="radio" disabled="" /> regression</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7" aria-expanded="true" aria-controls="collapse7">
Click to view the solution.
</button>
</h2>
<div id="collapse7" class="accordion-collapse collapse collapse" aria-labelledby="heading7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> hypothesis testing, bootstrapping, Central Limit Theorem, confidence interval</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
