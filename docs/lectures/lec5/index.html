<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Lecture 5 — Practice</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../assets/theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Lecture 5 — Practice</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../../index.html">← return to practice.dsc10.com</a></p>
<hr />
<h1 id="lecture-5-collected-practice-questions">Lecture 5 — Collected
Practice Questions</h1>
<p>Below are practice problems tagged for Lecture <strong>5</strong>
(rendered directly from the original exam/quiz sources).</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p>In this question, we’ll keep working with the
<code>art_museums</code> DataFrame.</p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>(Remember to keep the data description from the top of the exam open
in another tab!)</p>
<p><code>'Tate Modern'</code> is the most popular art museum in London.
But what’s the most popular art museum in each city?</p>
<p>It turns out that there’s no way to answer this easily using the
tools that you know about so far. To help, we’ve created a new Series
method, <code>.last()</code>. If <code>s</code> is a Series,
<code>s.last()</code> returns the last element of <code>s</code>
(i.e. the element at the very end of <code>s</code>).
<code>.last()</code> works with <code>.groupby</code>, too (just like
<code>.mean()</code> and <code>.count()</code>).</p>
<p>Fill in the blanks so that the code below correctly assigns
<code>best_per_city</code> to a DataFrame with one row per city, that
describes the name, number of visitors, and rank of the most visited art
museum in each city. <code>best_per_city</code> should be sorted in
decreasing order of number of visitors. The first few rows of
<code>best_per_city</code> are shown below.</p>
<center><img src='../../assets/images/fa21-final/best_per_city.png' width=40%></center>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>best_per_city <span class="op">=</span> __(a)__.groupby(__(b)__).last().__(c)__</span></code></pre></div>
<ol type="1">
<li>What goes in blank (a)?</li>
<li>What goes in blank (b)?</li>
<li>What goes in blank (c)?</li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answers:</strong></p>
<ol type="1">
<li><code>art_museums.sort_values('Visitors', ascending=True)</code></li>
<li><code>'City'</code></li>
<li><code>sort_values('Visitors', ascending=False)</code></li>
</ol>
<p>Let’s take a look at the completed implementation.</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>best_per_city <span class="op">=</span> art_museums.sort_values(<span class="st">'Visitors'</span>, ascending<span class="op">=</span><span class="va">True</span>).groupby(<span class="st">'City'</span>).last().sort_values(<span class="st">'Visitors'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>We first sort the row in <code>art_museums</code> by the number of
<code>'Visitors'</code> in <code>ascending</code> order. Then
<code>goupby('City')</code>, so that we have one row per city. Recall,
we need an aggregation method after using <code>groupby()</code>. In
this question, we use <code>last()</code> to only keep the one last row
for each city. Since in blank (a) we have sorted the rows by
<code>'Visitors'</code>, so <code>last()</code> keeps the row that
contains the name of the most visited museum in that city. At last we
sort this new DataFrame by <code>'Visitors'</code> in descending order
to fulfill the question’s requirement.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 65%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>Assume you’ve defined <code>best_per_city</code> correctly.</p>
<p>Which of the following options evaluates to the number of visitors to
the most visited art museum in Amsterdam? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>best_per_city.get('Visitors').loc['Amsterdam']</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>best_per_city.get('Visitors').loc['Amsterdam']</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code>,
<code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code>
(Select all except “None of the above”)</p>
<p><code>best_per_city.get('Visitors').loc['Amsterdam']</code> We first
use <code>.get(column_name)</code> to get a series with number of
visitors to the most visited art museum, and then locate the number of
visitors to the most visited art museum in Amsterdam using
<code>.loc[index]</code> since we have <code>"City"</code> as index.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[0]</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>iloc[0]</code> to access the first and the only value in this
column.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').iloc[-1]</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>iloc[-1]</code> to access the last and the only value in this
column.</p>
<p><code>best_per_city[best_per_city.index == 'Amsterdam'].get('Visitors').loc['Amsterdam']</code>
We first query the <code>best_per_city</code> to only include the
DataFrame with one row with index <code>'Amsterdam'</code>. Then, we get
the <code>'Visitors'</code> column of this DataFrame. Finally, we use
<code>loc['Amsterdam']</code> to access the value in this column with
index <code>'Amsterdam'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Which of these correctly evaluates to the number of flights King
Triton took to San Diego (airport code <code>'SAN'</code>)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>flights.loc['SAN'].shape[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[flights.get('TO') == 'SAN'].shape[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[flights.get('TO') == 'SAN'].shape[1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>len(flights.sort_values('TO', ascending=False).loc['SAN'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>flights[flights.get('TO') == 'SAN'].shape[0]</code></p>
<p>The strategy is to create a DataFrame with only the flights that went
to San Diego, then count the number of rows. The first step is to query
with the condition <code>flights.get('TO') == 'SAN'</code> and the
second step is to extract the number of rows with
<code>.shape[0]</code>.</p>
<p>Some of the other answer choices use <code>.loc['SAN']</code> but
<code>.loc</code> only works with the index, and <code>flights</code>
does not have airport codes in its index.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Fill in the blanks below so that the result also evaluates to the
number of flights King Triton took to San Diego (airport code
<code>'SAN'</code>).</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(__(a)__).count().get(<span class="st">&#39;FLIGHT&#39;</span>).__(b)__            </span></code></pre></div>
<p>What goes in blank (a)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>'DATE'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FLIGHT'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'FROM'</code></p></li>
<li><p><input type="radio" disabled="" /> <code>'TO'</code></p></li>
</ul>
<p>What goes in blank (b)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index[0]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.index[-1]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.loc['SAN']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.iloc['SAN']</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.iloc[0]</code></p></li>
</ul>
<p>True or False: If we change <code>.get('FLIGHT')</code> to
<code>.get('SEAT')</code>, the results of the above code block will not
change. (You may assume you answered the previous two subparts
correctly.)</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>'TO'</code>,
<code>.loc['SAN']</code>, True</p>
<p>The strategy here is to group all of King Triton’s flights according
to where they landed, and count up the number that landed in San Diego.
The expression <code>flights.groupby('TO').count()</code> evaluates to a
DataFrame indexed by arrival airport where, for any arrival airport,
each column has a count of the number of King Triton’s flights that
landed at that airport. To get the count for San Diego, we need the
entry in any column for the row corresponding to San Diego. The code
<code>.get('FLIGHT')</code> says we’ll use the <code>'FLIGHT'</code>
column, but any other column would be equivalent. To access the entry of
this column corresponding to San Diego, we have to use <code>.loc</code>
because we know the name of the value in the index should be
<code>'SAN'</code>, but we don’t know the row number or integer
position.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Consider the DataFrame <code>san</code>, defined below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>san <span class="op">=</span> flights[(flights.get(<span class="st">&#39;FROM&#39;</span>) <span class="op">==</span> <span class="st">&#39;SAN&#39;</span>) <span class="op">&amp;</span> (flights.get(<span class="st">&#39;TO&#39;</span>) <span class="op">==</span> <span class="st">&#39;SAN&#39;</span>)]</span></code></pre></div>
<p>Which of these DataFrames <strong>must</strong> have the same number
of rows as <code>san</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'SAN') and (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'SAN') | (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'SAN')]</code></p></li>
<li><p><input type="radio" disabled="" /> <code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code></p>
<p>The DataFrame <code>san</code> contains all rows of
<code>flights</code> that have a departure airport of <code>'SAN'</code>
and an arrival airport of <code>'SAN'</code>. But as you may know, and
as you’re told in the data description, there are no flights from an
airport to itself. So <code>san</code> is actually an empty DataFrame
with no rows!</p>
<p>We just need to find which of the other DataFrames would necessarily
be empty, and we can see that
<code>flights[(flights.get('FROM') == 'LAX') &amp; (flights.get('TO') == 'LAX')]</code>
will be empty for the same reason.</p>
<p>Note that none of the other answer choices are correct. The first
option uses the Python keyword <code>and</code> instead of the symbol
<code>&amp;</code>, which behaves unexpectedly but does not give an
empty DataFrame. The second option will be non-empty because it will
contain all flights that have San Diego as the departure airport or
arrival airport, and we already know from the first few rows of
<code>flight</code> that there are some of these. The third option will
contain all the flights that King Triton has taken from
<code>'LAX'</code> to <code>'SAN'</code>. Perhaps he’s never flown this
route, or perhaps he has. This DataFrame could be empty, but it’s not
necessarily going to be empty, as the question requires.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 70%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p>We define a “route” to be a departure and arrival airport pair. For
example, all flights from <code>'SFO'</code> to <code>'SAN'</code> make
up the “SFO to SAN route”. This is different from the “SAN to SFO
route”.</p>
<p>Fill in the blanks below so that
<code>most_frequent.get('FROM').iloc[0]</code> and
<code>most_frequent.get('TO').iloc[0]</code> correspond to the departure
and destination airports of the route that King Triton has spent the
<strong>most time flying on</strong>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> flights.groupby(__(a)__).__(b)__</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent.reset_index().sort_values(__(c)__)</span></code></pre></div>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>['FROM', 'TO']</code></p>
<p>We want to organize flights by route. This means we need to group by
both <code>'FROM'</code> and <code>'TO'</code> so any flights with the
same pair of departure and arrival airports get grouped together. To
group by multiple columns, we must use a list containing all these
column names, as in <code>flights.groupby(['FROM', 'TO'])</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 72%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>What goes in blank (b)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>count()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>mean()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>max()</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>sum()</code></p>
<p>Every <code>.groupby</code> command needs an aggregation function!
Since we are asked to find the route that King Triton has spent the most
time flying on, we want to total the times for all flights on a given
route.</p>
<p>Note that <code>.count()</code> would tell us how many flights King
Triton has taken on each route. That’s meaningful information, but not
what we need to address the question of which route he spent the most
time flying on.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 58%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p>What goes in blank (c)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>by='HOURS', ascending=True</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='HOURS', ascending=False</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='HOURS', descending=True</code></p></li>
<li><p><input type="radio" disabled="" /> <code>by='DIST', ascending=False</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>by='HOURS', ascending=False</code></p>
<p>We want to know the route that King Triton spent the most time flying
on. After we group flights by route, summing flights on the same route,
the <code>'HOURS'</code> column contains the total amount of time spent
on each route. We need <code>most_frequent.get('FROM').iloc[0]</code>
and <code>most_frequent.get('TO').iloc[0]</code> to correspond with the
departure and destination airports of the route that King Triton has
spent the most time flying on. To do this, we need to sort in descending
order of time, to bring the largest time to the top of the DataFrame. So
we must sort by <code>'HOURS'</code> with
<code>ascending=False</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> fa22-midterm — Q4</p>
<h2 id="problem-4">Problem 4</h2>
<p>Suppose we’ve run the following line of code. ​</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode py"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> evs.groupby(<span class="st">&quot;Brand&quot;</span>).count()</span></code></pre></div>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>What value does <code>counts.get("Range").sum()</code> evaluate
to?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 32</p>
<p><code>counts</code> is a DataFrame with one row per
<code>"Brand"</code>, since we grouped by <code>"Brand"</code>. Since we
used the <code>.count()</code> aggregation method, the columns in
<code>counts</code> will all be the same – they will all contain the
number of rows in <code>evs</code> for each <code>"Brand"</code>
(i.e. they will all contain the distribution of <code>"Brand"</code>).
If we sum up the values in any one of the columns in
<code>counts</code>, then, the result will be the total number of rows
in <code>evs</code>, which we know to be 32. Thus,
<code>counts.get("Range").sum()</code> is 32.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 56%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>What value does <code>counts.index[3]</code> evaluate to?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>"Tesla"</code></p>
<p>Since we grouped by <code>"Brand"</code> to create
<code>counts</code>, the index of <code>counts</code> will be
<code>"Brand"</code>, sorted alphabetically (this sorting happens
automatically when grouping). This means that <code>counts.index</code>
will be the array-like sequence
<code>["Audi", "BMW", "Nissan", "Tesla"]</code>, and
<code>counts.index[3]</code> is <code>"Tesla"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 33%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> fa23-final — Q3</p>
<h2 id="problem-5">Problem 5</h2>
<p>Consider the variable <code>is_fraud_mean</code>, defined below.</p>
<pre><code>is_fraud_mean = txn.get(&quot;is_fraud&quot;).mean()</code></pre>
<p>Which of the following expressions are equivalent to
<code>is_fraud_mean</code>? <strong>Select all that apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>txn.groupby("is_fraud").mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>txn.get("is_fraud").sum() / txn.shape[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>np.count_nonzero(txn.get("is_fraud")) / txn.shape[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>(txn.get("is_fraud") &gt; 0.8).mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>1 - (txn.get("is_fraud") == 0).mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="true" aria-controls="collapse5">
Click to view the solution.
</button>
</h2>
<div id="collapse5" class="accordion-collapse collapse"
aria-labelledby="heading5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> B, C, D, and E.</p>
<p>The correct responses are B, C, D, and E. First, we must see that
<code>txn.get("is_fraud").mean()</code> will calculate the mean of the
<code>"is_fraud"</code> column, which is a float representing the
proportion of values in the <code>"is_fraud"</code> column that are
True. With this in mind, we can consider each option:</p>
<ul>
<li><p>Option A: This operation will result in a DataFrame. We first
group by <code>"is_fraud"</code>, creating one row for fraudulent
transactions and one row for non-fraudulent ones. We then take the mean
of each numerical column, which will determine the entries of the
DataFrame. Since this results in a DataFrame and not a float, this
answer choice cannot be correct.</p></li>
<li><p>Option B: Here we simply take the mean of the
<code>"is_fraud"</code> column using the definition of the mean as the
sum of the values divided by the nuber of values. This is equivalent to
the original.</p></li>
<li><p>Option C: <code>np.count_nonzero</code> will return the number of
nonzero values in a sequence. Since we only have True and False values
in the <code>"is_fraud"</code> column, and Python considers
<code>True</code> to be 1 and <code>False</code> to be 0, this means
counting the number of ones is equivalent to the sum of all the values.
So, we end up with an expression equivalent to the formula for the mean
which we saw in part B.</p></li>
<li><p>Option D: Recall that <code>"is_fraud"</code> contains Boolean
values, and that <code>True</code> evaluates to 1 and <code>False</code>
evaluates to 0. <code>txn.get("is_fraud") &gt; 0.8</code> conducts an
elementwise comparison, evaluating if each value in the column is
greater than 0.8, and returning the resulting Series of Booleans. Any
<code>True</code> (1) value in the column will be greater than 0.8, so
this expression will evaluate to <code>True</code>. Any
<code>False</code> (0) value will still evaluate to <code>False</code>,
so the values in the resulting Series will be identical to the original
column. Therefore, taking the mean of either will give the same
value.</p></li>
<li><p>Option E: <code>txn.get("is_fraud") == 0</code> performs an
elementwise comparison, returning a series which has the value
<code>True</code> where <code>"is_fraud"</code> is <code>False</code>
(0), and <code>False</code> where <code>"is_fraud"</code> is
<code>True</code>. Therefore the mean of this Series represents the
proportion of values in the <code>"is_fraud"</code> column that are
<code>False</code>. Since every value in that column is either
<code>False</code> or <code>True</code>, the proportion of
<code>True</code> values is equivalent to one minus the proportion of
<code>False</code> values.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> fa23-midterm — Q2</p>
<h2 id="problem-6">Problem 6</h2>
<p>Suppose we define the three variables below.</p>
<pre><code>J = living_cost.get(&quot;county&quot;) == &quot;Benton County&quot;
K = living_cost.get(&quot;state&quot;) == &quot;IN&quot;
L = living_cost.get(&quot;family_type&quot;) == &quot;1a2c&quot;</code></pre>
<p>Feel free to use these variables in your solutions to the following
questions.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Fill in the blanks so that the expression below evaluates to the
average yearly childcare cost for families with one adult and two
children in Benton County, IN.</p>
<pre><code>    __(a)__.__(b)__.iloc[0]</code></pre>
<ol type="1">
<li><p>What goes in blank (a)?</p></li>
<li><p>What goes in blank (b)?</p></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ol type="1">
<li><code>living_cost[J &amp; K &amp; L]</code></li>
</ol>
<p>The first step is to query the rows in the DataFrame that meet our
specific criteria. In this case, we want the rows in the DataFrame where
the county is <code>"Benton County"</code>, the state is
<code>"IN"</code>, and the family has 1 adult and 2 children.
<code>J</code>, <code>K</code>, and <code>L</code> specify these
criteria. When used to query the <code>living_cost</code> DataFrame, we
are able to obtain a DataFrame with only one row, corresponding this
family type in this specific county.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
<p><strong>Answer:</strong></p>
<ol start="2" type="1">
<li><code>get("avg_childcare_cost")</code></li>
</ol>
<p>Once we have a DataFrame that contains the row we need, we need to
use it to get the average yearly childcare cost. To do that, we get out
the <code>"avg_childcare_cost"</code> column and access the entry in row
0 with <code>.iloc[0]</code>. This works because after querying, there
is only one row, and it corresponds exactly to the families with one
adult and two children in Benton County, IN. </p>
<hr/>
<h5>Difficulty:
⭐️⭐️⭐️</h5>
<p>The average score on this problem was 57%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Fill in the blanks so that the expression below evaluates to the
number of states with a county named Benton County.</p>
<pre><code>    __(c)__.__(d)__ / 10</code></pre>
<ol type="1">
<li><p>What goes in blank (c)?</p></li>
<li><p>What goes in blank (d)?</p></li>
</ol>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ol type="1">
<li><code>living_cost[J]</code></li>
</ol>
<p>Since we want to find how many states have a county named
<code>"Benton County"</code>, we first want to obtain all the rows of
the DataFrame where the county is <code>"Benton County"</code>. Variable
<code>J</code> specifies this condition, so we use it to query and
obtain a DataFrame with the rows in <code>living_cost</code> where the
county is <code>"Benton County."</code></p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 60%.</p>
<p><strong>Answer:</strong></p>
<ol start="2" type="1">
<li><code>shape[0]</code></li>
</ol>
<p>Now that we have all the rows in the DataFrame where the county is
<code>"Benton County"</code>, let’s consider how many rows it has. Each
row of this DataFrame represents a unique combination of
<code>"state"</code> and <code>"family_type"</code> for counties called
<code>"Benton County"</code>. We know from the data description that
each of the ten family structures is present in each county. This means
that for each state with a county called <code>"Benton County"</code>,
our DataFrame has exactly ten rows. Therefore, the number of states with
a county called <code>"Benton County"</code> is the total number of rows
in our DataFrame divided by ten. Therefore, we should fill in blank (d)
with <code>.shape[0]</code> to extract the number of rows from our
DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 40%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> fa24-midterm — Q5</p>
<h2 id="problem-7">Problem 7</h2>
<p>Write a Python expression that evaluates to the address of the house
with the most pieces of candy available (the most
<strong>pieces</strong>, not the most varieties).</p>
<p>It’s okay if you need to write on multiple lines, but your code
should represent a single expression in Python.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7" aria-expanded="true" aria-controls="collapse7">
Click to view the solution.
</button>
</h2>
<div id="collapse7" class="accordion-collapse collapse"
aria-labelledby="heading7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:
<code>treat.groupby("address").sum().sort_values(by="how_many", ascending = False).index[0]</code>
or
<code>treat.groupby("addresss").sum().sort_values(by="how_many").index[-1]</code></p>
<p>In the <code>treat</code> DataFrame, there are multiple rows for each
address, one for each candy they are giving out with their quantity.
Since we want the address with the most pieces of candy available, we
need to combine this information, so we start by grouping by address:
<code>treat.groupby(“address”)</code>. Now, since we want to add the
number of candy available per address, we use the <code>sum()</code>
aggregate function. So now we have a DataFrame with one row per address
where there value in each column is the sum of all the values. To get
the address with the most pieces of candy available, we can simply sort
by the <code>“how_many”</code> column since this stores the total amount
of candy per house. Setting <code>ascending=False</code> means that the
address with the greatest amount of candy will be the first row. Since
the addresses are located in the index as a result of the
<code>groupby</code>, we can access this value by using
<code>index[0]</code>.</p>
<p>Note: If you do not set <code>ascending=False</code>, then the
address with the most amount of candy available will be the last row
which you can access by <code>index[-1]</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 67%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> fa24-midterm — Q11</p>
<h2 id="problem-8">Problem 8</h2>
<p>As in the last problem, we’ll continue working with the
<code>tot</code> DataFrame that came from merging <code>trick</code>
with <code>treat</code>. The <code>"price"</code> column contains the
cost in dollars of a <strong>single piece</strong> of fun-sized candy,
as a <code>float</code>.</p>
<p>In this problem, we want to use <code>tot</code> to calculate the
<strong>average cost per piece</strong> of Halloween candy at each
house. For example, suppose one house has 30 Twix, which cost <span
class="math inline">\$0.20</span> each, and 20 Laffy Taffy, which cost
<span class="math inline">\$0.10</span> each. Then this house spent
<span class="math inline">\$8.00</span> on 50 pieces of candy, for an
average cost of <span class="math inline">\$0.16</span> per piece.</p>
<p>Which of the following correctly sets <code>ac</code> to a DataFrame
indexed by <code>"address"</code> with a column called
<code>"avg_cost"</code> that contains the average cost per piece of
Halloween candy at each address? Select all that apply.</p>
<p>Way 1:</p>
<pre><code>ac = tot.groupby(&quot;address&quot;).sum()
ac = ac.assign(avg_cost = ac.get(&quot;price&quot;) / 
                          ac.get(&quot;how_many&quot;)).get([&quot;avg_cost&quot;])</code></pre>
<p>Way 2:</p>
<pre><code>ac = tot.assign(x = tot.get(&quot;price&quot;) / tot.get(&quot;how_many&quot;))
ac = ac.groupby(&quot;address&quot;).sum()
ac = ac.assign(avg_cost = ac.get(&quot;x&quot;).mean()).get([&quot;avg_cost&quot;])</code></pre>
<p>Way 3:</p>
<pre><code>ac = tot.assign(x = tot.get(&quot;price&quot;) / tot.get(&quot;how_many&quot;))
ac = ac.groupby(&quot;address&quot;).sum()
ac = ac.assign(avg_cost = ac.get(&quot;x&quot;) / 
                          ac.get(&quot;how_many&quot;)).get([&quot;avg_cost&quot;])</code></pre>
<p>Way 4:</p>
<pre><code>ac = tot.assign(x = tot.get(&quot;how_many&quot;) * tot.get(&quot;price&quot;))
ac = ac.groupby(&quot;address&quot;).sum()
ac = ac.assign(avg_cost = ac.get(&quot;x&quot;).mean()).get([&quot;avg_cost&quot;])</code></pre>
<p>Way 5:</p>
<pre><code>ac = tot.assign(x = tot.get(&quot;how_many&quot;) * tot.get(&quot;price&quot;))
ac = ac.groupby(&quot;address&quot;).sum()
ac = ac.assign(avg_cost = ac.get(&quot;x&quot;) / 
                          ac.get(&quot;how_many&quot;)).get([&quot;avg_cost&quot;])</code></pre>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> Way 1</p></li>
<li><p><input type="checkbox" disabled="" /> Way 2</p></li>
<li><p><input type="checkbox" disabled="" /> Way 3</p></li>
<li><p><input type="checkbox" disabled="" /> Way 4</p></li>
<li><p><input type="checkbox" disabled="" /> Way 5</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8" aria-expanded="true" aria-controls="collapse8">
Click to view the solution.
</button>
</h2>
<div id="collapse8" class="accordion-collapse collapse"
aria-labelledby="heading8" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Option 5</p>
<p>We need the average cost per piece at each house.</p>
<p>The correct formula would be: (total spent on candy) / (total pieces
of candy)</p>
<p>Let’s go through each Way and assess if it is valid or not.</p>
<p><strong>Way 1</strong>: When we sum the “price” column directly,
we’re summing the per-piece prices, not the total spent. This gives
wrong totals. For example, if a house has 30 pieces at $0.20 and 20 at
$0.10, summing prices gives $0.30 instead of $8.00.</p>
<p><strong>Way 2</strong>: This first calculates price/quantity for each
candy type, then takes the mean of these ratios. This is mathematically
incorrect for finding average cost per piece.</p>
<ul>
<li>For Twix: $0.20/30 = $0.00667 per piece</li>
<li>For Laffy Taffy: $0.10/20 = $0.005 per piece</li>
<li>Takes mean: ($0.00667 + $0.005)/2 = $0.00583</li>
<li>This is wrong because it’s taking mean of ratios instead of ratio of
totals</li>
</ul>
<p><strong>Way 3</strong>: Similar to Way 2, but even more problematic
as it divides by quantity twice.</p>
<ul>
<li>For Twix: $0.20/30 = $0.00667</li>
<li>For Laffy Taffy: $0.10/20 = $0.005</li>
<li>Sums these: $0.00667 + $0.005 = $0.01167</li>
<li>Divides by total quantity again: $0.01167/50 = $0.000233</li>
</ul>
<p><strong>Way 4</strong>: Correctly calculates total spent (x =
quantity * price) but then takes the mean of the totals instead of
dividing by total quantity.</p>
<ul>
<li>For Twix: 30 × $0.20 = $6.00</li>
<li>For Laffy Taffy: 20 × $0.10 = $2.00</li>
<li>Takes mean of these totals: ($6.00 + $2.00)/2 = $4.00 (wrong)</li>
<li>This is wrong because it takes mean of totals instead of dividing by
total quantity</li>
</ul>
<p><strong>Way 5</strong>: This is correct because:</p>
<ul>
<li>First calculates total spent on each candy type (quantity * price
per piece)</li>
<li>Groups by address and sums both the total spent and total
quantities</li>
<li>Finally divides total spent by total pieces to get average cost per
piece</li>
</ul>
<p>Using our example:</p>
<ul>
<li>30 Twix at $0.20 = $6.00</li>
<li>20 Laffy Taffy at $0.10 = $2.00</li>
<li>Total spent = $8.00</li>
<li>Total pieces = 50</li>
<li>Average = $8.00/50 = $0.16 per piece, the correct answer.</li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 71%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> fa24-midterm — Q13</p>
<h2 id="problem-9">Problem 9</h2>
<p><strong>Extra Credit</strong></p>
<p>Define the variable <code>double</code> as follows.</p>
<p><code>double = treat.groupby("candy").count().groupby("address").count()</code></p>
<p>Now, suppose you know that</p>
<p><code>double.loc[1].get("how_many")</code> evaluates to
<code>5</code>.</p>
<p>Which of the following is a valid interpretation of this information?
Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> There are five houses that are each giving out only one type of
candy.</p></li>
<li><p><input type="checkbox" disabled="" /> There are five types of candy that are each being given out by only
one house.</p></li>
<li><p><input type="checkbox" disabled="" /> There is only one house that is giving out five types of candy.</p></li>
<li><p><input type="checkbox" disabled="" /> There is only one type of candy that is being given out by five
houses.</p></li>
<li><p><input type="checkbox" disabled="" /> None of these.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9" aria-expanded="true" aria-controls="collapse9">
Click to view the solution.
</button>
</h2>
<div id="collapse9" class="accordion-collapse collapse"
aria-labelledby="heading9" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Option 2</p>
<p>Let’s approach this solution by breaking down the line of code into
two intermediate steps, so that we can parse them one at a time:</p>
<ul>
<li><code>intermediate_one = treat.groupby("candy").count()</code></li>
<li><code>double = intermediate_one.groupby("address").count()</code></li>
</ul>
<p><strong>Step 1</strong>:
<code>intermediate_one = treat.groupby("candy").count()</code></p>
<p>The first of our two operations groups the <code>treat</code>
DataFrame by the <code>"candy"</code> column, and aggregates using the
<code>.count()</code> method. This creates an output DataFrame that is
indexed by <code>"candy"</code>, where the values in each column
represent the number of times each candy appeared in the
<code>treat</code> DataFrame.</p>
<p>Remember, in our original DataFrame, each row represents one type of
candy being given out by one house. So, each row in
<code>intermediate_one</code> will contain the <strong>number of houses
giving out each candy</strong>. For example, if the values in the
columns in the row with row label <code>Milky Way</code> were all <span class="math inline">3</span>, it would mean that there are <span class="math inline">3</span> houses giving out Milky Ways.</p>
<p><strong>Step 2</strong>:
<code>double = intermediate_one.groupby("address").count()</code></p>
<p>The second of our two operations groups the
<code>intermediate_one</code> DataFrame by the <code>"address"</code>
column, and aggregates using the <code>.count()</code> method. This
creates an output DataFrame that is indexed by <code>"address"</code>,
where the values in each column represent the number of times that each
value in the address column appeared in the
<code>intermediate_one</code> DataFrame. However, these are more
difficult to interpret, so let’s break down what this means in the
context of our problem.</p>
<p>The values in the <code>intermediate_one</code> DataFrame represent
how many houses are giving out a specific type of candy (this is the
result of our first operation). So, when we group by these values, the
resulting groups will be defined by all candies that are given out by
the same number of houses. For example, if the values in the columns
with row label <code>5</code> were all <span class="math inline">2</span>, it would mean that there are <span class="math inline">2</span> types of candy that are being given out by
<span class="math inline">5</span> houses. More concretely, this would
mean that the value <span class="math inline">5</span> showed up <span class="math inline">2</span> times in the <code>intermediate_one</code>
DataFrame, which means there must have been <span class="math inline">2</span> candies that were being given out by <span class="math inline">5</span> houses (see above).</p>
<p>Combining these two results, we can interpret the output of our
original line of code:</p>
<p><code>double = treat.groupby("candy").count().groupby("address").count()</code>
outputs a DataFrame where the value in each row represents the number of
different candies that are being given out by the same number of
houses.</p>
<p>Now, we can easily interpret this line of code:</p>
<p><code>double.loc[1].get("how_many")</code> evaluates to
<code>5</code>.</p>
<p>This means that there are <span class="math inline">5</span>
different types of candies that are being given out by only <span class="math inline">1</span> house. This corresponds to <strong>Option
2</strong> and only Option <span class="math inline">2</span> in our
answer choices, so <strong>Option 2</strong> is the correct answer.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 15%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p>Complete the expression below so that it evaluates to a DataFrame
indexed by <code>'category'</code> with one column called
<code>'price'</code> containing the median cost of the products in each
category.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ikea.___(a)___.get(___(b)___)</span></code></pre></div>
<p><br></p>
<h3 id="problem-10.1">Problem 10.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_1" aria-expanded="true" aria-controls="collapse10_1">
Click to view the solution.
</button>
</h2>
<div id="collapse10_1" class="accordion-collapse collapse"
aria-labelledby="heading10_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>groupby('category').median()</code></p>
<p>The question prompt says that the resulting DataFrame should be
indexed by <code>'category'</code>, so this is a hint that we may want
to group by <code>'category'</code>. When using <code>groupby</code>, we
need to specify an aggregation function, and since we’re looking for the
median cost of all products in a category, we use the
<code>.median()</code> aggregation function.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 90%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-10.2">Problem 10.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_2" aria-expanded="true" aria-controls="collapse10_2">
Click to view the solution.
</button>
</h2>
<div id="collapse10_2" class="accordion-collapse collapse"
aria-labelledby="heading10_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>['price']</code></p>
<p>The question prompt also says that the resulting DataFrame should
have just one column, the <code>'price'</code> column. To keep only
certain columns in a DataFrame, we use <code>.get</code>, passing in a
list of columns to keep. Remember to include the square brackets,
otherwise <code>.get</code> will return a Series instead of a
DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p>Write one line of code below to create a DataFrame called
<code>openers</code> containing the artists that appeared first on stage
at a past Sun God festival. The DataFrame <code>openers</code> should
have all the same columns as <code>sungod</code>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11" aria-expanded="true" aria-controls="collapse11">
Click to view the solution.
</button>
</h2>
<div id="collapse11" class="accordion-collapse collapse"
aria-labelledby="heading11" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>openers = sungod[sungod.get('Appearance_Order')==1]</code></p>
<p>Since we want only certain rows of <code>sungod</code>, we need to
query. The condition to satisfy is that the
<code>'Appearance_Order'</code> column should have a value of 1 to
indicate that this artist performed first in a certain year’s
festival.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-12">Problem 12</h2>
<p>What was the largest number of artists that ever performed in a
single Sun God festival? <strong>Select all expressions that evaluate to
the correct answer.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Appearance_Order').count().get('Year').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Year').count().get('Artist').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.get('Appearance_Order').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>sungod.groupby('Year').max().get('Year').max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading12">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12" aria-expanded="true" aria-controls="collapse12">
Click to view the solution.
</button>
</h2>
<div id="collapse12" class="accordion-collapse collapse"
aria-labelledby="heading12" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>sungod.groupby('Year').count().get('Artist').max()</code>,
<code>sungod.get('Appearance_Order').max()</code></p>
<p>Let’s go through all the answer choices.</p>
<p>For the first option,
<code>sungod.groupby('Appearance_Order').count()</code> will create a
DataFrame with one row for each unique value of
<code>'Appearance_Order'</code>, and each column will contain the same
value, which represents the number of Sun God festivals that had at
least a certain amount of performers. For example, the first row of
<code>sungod.groupby('Appearance_Order').count()</code> will correspond
to an <code>'Appearance_Order'</code> of 1, and each column will contain
a count of the number of Sun God festivals with at least one performer.
Since every festival has at least one performer, the largest count in
any column, including <code>'Year'</code> will be in this first row. So
<code>sungod.groupby('Appearance_Order').count().get('Year').max()</code>
represents the total number of Sun God festivals, which is not the
quantity we’re trying to find.</p>
<p>For the second option, <code>sungod.groupby('Year').count()</code>
will create a DataFrame with one row per year, with each column
containing a count of the number of artists that performed in that
year’s festival. If we take the largest such count in any one column, we
are finding the largest number of artists that ever performed in a
single Sun God festival. Therefore,
<code>sungod.groupby('Year').count().get('Artist').max()</code> is
correct.</p>
<p>The third option works because we can find the desired quantity by
simply looking for the largest value in the
<code>'Appearance_Order'</code> column. For example, if the largest
number of artists to ever perform in a Sun God festival was, say, 17,
then for that year’s festival, the last artist to appear would have a
value of 17 in the <code>'Appearance_Order'</code> column. There can be
no 18 anywhere in the <code>'Appearance_Order'</code> column, otherwise
that would mean there was some festival with 18 performers. Therefore,
<code>sungod.get('Appearance_Order').max()</code> is correct.</p>
<p>The fourth option is not even correct Python code. The DataFrame
produced by <code>sungod.groupby('Year').max()</code> is indexed by
<code>'Year'</code> and no longer has <code>'Year'</code> as a column.
So we’d get an error if we tried to access this nonexistent column, as
in <code>sungod.groupby('Year').max().get('Year')</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-13">Problem 13</h2>
<p><br></p>
<h3 id="problem-13.1">Problem 13.1</h3>
<p>We’d like to find the mean number of Instagram followers of all
students in DSC 10. One <strong>correct</strong> way to do so is given
below.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    mean_1 <span class="op">=</span> survey.get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span></code></pre></div>
<p>Another two <strong>possible</strong> ways to do this are given
below.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 1.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    mean_2 <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).mean().get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 2.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).<span class="bu">sum</span>().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).count().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    mean_3 <span class="op">=</span> X <span class="op">/</span> Y</span></code></pre></div>
<p>Is <code>mean_2</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<p>Is <code>mean_3</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading13_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse13_1" aria-expanded="true" aria-controls="collapse13_1">
Click to view the solution.
</button>
</h2>
<div id="collapse13_1" class="accordion-collapse collapse"
aria-labelledby="heading13_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p><strong>Is <code>mean_2</code> is equal to <code>mean_1</code>? Yes,
if both sections have the same number of students, otherwise
maybe.</strong></p>
<p><code>mean_2</code> is the “mean of means” – it finds the mean number
of <code>"IG Followers"</code> for each section, then finds the mean of
those two numbers. This is not in general to the overall mean, because
it doesn’t consider the fact that Section A may have more students than
Section B (or vice versa); if this is the case, then Section A needs to
be weighted more heavily in the calculation of the overall mean.</p>
<p>Let’s look at a few examples to illustrate our point. - Suppose
Section A has 2 students who both have 10 followers, and Section B has 1
student who has 5 followers. The overall mean number of followers is
<span class="math inline">\frac{10 + 10 + 5}{3} = 8.33..</span>, while
the mean of the means is <span class="math inline">\frac{10 + 5}{2} =
7.5</span>. These are not the same number, so <code>mean_2</code> is not
always equal to <code>mean_1</code>. We can rule out “Yes” as an option.
- Suppose Section A has 2 students where one has 5 followers and one has
7, and Section B has 2 students where one has 3 followers and one has 15
followers. Then, the overall mean is <span class="math inline">\frac{5 +
7 + 3 + 13}{4} = \frac{28}{4} = 7</span>, while the mean of the means is
<span class="math inline">\frac{\frac{5+7}{2} + \frac{3 + 13}{2}}{2} =
\frac{6 + 8}{2} = 7</span>. If you experiment (or even write out a full
proof), you’ll note that as long as Sections A and B have the same
number of students, the overall mean number of followers across their
two sections is equal to the mean of their section-specific mean numbers
of followers. We can rule out “No” as an option. - Suppose Section A has
2 students who both have 10 followers, and Section B has 3 students who
both have 10 followers. Then, the overall mean is 10, and so is the mean
of means. So, it’s possible for there to be a different number of
students in Sections A and B and for <code>mean_2</code> to be equal to
<code>mean_1</code>. It’s not always, true, though, which is why the
answer is “Yes, if both sections have the same number of students,
otherwise maybe” and we can rule out the “otherwise no” case.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 15%.</p>
<p><br/><br/></p>
<p><strong>Is <code>mean_3</code> is equal to <code>mean_1</code>?
Yes.</strong></p>
<p>Let’s break down the calculations:</p>
<ul>
<li>For <code>X</code>:
<code>survey.groupby("Section").sum().get("IG Followers")</code>
calculates the total number of followers for each section separately.
The subsequent <code>.sum()</code> then adds these totals together,
providing the total number of followers in the entire class.</li>
<li>For <code>Y</code>:
<code>survey.groupby("Section").count().get("IG Followers")</code>
counts the number of students in each section. The subsequent
<code>.sum()</code> then aggregates these counts, giving the total
number of students in the entire class.</li>
</ul>
<p>Then, <code>mean_3 = X / Y</code> divides the total number of
Instagram followers by the total number of students to get the overall
average number of followers per student for the entire dataset. This is
precisely how <code>mean_1</code> is calculated. Hence,
<code>mean_3</code> and <code>mean_1</code> will always be equal, so the
answer is “Yes.”</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 58%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> sp23-midterm — Q1</p>
<h2 id="problem-14">Problem 14</h2>
<p><br></p>
<h3 id="problem-14.1">Problem 14.1</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_1" aria-expanded="true" aria-controls="collapse14_1">
Click to view the solution.
</button>
</h2>
<div id="collapse14_1" class="accordion-collapse collapse"
aria-labelledby="heading14_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: DataFrame</p>
<p>The method <code>.sort_values(by="Class Standing")</code> sorts the
<code>survey</code> DataFrame by the <code>"Class Standing"</code>
column and returns a new DataFrame (without modifying the original one).
The resulting DataFrame will be sorted by class standing in ascending
order unless specified otherwise by providing the
<code>ascending=False</code> argument.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.2">Problem 14.2</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_2" aria-expanded="true" aria-controls="collapse14_2">
Click to view the solution.
</button>
</h2>
<div id="collapse14_2" class="accordion-collapse collapse"
aria-labelledby="heading14_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: DataFrame</p>
<p>The method <code>.sort_values(by="Class Standing")</code> sorts the
<code>survey</code> DataFrame based on the entries in the
<code>"Class Standing"</code> column and produces a new DataFrame.
Following this, <code>.groupby("College")</code> organizes the sorted
DataFrame by grouping entries using the <code>"College"</code> column.
After that, the <code>.count()</code> aggregation method computes the
number of rows for each <code>"College"</code>. The result is a
DataFrame whose index contains the unique values in
<code>"College"</code> and whose columns all contain the same values –
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>.</p>
<p>Note that if we didn’t sort before grouping – that is, if our
expression was just <code>survey.groupby("College").count()</code> – the
resulting DataFrame would be the same! That’s because the order of the
rows in <code>survey</code> does not impact the number of rows in
<code>survey</code> that belong to each <code>"College"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 93%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-14.3">Problem 14.3</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_3" aria-expanded="true" aria-controls="collapse14_3">
Click to view the solution.
</button>
</h2>
<div id="collapse14_3" class="accordion-collapse collapse"
aria-labelledby="heading14_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: Series</p>
<p>The above expression, before <code>.get("IG Followers")</code>, is
the same as in the previous subpart. We know that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>).groupby(<span class="st">"College"</span>).count()</span></code></pre>
</div>
<p>is a DataFrame indexed by <code>"College"</code> with multiple
columns, each of which contain the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>. Then, using <code>.get("IG Followers")</code>
extracts just the <code>"IG Followers"</code> column from the
aforementioned counts DataFrame, and we know that columns are stored as
Series. We know that this column exists, because
<code>survey.sort_values(by="Class Standing").groupby("College").count()</code>
will have the same columns as <code>survey</code>, minus
<code>"College"</code>, which was moved to the index.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 92%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-14.4">Problem 14.4</h3>
<p>What is the type of the following expression?</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a> .iloc[<span class="dv">0</span>]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> list or array</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_4" aria-expanded="true" aria-controls="collapse14_4">
Click to view the solution.
</button>
</h2>
<div id="collapse14_4" class="accordion-collapse collapse"
aria-labelledby="heading14_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: int or float</p>
<p>In the previous subpart, we saw that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>).groupby(<span class="st">"College"</span>).count().get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series whose index contains the unique names of
<code>"College"</code>s and whose values are the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each college.
The number of rows in
<code>survey.sort_values(by="Class Standing")</code> for any particular
college – say, <code>"Sixth"</code> – is a number, and so the values in
this Series are all numbers. As such, the answer is int or float.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-14.5">Problem 14.5</h3>
<p>What <strong>value</strong> does the following expression evaluate
to? If you believe the expression errors, provide a one sentence
explanation of why.</p>
<p>For example, if you think the expression evaluates to an int, don’t
write “int" or”the largest value in the <code>"IG Followers"</code>
column", write the specific int, like “23".</p>
<p><em>Hint: You have enough information to answer the problem; don’t
forget to look at the data description page.</em></p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>.groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>.get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>.index[<span class="dv">0</span>]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_5" aria-expanded="true" aria-controls="collapse14_5">
Click to view the solution.
</button>
</h2>
<div id="collapse14_5" class="accordion-collapse collapse"
aria-labelledby="heading14_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: <code>"ERC"</code></p>
<p>From the previous subpart, we saw that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>.groupby(<span class="st">"College"</span>).count()</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>.get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series, indexed by <code>"College"</code>, whose values contain
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>. When we group by <code>"College"</code>, the
resulting DataFrame (and hence, our Series) is sorted in ascending order
by <code>"College"</code>. This means that the index of our Series is
sorted alphabetically by <code>"College"</code> names. Of the
<code>"College"</code> names mentioned in the data description
(<code>"ERC"</code>, <code>"Marshall"</code>, <code>"Muir"</code>,
<code>"Revelle"</code>, <code>"Seventh"</code>, <code>"Sixth"</code>,
and <code>"Warren"</code>), the first name alphabetically is
<code>"ERC"</code>, so using <code>.index[0]</code> on the above index
gives us <code>"ERC"</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 32%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.6">Problem 14.6</h3>
<p>Consider again the expression from 1.5. Suppose we remove the
piece</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span></code></pre></div>
<p>but keep all other parts the same. Does this change the value the
expression evaluates to?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes, this changes the value the expression evaluates to.</p></li>
<li><p><input type="radio" disabled="" /> No, this does not change the value the expression evaluates to.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_6" aria-expanded="true" aria-controls="collapse14_6">
Click to view the solution.
</button>
</h2>
<div id="collapse14_6" class="accordion-collapse collapse"
aria-labelledby="heading14_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: No, this does not change the value the
expression evaluates to.</p>
<p>We addressed this in the second subpart of the problem: “<em>Note
that if we didn’t sort before grouping – that is, if our expression was
just <code>survey.groupby("College").count()</code> – the resulting
DataFrame would be the same! That’s because the order of the rows in
<code>survey</code> does not impact the number of rows in
<code>survey</code> that belong to each
<code>"College"</code>.</em>”</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 80%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-14.7">Problem 14.7</h3>
<p>What <strong>value</strong> does the following expression evaluate
to? If you believe the expression errors, provide a one sentence
explanation of why.</p>
<p>For example, if you think the expression evaluates to an int, don’t
write “int” or “the largest value in the <code>"IG Followers"</code>
column”, write the specific int, like “23”.</p>
<p><em>Hint: You have enough information to answer the problem; don’t
forget to look at the data description page.</em></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(survey</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a> .sort_values(by<span class="op">=</span><span class="st">&quot;Class Standing&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> .groupby(<span class="st">&quot;College&quot;</span>).count()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a> .get(<span class="st">&quot;IG Followers&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> .loc[<span class="dv">0</span>]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading14_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14_7" aria-expanded="true" aria-controls="collapse14_7">
Click to view the solution.
</button>
</h2>
<div id="collapse14_7" class="accordion-collapse collapse"
aria-labelledby="heading14_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: The code produces an error because, after
the grouping operation, the resulting Series uses the unique college
names as indices, and there isn’t a college named <code>0</code>.</p>
<p>In the previous few subparts, we’ve established that</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode py"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a>survey</span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a>.sort_values(by<span class="op">=</span><span class="st">"Class Standing"</span>)</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a>.groupby(<span class="st">"College"</span>).count()</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a>.get(<span class="st">"IG Followers"</span>)</span></code></pre>
</div>
<p>is a Series, indexed by <code>"College"</code>, whose values contain
the number of rows in
<code>survey.sort_values(by="Class Standing")</code> for each
<code>"College"</code>.</p>
<p>The <code>.loc</code> accessor is used to extract a value from a
Series given its label, or index value. However, since the index values
in the aforementioned Series are <code>"College"</code> names, there is
no value whose index is <code>0</code>, so this throws an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 54%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> sp23-midterm — Q4</p>
<h2 id="problem-15">Problem 15</h2>
<p><br></p>
<h3 id="problem-15.1">Problem 15.1</h3>
<p>Consider the following block of code.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> survey.shape[<span class="dv">0</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> survey.groupby([<span class="st">&quot;Unread Emails&quot;</span>, <span class="st">&quot;IG Followers&quot;</span>]).count().shape[<span class="dv">0</span>]</span></code></pre></div>
<p>Suppose the expression <code>A == B</code> evaluates to
<code>True</code>. Given this fact, what can we conclude?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> There are no two students in the class with the same number of unread
emails.</p></li>
<li><p><input type="radio" disabled="" /> There are no two students in the class with the same number of
Instagram followers.</p></li>
<li><p><input type="radio" disabled="" /> There are no two students in the class with the same number of
Instagram followers, and there are no two students in the class with the
same number of unread emails.</p></li>
<li><p><input type="radio" disabled="" /> There are no two students in the class with both the same number of
unread emails and the same number of Instagram followers.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading15_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15_1" aria-expanded="true" aria-controls="collapse15_1">
Click to view the solution.
</button>
</h2>
<div id="collapse15_1" class="accordion-collapse collapse"
aria-labelledby="heading15_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>: There are no two students in the class with
both the same number of unread emails and the same number of Instagram
followers.</p>
<p>The DataFrame
<code>survey.groupby(["Unread Emails", "IG Followers"]).count()</code>
will have one row for every unique combination of
<code>"Unread Emails"</code> and <code>"IG Followers"</code>. If two
students had the same number of <code>"Unread Emails"</code> and
<code>"IG Followers"</code>, they would be grouped together, resulting
in fewer groups than the total number of students. But since
<code>A == B</code>, it indicates that there are as many unique
combinations of these two columns as there are rows in the
<code>survey</code> DataFrame. Thus, no two students share the same
combination of <code>"Unread Emails"</code> and
<code>"IG Followers"</code>.</p>
<p>Note that if student X has 2 <code>"Unread Emails"</code> and 5
<code>"IG Followers"</code>, student Y has 2
<code>"Unread Emails"</code> and 3 <code>"IG Followers"</code>, and
student Z has 3 <code>"Unread Emails"</code> and 5
<code>"IG Followers"</code>, they all have different combinations of
<code>"Unread Emails"</code> and <code>"IG Followers"</code>, meaning
that they’d all be represented by different rows in
<code>survey.groupby(["Unread Emails", "IG Followers"]).count()</code>.
This is despite the fact that some of their numbers of
<code>"Unread Emails"</code> and <code>"IG Followers"</code> are not
unique.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 72%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-15.2">Problem 15.2</h3>
<p>We’d like to find the mean number of Instagram followers of all
students in DSC 10. One <strong>correct</strong> way to do so is given
below.</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>    mean_1 <span class="op">=</span> survey.get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span></code></pre></div>
<p>Another two <strong>possible</strong> ways to do this are given
below.</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 1.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    mean_2 <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).mean().get(<span class="st">&quot;IG Followers&quot;</span>).mean()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Possible method 2.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).<span class="bu">sum</span>().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> survey.groupby(<span class="st">&quot;Section&quot;</span>).count().get(<span class="st">&quot;IG Followers&quot;</span>).<span class="bu">sum</span>()</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    mean_3 <span class="op">=</span> X <span class="op">/</span> Y</span></code></pre></div>
<p>Is <code>mean_2</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<p>Is <code>mean_3</code> equal to <code>mean_1</code>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
maybe.</p></li>
<li><p><input type="radio" disabled="" /> Yes, if both sections have the same number of students, otherwise
no.</p></li>
<li><p><input type="radio" disabled="" /> No.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading15_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15_2" aria-expanded="true" aria-controls="collapse15_2">
Click to view the solution.
</button>
</h2>
<div id="collapse15_2" class="accordion-collapse collapse"
aria-labelledby="heading15_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer</strong>:</p>
<p><strong>Is <code>mean_2</code> is equal to <code>mean_1</code>? Yes,
if both sections have the same number of students, otherwise
maybe.</strong></p>
<p><code>mean_2</code> is the “mean of means” – it finds the mean number
of <code>"IG Followers"</code> for each section, then finds the mean of
those two numbers. This is not in general to the overall mean, because
it doesn’t consider the fact that Section A may have more students than
Section B (or vice versa); if this is the case, then Section A needs to
be weighted more heavily in the calculation of the overall mean.</p>
<p>Let’s look at a few examples to illustrate our point. - Suppose
Section A has 2 students who both have 10 followers, and Section B has 1
student who has 5 followers. The overall mean number of followers is
<span class="math inline">\frac{10 + 10 + 5}{3} = 8.33..</span>, while
the mean of the means is <span class="math inline">\frac{10 + 5}{2} =
7.5</span>. These are not the same number, so <code>mean_2</code> is not
always equal to <code>mean_1</code>. We can rule out “Yes” as an option.
- Suppose Section A has 2 students where one has 5 followers and one has
7, and Section B has 2 students where one has 3 followers and one has 15
followers. Then, the overall mean is <span class="math inline">\frac{5 +
7 + 3 + 13}{4} = \frac{28}{4} = 7</span>, while the mean of the means is
<span class="math inline">\frac{\frac{5+7}{2} + \frac{3 + 13}{2}}{2} =
\frac{6 + 8}{2} = 7</span>. If you experiment (or even write out a full
proof), you’ll note that as long as Sections A and B have the same
number of students, the overall mean number of followers across their
two sections is equal to the mean of their section-specific mean numbers
of followers. We can rule out “No” as an option. - Suppose Section A has
2 students who both have 10 followers, and Section B has 3 students who
both have 10 followers. Then, the overall mean is 10, and so is the mean
of means. So, it’s possible for there to be a different number of
students in Sections A and B and for <code>mean_2</code> to be equal to
<code>mean_1</code>. It’s not always, true, though, which is why the
answer is “Yes, if both sections have the same number of students,
otherwise maybe” and we can rule out the “otherwise no” case.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 15%.</p>
<p><br/><br/></p>
<p><strong>Is <code>mean_3</code> is equal to <code>mean_1</code>?
Yes.</strong></p>
<p>Let’s break down the calculations:</p>
<ul>
<li>For <code>X</code>:
<code>survey.groupby("Section").sum().get("IG Followers")</code>
calculates the total number of followers for each section separately.
The subsequent <code>.sum()</code> then adds these totals together,
providing the total number of followers in the entire class.</li>
<li>For <code>Y</code>:
<code>survey.groupby("Section").count().get("IG Followers")</code>
counts the number of students in each section. The subsequent
<code>.sum()</code> then aggregates these counts, giving the total
number of students in the entire class.</li>
</ul>
<p>Then, <code>mean_3 = X / Y</code> divides the total number of
Instagram followers by the total number of students to get the overall
average number of followers per student for the entire dataset. This is
precisely how <code>mean_1</code> is calculated. Hence,
<code>mean_3</code> and <code>mean_1</code> will always be equal, so the
answer is “Yes.”</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 58%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> sp24-final — Q15</p>
<h2 id="problem-16">Problem 16</h2>
<p>Imagine a DataFrame constructed from <code>apts</code> called
<code>bedrooms</code>, which has one row for each bedroom in an
apartment in <code>apts</code>. More specifically, a one bedroom
apartment in <code>apts</code> will appear as one row in
<code>bedrooms</code>, a two bedroom apartment in <code>apts</code> will
appear as two rows in <code>bedrooms</code>, and a three bedroom
apartment in <code>apts</code> will appear as three rows in
<code>bedrooms</code>. Studio apartments will not appear in
<code>bedrooms</code> at all.</p>
<p>The <code>"Apartment ID"</code> column of <code>bedrooms</code>
contains the <code>"Apartment ID"</code> of the apartment in
<code>apts</code>. Notice that this is not the index of
<code>bedrooms</code> since these values are no longer unique. The
<code>"Cost"</code> column of <code>bedrooms</code> contains the rent of
the apartment divided by the number of bedrooms. All rows of
<code>bedrooms</code> with a shared <code>"Apartment ID"</code> should
therefore have the same value in the <code>"Cost"</code> column.</p>
<p><br></p>
<h3 id="problem-16.1">Problem 16.1</h3>
<p>Recall that <code>apts</code> has 800 rows. How many rows does
<code>bedrooms</code> have?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 800</p></li>
<li><p><input type="radio" disabled="" /> More than 800.</p></li>
<li><p><input type="radio" disabled="" /> Less than 800.</p></li>
<li><p><input type="radio" disabled="" /> Not enough information.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading16_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse16_1" aria-expanded="true" aria-controls="collapse16_1">
Click to view the solution.
</button>
</h2>
<div id="collapse16_1" class="accordion-collapse collapse"
aria-labelledby="heading16_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Not enough information.</p>
<p>It is entirely possible that <code>bedrooms</code> has more or less
than 800 rows; we don’t have enough info to tell.</p>
<p>If most of the 800 rows in <code>apts</code> are studio apartments,
most rows in <code>apts</code> will not have corresponding rows in
<code>bedrooms</code> (studio apartments are not reflected in
<code>bedrooms</code>). This would lower the total number of rows in
<code>bedrooms</code> to less than 800.</p>
<p>If most of the 800 rows in <code>apts</code> are three-bedroom
apartments, most rows in <code>apts</code> will each have three
corresponding rows in <code>bedrooms</code>. This would increase the
total number of rows in <code>bedrooms</code> to more than 800.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 68%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-16.2">Problem 16.2</h3>
<p>Suppose <code>no_studio</code> is defined as follows. (Remember, we
previously converted the <code>"Beds"</code> column to integers.)</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>no_studio <span class="op">=</span> apts[apts.get(<span class="st">&quot;Bed&quot;</span>) <span class="op">!=</span> <span class="dv">0</span>]</span></code></pre></div>
<p>Which of the following statements evaluate to the same value as the
expression below?</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bedrooms.get(<span class="st">&quot;Cost&quot;</span>).mean()</span></code></pre></div>
<p>Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>no_studio.get("Rent").mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>no_studio.get("Rent").sum() / apts.get("Bed").sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>(no_studio.get("Rent") / no_studio.get("Bed")).mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>(no_studio.get("Rent") / no_studio.get("Bed").sum()).sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>no_studio.get("Rent").mean() / no_studio.get("Bed").mean()</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of these.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading16_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse16_2" aria-expanded="true" aria-controls="collapse16_2">
Click to view the solution.
</button>
</h2>
<div id="collapse16_2" class="accordion-collapse collapse"
aria-labelledby="heading16_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Options 2, 4, and 5.</p>
<p>Let’s refer to <code>bedrooms.get("Cost").mean()</code> as “the
bedroom code” for this solution.</p>
<p>Option 1 is incorrect. Option 1 takes the mean of all non-studio
apartment rents in <code>apts</code>. This value is significantly larger
than what is produced by the bedroom code (average value of the “Cost”
column in <code>bedrooms</code>), since all “Cost” values in
<code>bedrooms</code> are less than or equal to their corresponding
“Rent” values in <code>apts</code>. So, these two expressions cannot be
equal.</p>
<p>Option 2 is correct. We can view the bedroom code as the same as
summing all of the values in the “Cost” column of <code>bedrooms</code>
and dividing by the total number of rows of <code>bedrooms</code>. This
is a fraction; we can make some clever substitutions in this fraction to
show it is the same as the code for Option 2:</p>
<p><br/></p>
<p><span class="math display">\dfrac{\text{sum of ``Cost" in
bedrooms}}{\# \text{ of rows in bedrooms}} \to \dfrac{\text{sum of
``Rent" in no}\_\text{studio}}{\# \text{ of rows in bedrooms}} \to
\dfrac{\text{sum of ``Rent" in no}\_\text{studio}}{\text{sum of
``Bed" in apts}}</span></p>
<p><br/></p>
<p>Option 3 is incorrect. The first part of Option 3,
<code>no_studio.get("Rent") / no_studio.get("Bed")</code>, produces a
Series that contains all the values in the “Cost” column of
<code>no_studio</code>, except without duplicated rows for multi-bed
apartments. Taking the <code>.mean()</code> of this look-alike Series is
not the same as taking the <code>.mean()</code> of the bedroom code, so
these two expressions cannot be equal.</p>
<p>Option 4 is correct. We can show the bedroom code is equivalent to
the code in Option 4 as follows:</p>
<p><br/></p>
<p><span class="math display">\dfrac{\text{sum of ``Cost" in
bedrooms}}{\# \text{ of rows in bedrooms}} \to \dots \to
\dfrac{\text{sum of ``Rent" in no}\_\text{studio}}{\text{sum of
``Bed" in apts}} \to </span></p>
<p><span class="math display"> \dfrac{\text{sum of ``Rent" in
no}\_\text{studio}}{\text{sum of ``Bed" in no}\_\text{studio}} \to
\text{sum} \left( \dfrac{\text{each entry in ``Rent" in
no}\_\text{studio}}{\text{sum of ``Bed" in no}\_\text{studio}}
\right) </span></p>
<p><br/></p>
<p>Option 5 is correct. We can show the bedroom code is equivalent to
the code in Option 5 as follows:</p>
<p><br/></p>
<p><span class="math display">\dfrac{\text{sum of ``Cost" in
bedrooms}}{\# \text{ of rows in bedrooms}} \to \dots \to
\dfrac{\text{sum of ``Rent" in no}\_\text{studio}}{\text{sum of
``Bed" in no}\_\text{studio}} \to</span></p>
<p><span class="math display">\dfrac{\left(\dfrac{\text{sum of
``Rent" in no}\_\text{studio}}{\# \text{ of rows in
no}\_\text{studio}}\right)}{\left(\dfrac{\text{sum of ``Bed" in
no}\_\text{studio}}{\# \text{ of rows in no}\_\text{studio}}\right)} \to
\dfrac{\text{mean of ``Rent" in no}\_\text{studio}}{\text{mean of
``Bed" in no}\_\text{studio}}</span></p>
<p><br/></p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 53%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> sp24-midterm — Q3</p>
<h2 id="problem-17">Problem 17</h2>
<p>Write a Python expression that evaluates to a DataFrame of only your
contacts whose phone numbers end in <code>"6789"</code>.</p>
<p><strong>Note:</strong> Do not use slicing, if you know what that is.
You must use methods from this course.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading17">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse17" aria-expanded="true" aria-controls="collapse17">
Click to view the solution.
</button>
</h2>
<div id="collapse17" class="accordion-collapse collapse"
aria-labelledby="heading17" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>contacts[contacts.get("Phone").str.contains("6789")]</code> or
<code>contacts[contacts.get("Phone").str.contains("-6789")]</code></p>
<ul>
<li><code>contacts.get("Phone")</code>: retrieves the
<code>"Phone"</code> column from the contacts DataFrame as a
Series.</li>
<li><code>.str.contains("6789")</code>: applies a string method that
checks for the presence of the substring <code>"6789"</code> in each
phone number, which could only present in the end of the phone number.
It returns a Boolean Series indicating True for phone numbers containing
this substring.</li>
<li><code>contacts[...]</code>: retrieve all rows where the condition is
True.</li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 63%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> sp25-midterm — Q1</p>
<h2 id="problem-18">Problem 18</h2>
<p><br></p>
<h3 id="problem-18.1">Problem 18.1</h3>
<p>Which country has the highest <code>"Reciprocal Tariff"</code>? Write
one line of code that evaluates to the name of this country.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading18_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse18_1" aria-expanded="true" aria-controls="collapse18_1">
Click to view the solution.
</button>
</h2>
<div id="collapse18_1" class="accordion-collapse collapse"
aria-labelledby="heading18_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>tariffs.sort_values(by="Reciprocal Tariff", ascending=False).get("Country").iloc[0]</code>
or
<code>tariffs.set_index("Country").sort_values(by= Reciprocal Tariff", ascending=False).index[0]</code></p>
<p>To find the country with the highest “Reciprocal Tariff”, we need to
first sort <code>tariffs</code> by the <code>"Reciprocal Tariff"</code>
column in descending order:
<code>tariffs.sort_values(by="Reciprocal Tariff", ascending=False)</code>.
After sorting in descending order, we know that the country with the
highest reciprocal tariff will be in the first row. Then, to get the
name of this country, we select the <code>"Country"</code> column using
<code>.get("Country")</code>. This gives us a Series of countries in
order of descending reciprocal tariffs, and we can access the first
value in this Series by using <code>.iloc[0]</code>. Note that if we
sort in ascending order instead, we can use <code>.iloc[-1]</code> to
access the last value in the Series.</p>
<p>Alternatively, since each country appears only once in
<code>tariffs</code>, we can start by setting the <code>"Country"</code>
column as the index: <code>tariffs.set_index("Country")</code>. Then, we
sort the resulting DataFrame by the <code>"Reciprocal Tariff"</code>
column in descending order, as explained above. Since the country names
are now in the index, the first row of this sorted DataFrame will have
the country with the highest reciprocal tariff as its index value, which
we can access by using <code>.index[0]</code>. Note that if we sort in
ascending order instead, we can use <code>.index[-1]</code> to access
the last value in the index.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 71%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-18.2">Problem 18.2</h3>
<p>How many countries have a <code>"Reciprocal Tariff"</code> above
<span class="math inline">30\%</span>? Write one line of code that
evaluates to the number of such countries.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading18_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse18_2" aria-expanded="true" aria-controls="collapse18_2">
Click to view the solution.
</button>
</h2>
<div id="collapse18_2" class="accordion-collapse collapse"
aria-labelledby="heading18_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>tariffs[tariffs.get("Reciprocal Tariff")&gt;30].shape[0]</code></p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-19">Problem 19</h2>
<p>The following code computes an array containing the unique kinds of
dogs that are heavier than 20 kg <strong>or</strong> taller than 40 cm
on average.</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> df.__(a)__.__(b)__</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>np.array(foo[__(c)__].__d__)</span></code></pre></div>
<p><br></p>
<h3 id="problem-19.1">Problem 19.1</h3>
<p>Fill in blank (a).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19_1" aria-expanded="true" aria-controls="collapse19_1">
Click to view the solution.
</button>
</h2>
<div id="collapse19_1" class="accordion-collapse collapse"
aria-labelledby="heading19_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>groupby('kind')</code></p>
<p>We start this problem by grouping the dataframe by
<code>'kind'</code> since we’re only interested in whether each unique
<code>'kind'</code> of dog fits some sort of constraint. We don’t quite
perform querying yet since we need to group the DataFrame first. In
other words, we first need to group the DataFrame into each
<code>'kind'</code> before we could apply any sort of boolean
conditionals.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 97%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-19.2">Problem 19.2</h3>
<p>Fill in blank (b).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19_2" aria-expanded="true" aria-controls="collapse19_2">
Click to view the solution.
</button>
</h2>
<div id="collapse19_2" class="accordion-collapse collapse"
aria-labelledby="heading19_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.mean()</code></p>
<p>After we do <code>.groupby('kind')</code>, we need to apply
<code>.mean()</code> since the problem asks if each unique
<code>'kind'</code> of dog satisfies certain constraints <strong>on
average</strong>. <code>.mean()</code> calculates the average of each
column of each group which is what we want.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-19.3">Problem 19.3</h3>
<p>Fill in blank (c).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19_3" aria-expanded="true" aria-controls="collapse19_3">
Click to view the solution.
</button>
</h2>
<div id="collapse19_3" class="accordion-collapse collapse"
aria-labelledby="heading19_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>(foo.get('weight') &gt; 20 | foo.get('height') &gt; 40)</code></p>
<p>Once we have grouped the dogs by <code>'kind'</code> and have
calculated the average stats of each kind of dog, we can do some
querying with two conditionals: <code>foo.get('weight') &gt; 20</code>
gets the kinds of dogs that are heavier than 20 kg on average and
<code>foo.get('height') &gt; 40)</code> gets the kinds of dogs that are
taller than 40 cm on average. We combine these two conditions with the
<code>|</code> operator since we want the kind of dogs that satisfy
either condition.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 93%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-19.4">Problem 19.4</h3>
<p>Which of the following should fill in blank (d)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.unique()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get('kind')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get(['kind'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19_4" aria-expanded="true" aria-controls="collapse19_4">
Click to view the solution.
</button>
</h2>
<div id="collapse19_4" class="accordion-collapse collapse"
aria-labelledby="heading19_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.index</code></p>
<p>Note that earlier, we did <code>groupby('kind')</code>, which
automatically sets each unique <code>'kind'</code> as the index. Since
this is what we want anyways, simply doing <code>.index</code> will give
us all the kinds of dogs that satisfy the given conditions.</p>
<p></p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>The average score on this problem was
94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-19.5">Problem 19.5</h3>
<p>Let’s say that right after blank (b), we added
<code>reset_index()</code>. Now, which of the following should fill in
blank (d)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.unique()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get('kind')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get(['kind'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading19_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse19_5" aria-expanded="true" aria-controls="collapse19_5">
Click to view the solution.
</button>
</h2>
<div id="collapse19_5" class="accordion-collapse collapse"
aria-labelledby="heading19_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.get('kind')</code></p>
<p>Now that we have reset the index of the dataframe,
<code>'kind'</code> is once again its own column so we could simply do
<code>.get('kind')</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 100%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-20">Problem 20</h2>
<p>The following code computes an array containing the unique kinds of
dogs that are heavier than 20 kg <strong>or</strong> taller than 40 cm
on average.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> df.__(a)__.__(b)__</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>np.array(foo[__(c)__].__d__)</span></code></pre></div>
<p><br></p>
<h3 id="problem-20.1">Problem 20.1</h3>
<p>Fill in blank (a).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading20_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse20_1" aria-expanded="true" aria-controls="collapse20_1">
Click to view the solution.
</button>
</h2>
<div id="collapse20_1" class="accordion-collapse collapse"
aria-labelledby="heading20_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>groupby('kind')</code></p>
<p>We start this problem by grouping the dataframe by
<code>'kind'</code> since we’re only interested in whether each unique
<code>'kind'</code> of dog fits some sort of constraint. We don’t quite
perform querying yet since we need to group the DataFrame first. In
other words, we first need to group the DataFrame into each
<code>'kind'</code> before we could apply any sort of boolean
conditionals.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 97%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-20.2">Problem 20.2</h3>
<p>Fill in blank (b).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading20_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse20_2" aria-expanded="true" aria-controls="collapse20_2">
Click to view the solution.
</button>
</h2>
<div id="collapse20_2" class="accordion-collapse collapse"
aria-labelledby="heading20_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.mean()</code></p>
<p>After we do <code>.groupby('kind')</code>, we need to apply
<code>.mean()</code> since the problem asks if each unique
<code>'kind'</code> of dog satisfies certain constraints <strong>on
average</strong>. <code>.mean()</code> calculates the average of each
column of each group which is what we want.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-20.3">Problem 20.3</h3>
<p>Fill in blank (c).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading20_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse20_3" aria-expanded="true" aria-controls="collapse20_3">
Click to view the solution.
</button>
</h2>
<div id="collapse20_3" class="accordion-collapse collapse"
aria-labelledby="heading20_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong>
<code>(foo.get('weight') &gt; 20 | foo.get(</code>height<code>) &gt; 40)</code></p>
<p>Once we have grouped the dogs by <code>'kind'</code> and have
calculated the average stats of each kind of dog, we can do some
querying with two conditionals: <code>foo.get('weight') &gt; 20</code>
gets the kinds of dogs that are heavier than 20 kg on average and
<code>foo.get('height') &gt; 40)</code> gets the kinds of dogs that are
taller than 40 cm on average. We combine these two conditions with the
<code>|</code> operator since we want the kind of dogs that satisfy
either condition.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 93%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-20.4">Problem 20.4</h3>
<p>Which of the following should fill in blank (d)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>.index</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.unique()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get('kind')</code></p></li>
<li><p><input type="radio" disabled="" /> <code>.get(['kind'])</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading20_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse20_4" aria-expanded="true" aria-controls="collapse20_4">
Click to view the solution.
</button>
</h2>
<div id="collapse20_4" class="accordion-collapse collapse"
aria-labelledby="heading20_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.index</code></p>
<p>Note that earlier, we did <code>groupby('kind')</code>, which
automatically sets each unique <code>'kind'</code> as the index. Since
this is what we want anyways, simply doing <code>.index</code> will give
us all the kinds of dogs that satisfy the given conditions.</p>
<p></p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>The average score on this problem was
94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-21">Problem 21</h2>
<p>The following code computes the breed of the cheapest toy dog.</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df[__(a)__].__(b)__.__(c)__</span></code></pre></div>
<p><br></p>
<h3 id="problem-21.1">Problem 21.1</h3>
<p>Fill in part (a).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading21_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse21_1" aria-expanded="true" aria-controls="collapse21_1">
Click to view the solution.
</button>
</h2>
<div id="collapse21_1" class="accordion-collapse collapse"
aria-labelledby="heading21_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>df.get('kind') == 'toy'</code></p>
<p>To find the cheapest toy dog, we can start by narrowing down our
dataframe to only include dogs that are of kind toy. We do this by
constructing the following boolean condition:
<code>df.get('kind') == 'toy'</code>, which will check whether a dog is
of kind toy (i.e. whether or not a given row’s <code>'kind'</code> value
is equal to <code>'toy'</code>). As a result,
<code>df[df.get('kind') == 'toy']</code> will retrieve all rows for
which the <code>'kind'</code> column is equal to <code>'toy'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-21.2">Problem 21.2</h3>
<p>Fill in part (b).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading21_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse21_2" aria-expanded="true" aria-controls="collapse21_2">
Click to view the solution.
</button>
</h2>
<div id="collapse21_2" class="accordion-collapse collapse"
aria-labelledby="heading21_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>.sort_values('price')</code></p>
<p>Next, we can sort the resulting dataframe by price, which will make
the minimum price (i.e. the cheapest toy dog) easily accessible to us
later on. To sort the dataframe, simply use <code>.sort_values()</code>,
with parameter <code>'price'</code> as follows:
<code>.sort_values('price')</code></p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-21.3">Problem 21.3</h3>
<p>Which of the following can fill in blank (c)? <strong>Select all that
apply.</strong></p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>loc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>iloc[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>index[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>min()</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading21_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse21_3" aria-expanded="true" aria-controls="collapse21_3">
Click to view the solution.
</button>
</h2>
<div id="collapse21_3" class="accordion-collapse collapse"
aria-labelledby="heading21_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> <code>index[0]</code></p>
<ul>
<li><code>loc[0]</code>: <code>loc</code> retrieves an element by the
row label, which in this case is by <code>'breed'</code>, not by index
value. Furthermore, <code>loc</code> actually returns the entire row,
which is not what we are looking for. (Note that we are trying to find
the singular <code>'breed'</code> of the cheapest toy dog.)<br/>
</li>
<li><code>iloc[0]</code>: While <code>iloc</code> does retrieve elements
by index position, <code>iloc</code> actually returns the entire row,
which is not what we are looking for.</li>
<li><code>index[0]</code>: Note that since <code>'breed'</code> is the
index column of our dataframe, and since we have already filtered and
sorted the dataframe, simply taking the <code>'breed'</code> at index 0,
or <code>index[0]</code> will return the <code>'breed'</code> of the
cheapest toy dog.</li>
<li><code>min()</code>: <code>min()</code> is a method used to find the
smallest value on a series not a dataframe.</li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 81%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> su24-final — Q1</p>
<h2 id="problem-22">Problem 22</h2>
<p><br></p>
<h3 id="problem-22.1">Problem 22.1</h3>
<p>Fill in the blanks so that the expression below evaluates to the
<em>proportion</em> of stages won by the country with the most stage
wins.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>    stages.groupby(__(i)__).__(ii)__.get(<span class="st">&quot;Type&quot;</span>).__(iii)__ <span class="op">/</span> stages.shape[<span class="dv">0</span>]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_1" aria-expanded="true" aria-controls="collapse22_1">
Click to view the solution.
</button>
</h2>
<div id="collapse22_1" class="accordion-collapse collapse"
aria-labelledby="heading22_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ul>
<li><p><strong>(i)</strong>: <code>"Winner Country"</code><br/>
To calculate the number of stages won by each country, we need to group
the data by the <code>Winner Country</code>. This will allow us to
compute the counts for each group.</p></li>
<li><p><strong>(ii)</strong>: <code>count()</code><br/>
Once the data is grouped, we use the <code>.count()</code> method to
calculate the number of stages won by each country.</p></li>
<li><p><strong>(iii)</strong>: <code>max()</code><br/>
Finds the maximum number of stages won by a single country. Finally, we
divide the maximum stage wins by the total number of stages
(<code>stages.shape[0]</code>) to calculate the proportion of stages won
by the top country.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 90%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-22.2">Problem 22.2</h3>
<p>The distance of a stage alone does not encapsulate its difficulty, as
riders feel more tired as the tour goes on. Because of this, we want to
consider “real distance” a measurement of the length of a stage that
takes into account how far into the tour the riders are. The “real
distance” is calculated with the following process:</p>
<ol type="i">
<li><p>Add one to the stage number.</p></li>
<li><p>Take the square root of the result of (i).</p></li>
<li><p>Multiply the result of (ii) by the raw distance of the
stage.</p></li>
</ol>
<p>Complete the implementation of the function
<code>real_distance</code>, which takes in <code>stages</code> (a
DataFrame), <code>stage</code> (a string, the name of the column
containing stage numbers), and <code>distance</code> (a string, the name
of the column containing stage distances). <code>real_distance</code>
returns a Series containing all of the “real distances” of the stages,
as calculated above.</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> real_distance(stages, stage, distance):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>         ________</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_2" aria-expanded="true" aria-controls="collapse22_2">
Click to view the solution.
</button>
</h2>
<div id="collapse22_2" class="accordion-collapse collapse"
aria-labelledby="heading22_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>return stages.get(distance) * np.sqrt(stages.get(stage) + 1)</code></p>
<ul>
<li><p><strong>(i)</strong>: First, We need to add one to the stage
number. The <code>stage</code> parameter specifies the name of the
column containing the stage numbers. <code>stages.get(stage)</code>
retrieves this column as a Series, and we can directly add 1 to each
element in the series by <code>stages.get(stage) + 1</code></p></li>
<li><p><strong>(ii)</strong>: Then, to take the square root of the
result of (i), we can use
<code>np.sqrt(stages.get(stage) + 1)</code></p></li>
<li><p><strong>(iii)</strong>: Finally, we want to multiply the result
of (ii) by the raw distance of the stage. The <code>distance</code>
parameter specifies the name of the column containing the raw distances
of each stage. <code>stages.get(distance)</code> retrieves this column
as a pandas Series, and we can directly multiply it by
<code>np.sqrt(stages.get(stage) + 1)</code>.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-22.3">Problem 22.3</h3>
<p>Sometimes, stages are repeated in different editions of the Tour de
France, meaning that there are some pairs of <code>"Origin"</code> and
<code>"Destination"</code> that appear more than once in
<code>stages</code>. Fill in the blanks so that the expression below
evaluates how often the most common <code>"Origin"</code> and
<code>"Destination"</code> pair in the <code>stages</code> DataFrame
appears.</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>stages.groupby(__(i)__).__(ii)__.sort_values(by <span class="op">=</span> <span class="st">&quot;Date&quot;</span>).get(<span class="st">&quot;Type&quot;</span>).iloc[__(iii)__]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_3" aria-expanded="true" aria-controls="collapse22_3">
Click to view the solution.
</button>
</h2>
<div id="collapse22_3" class="accordion-collapse collapse"
aria-labelledby="heading22_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ul>
<li><p><strong>(i)</strong>:
<code>["Origin", "Destination"]</code><br/>
To analyze the frequency of stages with the same origin and destination,
we need to group the data by the columns
<code>["Origin", "Destination"]</code>. This groups the stages into
unique pairs of origin and destination.</p></li>
<li><p><strong>(ii)</strong>: <code>count()</code><br/>
After grouping, we apply the <code>.count()</code> method to calculate
how many times each pair of <code>["Origin", "Destination"]</code>
appears in the dataset. The result is the frequency of each
pair.</p></li>
<li><p><strong>(iii)</strong>: <code>-1</code><br/>
After obtaining the frequencies, we sort the resulting groups by their
counts in ascending order (this is the default behavior of
<code>.sort_values()</code>). The most common pair will then be the last
entry in the sorted result. Using <code>.get("Type")</code> extracts the
series of counts, and <code>.iloc[-1]</code> retrieves the count of the
most common pair, which is at the last position of the sorted
series.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-22.4">Problem 22.4</h3>
<p>Fill in the blanks so that the value of <code>mystery_three</code> is
the <code>"Destination"</code> of the longest stage before Stage 12.</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>    mystery <span class="op">=</span> stages[stages.get(__(i)__) <span class="op">&lt;</span> <span class="dv">12</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    mystery_two <span class="op">=</span> mystery.sort_values(by <span class="op">=</span> <span class="st">&quot;Distance&quot;</span>, ascending <span class="op">=</span> __(ii)__)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    mystery_three <span class="op">=</span> mystery_two.get(__(iii)__).iloc[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading22_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse22_4" aria-expanded="true" aria-controls="collapse22_4">
Click to view the solution.
</button>
</h2>
<div id="collapse22_4" class="accordion-collapse collapse"
aria-labelledby="heading22_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ul>
<li><p><strong>(i)</strong>: <code>"Stage"</code><br/>
To filter the DataFrame to include only rows corresponding to stages
before Stage 12, we use the <code>"Stage"</code> column. The condition
<code>stages.get("Stage") &lt; 12</code> creates a boolean mask that
selects only the rows where the stage number is less than 12.</p></li>
<li><p><strong>(ii)</strong>: <code>True</code><br/>
To find the longest stage, the rows need to be sorted by the
<code>"Distance"</code> column. Setting <code>ascending=True</code>
ensures that shorter stages come first and the longest stage appears
last in the sorted DataFrame.</p></li>
<li><p><strong>(iii)</strong>: <code>"Destination"</code><br/>
After sorting, we want to retrieve the <code>"Destination"</code> of the
longest stage. Using <code>.get("Destination")</code> retrieves the
<code>"Destination"</code> column, and <code>.iloc[-1]</code> accesses
the last row in the sorted DataFrame, corresponding to the longest stage
before Stage 12.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 92%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> su24-midterm — Q2</p>
<h2 id="problem-23">Problem 23</h2>
<p>Fill in the blanks so that the expression below evaluates to the
region in the <code>"Region"</code> column that comes first
alphabetically.</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>kart.groupby(___(a)___).count().index.___(b)___</span></code></pre></div>
<p>What goes in (a)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"Ranking"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Team"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Division"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"Region"</code></p></li>
</ul>
<p>What goes in (b)?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>"max()"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"min()"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"len()"</code></p></li>
<li><p><input type="radio" disabled="" /> <code>"split()"</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading23">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse23" aria-expanded="true" aria-controls="collapse23">
Click to view the solution.
</button>
</h2>
<div id="collapse23" class="accordion-collapse collapse"
aria-labelledby="heading23" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ul>
<li><strong>(a)</strong> <code>"Region"</code></li>
<li><strong>(b)</strong> <code>"min()"</code></li>
</ul>
<p>In order to curate a unique list of all the regions in the DataFrame,
we want to <code>groupby</code> <code>“Region"</code>. Using
<code>count()</code> on this will count the number of observations for
each region as a row in the DataFrame which does not really matter here
since we just wanted the unique regions. <code>.index</code> will
retrieve the list of all the unique regions. In order to get the first
alphabetically, we can use <code>min()</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 100%. </p>
<hr/>
<h5>Difficulty:
⭐️⭐️</h5>
<p>The average score on this problem was 81%.</p>
<!-- <hr><h5>Difficulty: ⭐️</h5><p>The average score on this problem was 91%. -->
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> su24-midterm — Q3</p>
<h2 id="problem-24">Problem 24</h2>
<p>Fill in the blanks so that the expression below evaluates to the
<code>"University"</code> of the lowest scoring Division 2 team over the
whole season.</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>kart[__(a)__].__(b)__(__(c)__).get(<span class="st">&quot;University&quot;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading24">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse24" aria-expanded="true" aria-controls="collapse24">
Click to view the solution.
</button>
</h2>
<div id="collapse24" class="accordion-collapse collapse"
aria-labelledby="heading24" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<ul>
<li><strong>(a)</strong>
<code>kart.get("Division") == "Division 2"</code></li>
<li><strong>(b)</strong> <code>sort values</code></li>
<li><strong>(c)</strong> <code>"Total Points"</code> or
<code>by="Total Points"</code></li>
</ul>
<p>First we want to filter the DataFrame for only the Division 2 teams
using <code>kart.get("Division") == "Division 2"</code>.</p>
<p>Since we are interested in the lowest scoring team in this division,
we want to use <code>sort_values</code> on the
<code>"Total Points"</code> column giving
<code>sort_values(by= “Total Points”)</code>. Since we are retrieving
<code>.iloc[0]</code>, i.e. the top row of the DataFrame, we do not have
to specify the order of ranking since the default behavior of
<code>sort_values</code> is ascending.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%. </p>
<hr/>
<h5>Difficulty:
⭐️</h5>
<p>The average score on this problem was 90%. </p>
<hr/>
<h5>Difficulty:
⭐️⭐️</h5>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-25">Problem 25</h2>
<p>Suppose <code>df</code> is a DataFrame and <code>b</code> is any
boolean array whose length is the same as the number of rows of
<code>df</code>.</p>
<p>True or False: For any such boolean array <code>b</code>,
<code>df[b].shape[0]</code> is less than or equal to
<code>df.shape[0]</code>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading25">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse25" aria-expanded="true" aria-controls="collapse25">
Click to view the solution.
</button>
</h2>
<div id="collapse25" class="accordion-collapse collapse"
aria-labelledby="heading25" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> True</p>
<p>The brackets in <code>df[b]</code> perform a query, or filter, to
keep only the rows of <code>df</code> for which <code>b</code> has a
<code>True</code> entry. Typically, <code>b</code> will come from some
condition, such as the entry in a certain column of <code>df</code>
equaling a certain value. Regardless, <code>df[b]</code> contains a
subset of the rows of <code>df</code>, and <code>.shape[0]</code> counts
the number of rows, so <code>df[b].shape[0]</code> must be less than or
equal to <code>df.shape[0]</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 86%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-26">Problem 26</h2>
<p>You are given a DataFrame called <code>books</code> that contains
columns <code>'author'</code> (string), <code>'title'</code> (string),
<code>'num_chapters'</code> (int), and <code>'publication_year'</code>
(int).</p>
<p>Suppose that after doing <code>books.groupby('Author').max()</code>,
one row says</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr>
<th>author</th>
<th>title</th>
<th>num_chapters</th>
<th>publication_year</th>
</tr>
</thead>
<tbody>
<tr>
<td>Charles Dickens</td>
<td>Oliver Twist</td>
<td>53</td>
<td>1838</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="problem-26.1">Problem 26.1</h3>
<p>Based on this data, can you conclude that Charles Dickens is the
alphabetically last of all author names in this dataset?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_1" aria-expanded="true" aria-controls="collapse26_1">
Click to view the solution.
</button>
</h2>
<div id="collapse26_1" class="accordion-collapse collapse"
aria-labelledby="heading26_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>When we group by <code>'Author'</code>, all books by the same author
get aggregated together into a single row. The aggregation function is
applied separately to each other column besides the column we’re
grouping by. Since we’re grouping by <code>'Author'</code> here, the
<code>'Author'</code> column never has the <code>max()</code> function
applied to it. Instead, each unique value in the <code>'Author'</code>
column becomes a value in the index of the grouped DataFrame. We are
told that the Charles Dickens row is just one row of the output, but we
don’t know anything about the other rows of the output, or the other
authors. We can’t say anything about where Charles Dickens falls when
authors are ordered alphabetically (but it’s probably not last!)</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 94%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.2">Problem 26.2</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote
<em>Oliver Twist</em>?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_2" aria-expanded="true" aria-controls="collapse26_2">
Click to view the solution.
</button>
</h2>
<div id="collapse26_2" class="accordion-collapse collapse"
aria-labelledby="heading26_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> Yes</p>
<p>Grouping by <code>'Author'</code> collapses all books written by the
same author into a single row. Since we’re applying the
<code>max()</code> function to aggregate these books, we can conclude
that <em>Oliver Twist</em> is alphabetically last among all books in the
<code>books</code> DataFrame written by Charles Dickens. So Charles
Dickens did write <em>Oliver Twist</em> based on this data.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.3">Problem 26.3</h3>
<p>Based on this data, can you conclude that <em>Oliver Twist</em> has
53 chapters?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_3" aria-expanded="true" aria-controls="collapse26_3">
Click to view the solution.
</button>
</h2>
<div id="collapse26_3" class="accordion-collapse collapse"
aria-labelledby="heading26_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>The key to this problem is that <code>groupby</code> applies the
aggregation function, <code>max()</code> in this case, independently to
each column. The output should be interpreted as follows:</p>
<ul>
<li>Among all books in <code>books</code> written by Charles Dickens,
<em>Oliver Twist</em> is the title that is alphabetically last.</li>
<li>Among all books in <code>books</code> written by Charles Dickens, 53
is the greatest number of chapters.</li>
<li>Among all books in <code>books</code> written by Charles Dickens,
1838 is the latest year of publication.</li>
</ul>
<p>However, the book titled <em>Oliver Twist</em>, the book with 53
chapters, and the book published in 1838 are not necessarily all the
same book. We cannot conclude, based on this data, that <em>Oliver
Twist</em> has 53 chapters.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-26.4">Problem 26.4</h3>
<p>Based on this data, can you conclude that Charles Dickens wrote a
book with 53 chapters that was published in 1838?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Yes</p></li>
<li><p><input type="radio" disabled="" /> No</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading26_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse26_4" aria-expanded="true" aria-controls="collapse26_4">
Click to view the solution.
</button>
</h2>
<div id="collapse26_4" class="accordion-collapse collapse"
aria-labelledby="heading26_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer: </strong> No</p>
<p>As explained in the previous question, the <code>max()</code>
function is applied separately to each column, so the book written by
Charles Dickens with 53 chapters may not be the same book as the book
written by Charles Dickens published in 1838.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 73%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-27">Problem 27</h2>
<p>Below, identify the data type of the result of each of the following
expressions, or select “error” if you believe the expression results in
an error.</p>
<p><br></p>
<h3 id="problem-27.1">Problem 27.1</h3>
<div class="sourceCode" id="cb39"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_1" aria-expanded="true" aria-controls="collapse27_1">
Click to view the solution.
</button>
</h2>
<div id="collapse27_1" class="accordion-collapse collapse"
aria-labelledby="heading27_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p><code>sky</code> is a DataFrame. All the <code>sort_values</code>
method does is change the order of the rows in the Series/DataFrame it
is called on, it does not change the data structure. As such,
<code>sky.sort_values('height')</code> is also a DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 87%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-27.2">Problem 27.2</h3>
<div class="sourceCode" id="cb40"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).loc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_2" aria-expanded="true" aria-controls="collapse27_2">
Click to view the solution.
</button>
</h2>
<div id="collapse27_2" class="accordion-collapse collapse"
aria-labelledby="heading27_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> error</p>
<p><code>sky.sort_values('height')</code> is a DataFrame, and
<code>sky.sort_values('height').get('material')</code> is a Series
corresponding to the <code>'material'</code> column, sorted by
<code>'height'</code> in increasing order. So far, there are no
errors.</p>
<p>Remember, the <code>.loc</code> <em>accessor</em> is used to access
elements in a Series based on their index.
<code>sky.sort_values('height').get('material').loc[0]</code> is asking
for the element in the
<code>sky.sort_values('height').get('material')</code> Series with index
0. However, the index of <code>sky</code> is made up of building names.
Since there is no building named <code>0</code>, <code>.loc[0]</code>
causes an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-27.3">Problem 27.3</h3>
<div class="sourceCode" id="cb41"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_3" aria-expanded="true" aria-controls="collapse27_3">
Click to view the solution.
</button>
</h2>
<div id="collapse27_3" class="accordion-collapse collapse"
aria-labelledby="heading27_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p>As we mentioned above,
<code>sky.sort_values('height').get('material')</code> is a Series
containing values from the <code>'material'</code> column (but sorted).
Remember, there is no element in this Series with an index of 0, so
<code>sky.sort_values('height').get('material').loc[0]</code> errors.
However, <code>.iloc[0]</code> works differently than
<code>.loc[0]</code>; <code>.iloc[0]</code> will give us the first
element in a Series (independent of what’s in the index). So,
<code>sky.sort_values('height').get('material').iloc[0]</code> gives us
back a value from the <code>'material'</code> column, which is made up
of strings, so it gives us a string. (Specifically, it gives us the
<code>'material'</code> type of the skyscraper with the smallest
<code>'height'</code>.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-27.4">Problem 27.4</h3>
<div class="sourceCode" id="cb42"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;floors&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_4" aria-expanded="true" aria-controls="collapse27_4">
Click to view the solution.
</button>
</h2>
<div id="collapse27_4" class="accordion-collapse collapse"
aria-labelledby="heading27_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> int or float</p>
<p>The Series <code>sky.get('floors')</code> is made up of integers, and
<code>sky.get('floors').max()</code> evaluates to the largest number in
the Series, which is also an integer.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-27.5">Problem 27.5</h3>
<div class="sourceCode" id="cb43"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sky.index[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading27_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse27_5" aria-expanded="true" aria-controls="collapse27_5">
Click to view the solution.
</button>
</h2>
<div id="collapse27_5" class="accordion-collapse collapse"
aria-labelledby="heading27_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p><code>sky.index</code> contains the values
<code>'Bayard-Condict Building'</code>,
<code>'The Yacht Club at Portofino'</code>,
<code>'City Investing Building'</code>, etc. <code>sky.index[0]</code>
is then <code>'Bayard-Condict Building'</code>, which is a string.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-28">Problem 28</h2>
<div class="sourceCode" id="cb44"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sky.groupby(<span class="st">&#39;material&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading28">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse28" aria-expanded="true" aria-controls="collapse28">
Click to view the solution.
</button>
</h2>
<div id="collapse28" class="accordion-collapse collapse"
aria-labelledby="heading28" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p>When grouping and using an aggregation method, the result is always a
DataFrame. The DataFrame <code>sky.groupby('material').max()</code>
contains all of the columns in <code>sky</code>, minus
<code>'material'</code>, which has been moved to the index. It contains
one row for each unique <code>'material'</code>.</p>
<p>Note that no columns were “dropped”, as may happen when using
<code>.mean()</code>, because <code>.max()</code> can work on Series’ of
any type. You can take the max of strings, while you cannot take the
mean of strings.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-29">Problem 29</h2>
<p>In this question, we’ll write code to learn more about the
skyscrapers in the beautiful city of San Diego. (Unrelated fun fact –
since the San Diego Airport is so close to downtown, buildings in
downtown San Diego legally cannot be taller than 152 meters.)</p>
<p><br></p>
<h3 id="problem-29.1">Problem 29.1</h3>
<p>Below, fill in the blank to create a DataFrame, named
<code>san_tall</code>, consisting of just the skyscrapers in San Diego
that are over 100 meters tall.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> ______</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>san_tall <span class="op">=</span> sky[(sky.get(<span class="st">&#39;city&#39;</span>) <span class="op">==</span> <span class="st">&#39;San Diego&#39;</span>) <span class="op">&amp;</span> condition]</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading29_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse29_1" aria-expanded="true" aria-controls="collapse29_1">
Click to view the solution.
</button>
</h2>
<div id="collapse29_1" class="accordion-collapse collapse"
aria-labelledby="heading29_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>sky.get('height') &gt; 100</code></p>
<p>We need to query for all of the skyscrapers that satisfy two
conditions – the <code>'city'</code> must be <code>'San Diego'</code>
and the <code>'height'</code> must be above 100. The first condition was
already implemented for us, so we just need to construct a Boolean
Series that implements the second condition.</p>
<p>Here, we want all of the rows where <code>'height'</code> is above
100, so we <code>get</code> the <code>'height'</code> column and compare
it to 100 like so: <code>sky.get('height') &gt; 100</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-29.2">Problem 29.2</h3>
<p>Suppose <code>san_tall</code> from the previous part was created
correctly. Fill in the blanks so that <code>height_many_floors</code>
evaluates to the <strong>height (in meters)</strong> of the skyscraper
with the <strong>most floors</strong>, amongst all skyscrapers in San
Diego that are over 100 meters tall.</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>height_many_floors <span class="op">=</span> san_tall.______.iloc[<span class="dv">0</span>]</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading29_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse29_2" aria-expanded="true" aria-controls="collapse29_2">
Click to view the solution.
</button>
</h2>
<div id="collapse29_2" class="accordion-collapse collapse"
aria-labelledby="heading29_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>sort_values('floors', ascending=False).get('height')</code></p>
<p>The end of the line given to us is <code>.iloc[0]</code>. We know
that <code>.iloc[0]</code> extracts the first element in whatever Series
it is called on, so what comes before <code>.iloc[0]</code> must be a
Series where the first element is the <code>'height'</code> of the
skyscraper with the most floors, among all skyscrapers in San Diego that
are over 100 meters tall. The DataFrame we are working with,
<code>san_tall</code>, already only has skyscrapers in San Diego that
are over 100 meters tall.</p>
<p>This means that in the blank, all we need to do is:</p>
<ol type="1">
<li>Sort skyscrapers by <code>'floors'</code> in decreasing order (so
that the first row is the skyscraper with the most
<code>'floors'</code>).</li>
<li>Extract the <code>'height'</code> column.</li>
</ol>
<p>As such, a complete answer is
<code>height_many_floors = san_tall.sort_values('floors', ascending=False).get('height').iloc[0]</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 74%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-29.3">Problem 29.3</h3>
<p><code>height_many_floors</code>, the value you computed in the
previous part (2.2) was a number.</p>
<p><strong>True or False:</strong> Assuming that the DataFrame
<code>san_tall</code> contains all skyscrapers in San Diego,
<code>height_many_floors</code> is the height (in meters) of the
<strong>tallest</strong> skyscraper in San Diego.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading29_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse29_3" aria-expanded="true" aria-controls="collapse29_3">
Click to view the solution.
</button>
</h2>
<div id="collapse29_3" class="accordion-collapse collapse"
aria-labelledby="heading29_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> False</p>
<p><code>height_many_floors</code> is the height of the skyscraper with
the most <code>'floors'</code>. However, this is not necessarily the
tallest skyscraper (i.e. the skyscraper with the largest
<code>'height'</code>)! Consider the following scenario:</p>
<ul>
<li>Building A: 15 floors, height of 150 feet</li>
<li>Building B: 20 floors, height of 100 feet</li>
</ul>
<p><code>height_many_floors</code> would be 100, but it is not the
<code>'height'</code> of the taller building.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 84%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-30">Problem 30</h2>
<p>Below, identify the data type of the result of each of the following
expressions, or select “error” if you believe the expression results in
an error.</p>
<p><br></p>
<h3 id="problem-30.1">Problem 30.1</h3>
<div class="sourceCode" id="cb47"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;city&#39;</span>).<span class="bu">apply</span>(<span class="bu">len</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading30_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse30_1" aria-expanded="true" aria-controls="collapse30_1">
Click to view the solution.
</button>
</h2>
<div id="collapse30_1" class="accordion-collapse collapse"
aria-labelledby="heading30_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Series</p>
<p>The <code>.apply</code> method takes in a function and evaluates that
function on every element in a Series. Here,
<code>sky.get('city').apply(len)</code> is using the function
<code>len</code> on every element in the Series
<code>sky.get('city')</code>. The result is also a Series, containing
the lengths of the names of each <code>'city'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-30.2">Problem 30.2</h3>
<div class="sourceCode" id="cb48"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;city&#39;</span>).<span class="bu">apply</span>(<span class="bu">max</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading30_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse30_2" aria-expanded="true" aria-controls="collapse30_2">
Click to view the solution.
</button>
</h2>
<div id="collapse30_2" class="accordion-collapse collapse"
aria-labelledby="heading30_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Series</p>
<p>This is a tricky problem!</p>
<p>The function that <code>apply</code> takes in must work on individual
elements in a Series, i.e. it must work with just a single argument. We
saw this in the above subpart, where
<code>sky.get('city').apply(len)</code> applied <code>len</code> on each
<code>'city'</code> name.</p>
<p>Here, we are trying to apply the <code>max</code> function on each
<code>'city'</code> name. The <code>max</code> of a single item does not
work in Python, because taking the <code>max</code> requires comparing
two or more elements. Try it out - in a notebook, run the expression
<code>max(5)</code>, and you’ll see an error. So, if we tried to use
<code>.apply(max)</code> on a Series of numbers, we’d run into an
error.</p>
<p><strong>However</strong>, we are using <code>.apply(max)</code> on a
Series of strings, and it turns out that Python <strong>does</strong>
allow us to take the <code>max</code> of a string! The <code>max</code>
of a string in Python is defined as the last character in the string
alphabetically, so <code>max('hello')</code> evaluates to
<code>'o'</code>. This means that
<code>sky.get('city').apply(max)</code> does actually run without error;
it evaluates to a Series containing the last element in the name of each
<code>'city'</code>.</p>
<p>(This subpart was trickier than we intended – we ended up giving
credit to both “error” and “Series”.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-31">Problem 31</h2>
<p>Below, identify the data type of the result of each of the following
expressions, or select “error” if you believe the expression results in
an error.</p>
<p><br></p>
<h3 id="problem-31.1">Problem 31.1</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_1" aria-expanded="true" aria-controls="collapse31_1">
Click to view the solution.
</button>
</h2>
<div id="collapse31_1" class="accordion-collapse collapse"
aria-labelledby="heading31_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p><code>sky</code> is a DataFrame. All the <code>sort_values</code>
method does is change the order of the rows in the Series/DataFrame it
is called on, it does not change the data structure. As such,
<code>sky.sort_values('height')</code> is also a DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 87%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-31.2">Problem 31.2</h3>
<div class="sourceCode" id="cb50"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).loc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_2" aria-expanded="true" aria-controls="collapse31_2">
Click to view the solution.
</button>
</h2>
<div id="collapse31_2" class="accordion-collapse collapse"
aria-labelledby="heading31_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> error</p>
<p><code>sky.sort_values('height')</code> is a DataFrame, and
<code>sky.sort_values('height').get('material')</code> is a Series
corresponding to the <code>'material'</code> column, sorted by
<code>'height'</code> in increasing order. So far, there are no
errors.</p>
<p>Remember, the <code>.loc</code> <em>accessor</em> is used to access
elements in a Series based on their index.
<code>sky.sort_values('height').get('material').loc[0]</code> is asking
for the element in the
<code>sky.sort_values('height').get('material')</code> Series with index
0. However, the index of <code>sky</code> is made up of building names.
Since there is no building named <code>0</code>, <code>.loc[0]</code>
causes an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-31.3">Problem 31.3</h3>
<div class="sourceCode" id="cb51"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_3" aria-expanded="true" aria-controls="collapse31_3">
Click to view the solution.
</button>
</h2>
<div id="collapse31_3" class="accordion-collapse collapse"
aria-labelledby="heading31_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p>As we mentioned above,
<code>sky.sort_values('height').get('material')</code> is a Series
containing values from the <code>'material'</code> column (but sorted).
Remember, there is no element in this Series with an index of 0, so
<code>sky.sort_values('height').get('material').loc[0]</code> errors.
However, <code>.iloc[0]</code> works differently than
<code>.loc[0]</code>; <code>.iloc[0]</code> will give us the first
element in a Series (independent of what’s in the index). So,
<code>sky.sort_values('height').get('material').iloc[0]</code> gives us
back a value from the <code>'material'</code> column, which is made up
of strings, so it gives us a string. (Specifically, it gives us the
<code>'material'</code> type of the skyscraper with the smallest
<code>'height'</code>.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-31.4">Problem 31.4</h3>
<div class="sourceCode" id="cb52"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;floors&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_4" aria-expanded="true" aria-controls="collapse31_4">
Click to view the solution.
</button>
</h2>
<div id="collapse31_4" class="accordion-collapse collapse"
aria-labelledby="heading31_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> int or float</p>
<p>The Series <code>sky.get('floors')</code> is made up of integers, and
<code>sky.get('floors').max()</code> evaluates to the largest number in
the Series, which is also an integer.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-31.5">Problem 31.5</h3>
<div class="sourceCode" id="cb53"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sky.groupby(<span class="st">&#39;material&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_5" aria-expanded="true" aria-controls="collapse31_5">
Click to view the solution.
</button>
</h2>
<div id="collapse31_5" class="accordion-collapse collapse"
aria-labelledby="heading31_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p>When grouping and using an aggregation method, the result is always a
DataFrame. The DataFrame <code>sky.groupby('material').max()</code>
contains all of the columns in <code>sky</code>, minus
<code>'material'</code>, which has been moved to the index. It contains
one row for each unique <code>'material'</code>.</p>
<p>Note that no columns were “dropped”, as may happen when using
<code>.mean()</code>, because <code>.max()</code> can work on Series’ of
any type. You can take the max of strings, while you cannot take the
mean of strings.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-31.6">Problem 31.6</h3>
<div class="sourceCode" id="cb54"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>sky.index[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading31_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse31_6" aria-expanded="true" aria-controls="collapse31_6">
Click to view the solution.
</button>
</h2>
<div id="collapse31_6" class="accordion-collapse collapse"
aria-labelledby="heading31_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p><code>sky.index</code> contains the values
<code>'Bayard-Condict Building'</code>,
<code>'The Yacht Club at Portofino'</code>,
<code>'City Investing Building'</code>, etc. <code>sky.index[0]</code>
is then <code>'Bayard-Condict Building'</code>, which is a string.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-32">Problem 32</h2>
<p>Below, identify the data type of the result of each of the following
expressions, or select “error” if you believe the expression results in
an error.</p>
<p><br></p>
<h3 id="problem-32.1">Problem 32.1</h3>
<div class="sourceCode" id="cb55"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_1" aria-expanded="true" aria-controls="collapse32_1">
Click to view the solution.
</button>
</h2>
<div id="collapse32_1" class="accordion-collapse collapse"
aria-labelledby="heading32_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p><code>sky</code> is a DataFrame. All the <code>sort_values</code>
method does is change the order of the rows in the Series/DataFrame it
is called on, it does not change the data structure. As such,
<code>sky.sort_values('height')</code> is also a DataFrame.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 87%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.2">Problem 32.2</h3>
<div class="sourceCode" id="cb56"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).loc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_2" aria-expanded="true" aria-controls="collapse32_2">
Click to view the solution.
</button>
</h2>
<div id="collapse32_2" class="accordion-collapse collapse"
aria-labelledby="heading32_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> error</p>
<p><code>sky.sort_values('height')</code> is a DataFrame, and
<code>sky.sort_values('height').get('material')</code> is a Series
corresponding to the <code>'material'</code> column, sorted by
<code>'height'</code> in increasing order. So far, there are no
errors.</p>
<p>Remember, the <code>.loc</code> <em>accessor</em> is used to access
elements in a Series based on their index.
<code>sky.sort_values('height').get('material').loc[0]</code> is asking
for the element in the
<code>sky.sort_values('height').get('material')</code> Series with index
0. However, the index of <code>sky</code> is made up of building names.
Since there is no building named <code>0</code>, <code>.loc[0]</code>
causes an error.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.3">Problem 32.3</h3>
<div class="sourceCode" id="cb57"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sky.sort_values(<span class="st">&#39;height&#39;</span>).get(<span class="st">&#39;material&#39;</span>).iloc[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_3" aria-expanded="true" aria-controls="collapse32_3">
Click to view the solution.
</button>
</h2>
<div id="collapse32_3" class="accordion-collapse collapse"
aria-labelledby="heading32_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p>As we mentioned above,
<code>sky.sort_values('height').get('material')</code> is a Series
containing values from the <code>'material'</code> column (but sorted).
Remember, there is no element in this Series with an index of 0, so
<code>sky.sort_values('height').get('material').loc[0]</code> errors.
However, <code>.iloc[0]</code> works differently than
<code>.loc[0]</code>; <code>.iloc[0]</code> will give us the first
element in a Series (independent of what’s in the index). So,
<code>sky.sort_values('height').get('material').iloc[0]</code> gives us
back a value from the <code>'material'</code> column, which is made up
of strings, so it gives us a string. (Specifically, it gives us the
<code>'material'</code> type of the skyscraper with the smallest
<code>'height'</code>.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.4">Problem 32.4</h3>
<div class="sourceCode" id="cb58"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;city&#39;</span>).<span class="bu">apply</span>(<span class="bu">len</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_4" aria-expanded="true" aria-controls="collapse32_4">
Click to view the solution.
</button>
</h2>
<div id="collapse32_4" class="accordion-collapse collapse"
aria-labelledby="heading32_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Series</p>
<p>The <code>.apply</code> method takes in a function and evaluates that
function on every element in a Series. Here,
<code>sky.get('city').apply(len)</code> is using the function
<code>len</code> on every element in the Series
<code>sky.get('city')</code>. The result is also a Series, containing
the lengths of the names of each <code>'city'</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 79%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.5">Problem 32.5</h3>
<div class="sourceCode" id="cb59"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;city&#39;</span>).<span class="bu">apply</span>(<span class="bu">max</span>)</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_5" aria-expanded="true" aria-controls="collapse32_5">
Click to view the solution.
</button>
</h2>
<div id="collapse32_5" class="accordion-collapse collapse"
aria-labelledby="heading32_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Series</p>
<p>This is a tricky problem!</p>
<p>The function that <code>apply</code> takes in must work on individual
elements in a Series, i.e. it must work with just a single argument. We
saw this in the above subpart, where
<code>sky.get('city').apply(len)</code> applied <code>len</code> on each
<code>'city'</code> name.</p>
<p>Here, we are trying to apply the <code>max</code> function on each
<code>'city'</code> name. The <code>max</code> of a single item does not
work in Python, because taking the <code>max</code> requires comparing
two or more elements. Try it out - in a notebook, run the expression
<code>max(5)</code>, and you’ll see an error. So, if we tried to use
<code>.apply(max)</code> on a Series of numbers, we’d run into an
error.</p>
<p><strong>However</strong>, we are using <code>.apply(max)</code> on a
Series of strings, and it turns out that Python <strong>does</strong>
allow us to take the <code>max</code> of a string! The <code>max</code>
of a string in Python is defined as the last character in the string
alphabetically, so <code>max('hello')</code> evaluates to
<code>'o'</code>. This means that
<code>sky.get('city').apply(max)</code> does actually run without error;
it evaluates to a Series containing the last element in the name of each
<code>'city'</code>.</p>
<p>(This subpart was trickier than we intended – we ended up giving
credit to both “error” and “Series”.)</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 89%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.6">Problem 32.6</h3>
<div class="sourceCode" id="cb60"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sky.get(<span class="st">&#39;floors&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_6" aria-expanded="true" aria-controls="collapse32_6">
Click to view the solution.
</button>
</h2>
<div id="collapse32_6" class="accordion-collapse collapse"
aria-labelledby="heading32_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> int or float</p>
<p>The Series <code>sky.get('floors')</code> is made up of integers, and
<code>sky.get('floors').max()</code> evaluates to the largest number in
the Series, which is also an integer.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.7">Problem 32.7</h3>
<div class="sourceCode" id="cb61"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sky.groupby(<span class="st">&#39;material&#39;</span>).<span class="bu">max</span>()</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_7" aria-expanded="true" aria-controls="collapse32_7">
Click to view the solution.
</button>
</h2>
<div id="collapse32_7" class="accordion-collapse collapse"
aria-labelledby="heading32_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> DataFrame</p>
<p>When grouping and using an aggregation method, the result is always a
DataFrame. The DataFrame <code>sky.groupby('material').max()</code>
contains all of the columns in <code>sky</code>, minus
<code>'material'</code>, which has been moved to the index. It contains
one row for each unique <code>'material'</code>.</p>
<p>Note that no columns were “dropped”, as may happen when using
<code>.mean()</code>, because <code>.max()</code> can work on Series’ of
any type. You can take the max of strings, while you cannot take the
mean of strings.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-32.8">Problem 32.8</h3>
<div class="sourceCode" id="cb62"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>sky.index[<span class="dv">0</span>]</span></code></pre></div>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> int or float</p></li>
<li><p><input type="radio" disabled="" /> Boolean</p></li>
<li><p><input type="radio" disabled="" /> string</p></li>
<li><p><input type="radio" disabled="" /> array</p></li>
<li><p><input type="radio" disabled="" /> Series</p></li>
<li><p><input type="radio" disabled="" /> DataFrame</p></li>
<li><p><input type="radio" disabled="" /> error</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading32_8">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse32_8" aria-expanded="true" aria-controls="collapse32_8">
Click to view the solution.
</button>
</h2>
<div id="collapse32_8" class="accordion-collapse collapse"
aria-labelledby="heading32_8" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> string</p>
<p><code>sky.index</code> contains the values
<code>'Bayard-Condict Building'</code>,
<code>'The Yacht Club at Portofino'</code>,
<code>'City Investing Building'</code>, etc. <code>sky.index[0]</code>
is then <code>'Bayard-Condict Building'</code>, which is a string.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-33">Problem 33</h2>
<p>In this question, we’ll write code to learn more about the
skyscrapers in the beautiful city of San Diego. (Unrelated fun fact –
since the San Diego Airport is so close to downtown, buildings in
downtown San Diego legally cannot be taller than 152 meters.)</p>
<p>Below, fill in the blank to create a DataFrame, named
<code>san_tall</code>, consisting of just the skyscrapers in San Diego
that are over 100 meters tall.</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> ______</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>san_tall <span class="op">=</span> sky[(sky.get(<span class="st">&#39;city&#39;</span>) <span class="op">==</span> <span class="st">&#39;San Diego&#39;</span>) <span class="op">&amp;</span> condition]</span></code></pre></div>
<p>What goes in the blank?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading33">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse33" aria-expanded="true" aria-controls="collapse33">
Click to view the solution.
</button>
</h2>
<div id="collapse33" class="accordion-collapse collapse"
aria-labelledby="heading33" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>sky.get('height') &gt; 100</code></p>
<p>We need to query for all of the skyscrapers that satisfy two
conditions – the <code>'city'</code> must be <code>'San Diego'</code>
and the <code>'height'</code> must be above 100. The first condition was
already implemented for us, so we just need to construct a Boolean
Series that implements the second condition.</p>
<p>Here, we want all of the rows where <code>'height'</code> is above
100, so we <code>get</code> the <code>'height'</code> column and compare
it to 100 like so: <code>sky.get('height') &gt; 100</code>.</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 95%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> wi23-final — Q2</p>
<h2 id="problem-34">Problem 34</h2>
<p>You are unsure whether it would make sense to use
<code>"BGG Rank"</code> as the index of the <code>games</code>
DataFrame, because you are unsure whether this column has duplicate
values. Perhaps, for example, two games are tied and both have a rank of
6.</p>
<p>Select all of the expressions below that evaluate to True when the
<code>"BGG Rank"</code> column could be used as the index (no
duplicates), and False when it could not be used as the index
(duplicates). In other words, these are the expressions that can be used
to detect the presence of duplicate values.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>(games.get("BGG Rank") - np.arange(games.shape[0])).max() == 1</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.groupby("BGG Rank").count().get("Name").max() == 1</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.shape[0] - len(np.unique(games.get("BGG Rank"))) == 0</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>games.get("BGG Rank").max() - games.shape[0] == 0</code></p></li>
</ul>
<p><strong>Note:</strong> We will not set the index of
<code>games</code>, instead we’ll leave it with the default index.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading34">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse34" aria-expanded="true" aria-controls="collapse34">
Click to view the solution.
</button>
</h2>
<div id="collapse34" class="accordion-collapse collapse"
aria-labelledby="heading34" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> Options 2 and 3</p>
<p><strong>Option 2:</strong>
<code>games.groupby(“BGG Rank”).count()</code> gets all of the unique
<code>“BGG Rank”</code>’s and puts them into the index. Then by using
the aggregate function <code>.count()</code> we are able to turn all the
remaining columns into the number of times each <code>“BGG Rank”</code>
appears. Since all of the columns are the same we just need to get one
of them to access the counts. In this case we get the column “Name” by
doing <code>.get(“Name”)</code>. Finally, when we do
<code>.max() == 1</code> we are checking to see if the maximum count for
the number of unique <code>“BGG Rank”</code>’s is one, which would mean
there are no duplicates.</p>
<p><strong>Option 3:</strong> Let’s work from the inside out for this
line of code: <code>len(np.unique(games.get(“BGG Rank”)))</code>. Like
all the others we are getting a Series of <code>“BGG Rank”</code>.
<code>np.unique()</code> gives us an array with unique elements inside
of the Series. When we do <code>len()</code> we are figuring out how
many unique elements there are inside of <code>“BGG Rank”</code>. Recall
<code>games.shape[0]</code> gets us the number of rows in
<code>games</code>. This means that we are trying to see if the number
of rows is the same as the number of unique elements inside of
<code>“BGG Rank”</code>, and if they are then that means they are all
unique and should equal 0.</p>
<p><strong>Option 1:</strong> <code>games.get(“BGG Rank”)</code> will
get you a Series of the <code>“BGG Rank”</code> column.
<code>np.arange(games.shape[0])</code> will create a numpy array that
will go from zero to <code>games.shape[0]</code>, which is the number of
rows in the <code>games</code> DataFrame. So it would look something
like: <code>arr([0, 1, 2, . . ., n])</code>, where <code>n</code> is the
number of rows in <code>games</code>. By doing:
<code>games.get(“BGG Rank”) - np.arange(games.shape[0])</code> one is
decreasing each rank by an increasing factor of one each time. This
essentially gives a Series of numbers, but it doesn’t actually have
anything to do with uniqueness. We are simply finding if the difference
between <code>“BGG Rank”</code> and the numpy array leads to a maximum
of 1. So although the code works it does not tell us if there are
duplicates.</p>
<p><strong>Option 4:</strong> <code>games.get(“BGG Rank”).max()</code>
will give us the maximum element inside of <code>“BGG Rank”</code>.
Note, <code>games.shape[0]</code> gets us the number of rows in
<code>games</code>. We should never make assumptions about what is
inside of <code>“BGG Rank”</code>. This means we don’t know if the
values line up nicely like: 1, 2, 3, . . . <code>games.shape[0]</code>,
so the maximum element could be unique, but be bigger than
<code>games.shape[0]</code>. Knowing this, when we do the whole line for
Option 4 it is not guaranteed to be zero when <code>“BGG Rank”</code> is
unique or not, so it does not detect duplicates.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 76%.</p>
</div>
</div>
</div>
</div>
<hr />
<p class="meta"><em>Source:</em> wi23-midterm — Q3</p>
<h2 id="problem-35">Problem 35</h2>
<p><br></p>
<h3 id="problem-35.1">Problem 35.1</h3>
<p>The DataFrame <code>amelia</code> was created by the code below, and
is shown in its entirety.</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>amelia <span class="op">=</span> (storms[(storms.get(<span class="st">&quot;Name&quot;</span>) <span class="op">==</span> <span class="st">&quot;AMELIA&quot;</span>) <span class="op">&amp;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>         (storms.get(<span class="st">&quot;Year&quot;</span>) <span class="op">==</span> <span class="dv">1978</span>)]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>         .get([<span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Status&quot;</span>, <span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>]))</span></code></pre></div>
<center><img src='../../assets/images/wi23-midterm/q3_wi23-midterm.png' width=45%></center>
<p><br></p>
<p>Use the space provided to show the DataFrame that results from</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>        amelia.groupby(<span class="st">&quot;Status&quot;</span>).<span class="bu">max</span>()</span></code></pre></div>
<p>The column labels should go in the top row, and the row labels
(index) should go in the leftmost row. You may not need to use all the
rows and columns provided.</p>
<center><img src='../../assets/images/wi23-midterm/empty_table.png' width=45%></center>
<p><br></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading35_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse35_1" aria-expanded="true" aria-controls="collapse35_1">
Click to view the solution.
</button>
</h2>
<div id="collapse35_1" class="accordion-collapse collapse"
aria-labelledby="heading35_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong></p>
<table>
<thead>
<tr>
<th>Status</th>
<th>Year</th>
<th>Month</th>
<th>Day</th>
<th>Time</th>
<th>Latitude</th>
<th>Longtitude</th>
</tr>
</thead>
<tbody>
<tr>
<td>TD</td>
<td>1978</td>
<td>8</td>
<td>31</td>
<td>6pm</td>
<td>29.3N</td>
<td>99.2W</td>
</tr>
<tr>
<td>TS</td>
<td>1978</td>
<td>7</td>
<td>31</td>
<td>6am</td>
<td>28.0N</td>
<td>98.2W</td>
</tr>
</tbody>
</table>
<p>Remember that calling <code>.groupby('column name')</code> sets the
column name to the index. This means the <code>'Status'</code> column
will become the new bolded index, which is found in the leftmost column
of the data frame. Another thing to know is Python will organize strings
in the <strong>index</strong> in alphabetical order, so for example
<code>TS</code> and <code>TD</code> both start with <code>T</code>, but
<code>D</code> comes sooner in the alphabet than <code>S</code>, which
makes row <code>TD</code> come <strong>before</strong> row
<code>TS</code>.</p>
<p>Next it is important to look at the <code>.max()</code>, which tells
us that we want the maximum element of each column that correspond to
the unique <code>'Status'</code>. Recall how <code>.max()</code>
interacts with strings: <code>.max()</code> will organize strings in the
columns in descending order, so the last alphabetically/numerically.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 59%.</p>
<p><average></average></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> wi24-final — Q2</p>
<h2 id="problem-36">Problem 36</h2>
<p>Frank X. Kugler has Olympic medals in three sports (wrestling,
weightlifting, and tug of war), which is more sports than any other
Olympic medalist. Furthermore, his medals for all three of these sports
are included in the <code>olympians</code> DataFrame. Fill in the blanks
below so that the expression below evaluates to
<code>"Frank X. Kugler"</code>.</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>                (olympians.groupby(__(a)__).__(b)__</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                          .reset_index()</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                          .groupby(__(c)__).__(d)__</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                          .sort_values(by<span class="op">=</span><span class="st">&quot;Age&quot;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                          .index[<span class="dv">0</span>])</span></code></pre></div>
<p><br></p>
<h3 id="problem-36.1">Problem 36.1</h3>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_1" aria-expanded="true" aria-controls="collapse36_1">
Click to view the solution.
</button>
</h2>
<div id="collapse36_1" class="accordion-collapse collapse"
aria-labelledby="heading36_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>["Name", "Sport"]</code> or
<code>["Sport", "Name"]</code></p>
<p>The question wants us to find the name (Frank X. Kugler) who has
records that correspond to three distinct sports. We know that the same
athlete might have multiple records for a distinct sport if they
participated in the same sport for multiple years. Therefore we should
groupby <code>"Name"</code> and <code>"Sport"</code> to create a
DataFrame with unique Name-Sport pairs. This is a DataFrame that
contains the athletes and their sports (for each athlete, their
corresponding sports are distinct). If an athlete participated in 2
sports, for example, they would have 2 rows corresponding to them in the
DataFrame, 1 row for each distinct sport.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 75%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-36.2">Problem 36.2</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_2" aria-expanded="true" aria-controls="collapse36_2">
Click to view the solution.
</button>
</h2>
<div id="collapse36_2" class="accordion-collapse collapse"
aria-labelledby="heading36_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>.sum()</code> or <code>.mean()</code>
or <code>.min()</code>, etc.</p>
<p>Any aggregation method applied on <code>df.groupby()</code> would
work. We only want to remove cases in which an athlete participates in
the same sport for multiple years, and get unique name-sport pairs.
Therefore, we don’t care about the aggregated numeric value. Notice
<code>.unique()</code> is not correct because it is not an aggregation
method used on dataframe after grouping by. If you use
<code>.unique()</code>, it will give you “AttributeError:
‘DataFrameGroupBy’ object has no attribute ‘unique’”. However,
<code>.unique()</code> can be used after <code>Series.groupby()</code>.
For more info: [link]
(https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.SeriesGroupBy.unique.html)</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 96%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-36.3">Problem 36.3</h3>
<p>What goes in blank (c)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_3" aria-expanded="true" aria-controls="collapse36_3">
Click to view the solution.
</button>
</h2>
<div id="collapse36_3" class="accordion-collapse collapse"
aria-labelledby="heading36_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>"Name"</code></p>
<p>Now after resetting the index, we have <code>"Name"</code> and
<code>"Sport"</code> columns containing unique name-sport pairs. The
objective is to count how many different sports each Olympian has medals
in. To do that, we groupby <code>"Name"</code> and later use the
<code>.count()</code> method. This would give a new DataFrame that has a
count of how many times each name shows up in our previous DataFrame
with unique name-sport pairs.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 81%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-36.4">Problem 36.4</h3>
<p>What goes in blank (d)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading36_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse36_4" aria-expanded="true" aria-controls="collapse36_4">
Click to view the solution.
</button>
</h2>
<div id="collapse36_4" class="accordion-collapse collapse"
aria-labelledby="heading36_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>.count()</code></p>
<p>The <code>.count()</code> method is applied to each group. In this
context, <code>.count()</code> will get the number of entries for each
Olympian across different sports, since the previous steps ensured each
sport per Olympian is uniquely listed (due to the initial groupby on
both <code>"Name"</code> and <code>"Sport"</code>). It does not matter
what we sort_values by, because the
<code>.groupby('Name').count()</code> method will just put a count of
each <code>"Name"</code> in all of the columns, regardless of the column
name or what value was originally in it.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 64%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> wi24-midterm — Q1</p>
<h2 id="problem-37">Problem 37</h2>
<p>Each of the following expressions evaluates to an integer. Determine
the value of that integer, if possible, or circle “not enough
information."</p>
<p><strong>Important</strong>: Before proceeding, make sure to read the
page called <em>Clue</em>: The Murder Mystery Game.</p>
<p><br></p>
<h3 id="problem-37.1">Problem 37.1</h3>
<div class="sourceCode" id="cb67"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(clue.get(<span class="st">&quot;Cardholder&quot;</span>) <span class="op">==</span> <span class="st">&quot;Janine&quot;</span>).<span class="bu">sum</span>() </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_1" aria-expanded="true" aria-controls="collapse37_1">
Click to view the solution.
</button>
</h2>
<div id="collapse37_1" class="accordion-collapse collapse"
aria-labelledby="heading37_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 6</p>
<p>This code counts the number of times that Janine appears in the
<code>Cardholder</code> column. This is because
<code>clue.get("Cardholder") == "Janine"</code> will return a Series of
<code>True</code> and <code>False</code> values of length 22 where
<code>True</code> corresponds to a card belonging to Janine. Since 6
cards were dealt to her, the expression evaluates to 6.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 78%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-37.2">Problem 37.2</h3>
<div class="sourceCode" id="cb68"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>np.count_nonzero(clue.get(<span class="st">&quot;Category&quot;</span>).<span class="bu">str</span>.contains(<span class="st">&quot;p&quot;</span>)) </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_2" aria-expanded="true" aria-controls="collapse37_2">
Click to view the solution.
</button>
</h2>
<div id="collapse37_2" class="accordion-collapse collapse"
aria-labelledby="heading37_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 13</p>
<p>This code counts the number of cells that contain that letter
<code>"p"</code> in the <code>Category</code> column.
<code>clue.get("Category").str.contains("p")</code> will return a Series
that contains <code>True</code> if <code>"p"</code> is part of the entry
in the <code>"Category"</code> column and <code>False</code> otherwise.
The words <code>"suspect"</code> and <code>"weapons"</code> both contain
the letter <code>"p"</code> and since there are 6 and 7 of each
respectively, the expression evaluates to 13.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 75%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-37.3">Problem 37.3</h3>
<div class="sourceCode" id="cb69"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>clue[(clue.get(<span class="st">&quot;Category&quot;</span>) <span class="op">==</span> <span class="st">&quot;suspect&quot;</span>) <span class="op">&amp;</span> (clue.get(<span class="st">&quot;Cardholder&quot;</span>) <span class="op">==</span> <span class="st">&quot;Janine&quot;</span>)].shape[<span class="dv">0</span>] </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_3" aria-expanded="true" aria-controls="collapse37_3">
Click to view the solution.
</button>
</h2>
<div id="collapse37_3" class="accordion-collapse collapse"
aria-labelledby="heading37_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> not enough information</p>
<p>This code first filters only for rows that contain both
<code>"suspect"</code> as the category and <code>"Janine"</code> as the
cardholder and returns the number of rows of that DataFrame with
<code>.shape[0]</code>. However, from the information given, we do not
know how many <code>"suspect"</code> cards Janine has.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 83%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-37.4">Problem 37.4</h3>
<div class="sourceCode" id="cb70"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(clue.take(np.arange(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">3</span>)).index) </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_4" aria-expanded="true" aria-controls="collapse37_4">
Click to view the solution.
</button>
</h2>
<div id="collapse37_4" class="accordion-collapse collapse"
aria-labelledby="heading37_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 5</p>
<p><code>np.arange(5, 20, 3)</code> is the arary
<code>np.array([5, 8, 11, 14, 17])</code>. Recall that
<code>.take</code> will filter the DataFrame to contain only certain
rows, in this case rows 5, 8, 11, 14, and 17. Next, <code>.index</code>
extracts the index of the DataFrame, so the length of the index is the
same as the number of rows contained in the DataFrame. There are 5
rows.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 69%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-37.5">Problem 37.5</h3>
<div class="sourceCode" id="cb71"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(clue[clue.get(<span class="st">&quot;Category&quot;</span>) <span class="op">&gt;=</span> <span class="st">&quot;this&quot;</span>].index) </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_5" aria-expanded="true" aria-controls="collapse37_5">
Click to view the solution.
</button>
</h2>
<div id="collapse37_5" class="accordion-collapse collapse"
aria-labelledby="heading37_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 7</p>
<p>Similarly to the previous problem, we are getting the number of rows
of the DataFrame <code>clue</code> after filtering it.
<code>clue.get("Category") &gt;= "this"</code> returns a Boolean Series
where True is returned when a string in <code>"Category"</code> is
greater than alphabetically than <code>"this"</code>. This only happens
when the string is <code>"weapon"</code>, which occurs 7 times.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 29%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-37.6">Problem 37.6</h3>
<div class="sourceCode" id="cb72"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>clue.groupby(<span class="st">&quot;Cardholder&quot;</span>).count().get(<span class="st">&quot;Category&quot;</span>).<span class="bu">sum</span>() </span></code></pre></div>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading37_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse37_6" aria-expanded="true" aria-controls="collapse37_6">
Click to view the solution.
</button>
</h2>
<div id="collapse37_6" class="accordion-collapse collapse"
aria-labelledby="heading37_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> 22</p>
<p><code>groupby("Cardholder").count()</code> will return a DataFrame
indexed by <code>"Cardholder"</code> where each column contains the
number of cards that each <code>"Cardholder"</code> has. Then we sum the
values in the <code>"Category"</code> column, which evaluates to 22
because the sum of the total number of cards each cardholder has is the
total number of cards in play!</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 52%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> wi24-midterm — Q3</p>
<h2 id="problem-38">Problem 38</h2>
<p>An important part of the game is knowing when you’ve narrowed it down
to just one suspect with one weapon in one room. Then you can make your
accusation and win the game!</p>
<p>Suppose the DataFrames <code>grouped</code> and <code>filtered</code>
are defined as follows.</p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>    grouped <span class="op">=</span> (clue.reset_index()</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                   .groupby([<span class="st">&quot;Category&quot;</span>, <span class="st">&quot;Cardholder&quot;</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                   .count()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                   .reset_index())</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    filtered <span class="op">=</span> grouped[grouped.get(<span class="st">&quot;Cardholder&quot;</span>) <span class="op">==</span> <span class="st">&quot;Unknown&quot;</span>]</span></code></pre></div>
<p><br></p>
<h3 id="problem-38.1">Problem 38.1</h3>
<p>Fill in the blank below so that <code>"Ready to accuse"</code> is
printed when Janine has enough information to make an accusation and win
the game.</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filtered.get(<span class="st">&quot;Card&quot;</span>).______ <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Ready to accuse&quot;</span>)</span></code></pre></div>
<p>What goes in the blank?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>count()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>max()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>min()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>shape[0]</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_1" aria-expanded="true" aria-controls="collapse38_1">
Click to view the solution.
</button>
</h2>
<div id="collapse38_1" class="accordion-collapse collapse"
aria-labelledby="heading38_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>sum()</code></p>
<p>It is helpful to first visualize how both the <code>grouped</code>
(left) and <code>filtered</code> (right) DataFrames could look:</p>
<center>
<div style="display: flex;">
<div style="flex: 1; margin-right: 10px;">
<img alt="Image 1" src="../../assets/images/wi24-midterm/grouped.png" style="width: 50%;"/>
<p style="max-width: 50%; overflow: hidden; text-overflow: ellipsis;"><code>grouped</code> DataFrame contains the number of cards for a certain <code>"Category"</code>/<code>"Cardholder"</code> combination.</p>
</div>
<div style="flex: 1; margin-left: 10px;">
<img alt="Image 2" src="../../assets/images/wi24-midterm/filter.png" style="width: 50%;"/>
<p style="max-width: 50%; overflow: hidden; text-overflow: ellipsis;"><code>filtered</code> DataFrame contains the number of cards that are "Unknown" by <code>"room"</code>, <code>"suspect"</code>, and <code>"weapon"</code>.</p>
</div>
</div>
</center>
<p>Now, let’s think about the scenario presented. We want a method that
will return 3 from <code>filtered.get("Card").___</code>. We do not use
<code>count()</code> because that is an aggregation function that
appears after a <code>.groupby</code>, and there is no grouping
here.</p>
<p>According to the instructions, we want to know when we narrowed it
down to <strong>just one suspect with one weapon in one room</strong>.
This means for <code>filtered</code> DataFrame, each row should have 1
in the <code>"Card"</code> column when you are already to accuse.
<code>sum()</code> works because when you have only 1 unknown card for
each of the three categories, that means you have a sum of 3 unknown
cards in total. You can make an accusation now!</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 50%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-38.2">Problem 38.2</h3>
<p>Now, let’s look at a different way to do the same thing. Fill in the
blank below so that <code>"Ready to accuse"</code> is printed when
Janine has enough information to make an accusation and win the
game.</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode py"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filtered.get(<span class="st">&quot;Card&quot;</span>).______ <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Ready to accuse&quot;</span>)</span></code></pre></div>
<p>What goes in the blank?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <code>count()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>sum()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>max()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>min()</code></p></li>
<li><p><input type="radio" disabled="" /> <code>shape[0]</code></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading38_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse38_2" aria-expanded="true" aria-controls="collapse38_2">
Click to view the solution.
</button>
</h2>
<div id="collapse38_2" class="accordion-collapse collapse"
aria-labelledby="heading38_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>max()</code></p>
<p>This problem follows the same logic as the first except we only want
to accuse when <code>filtered.get("Card").___ == 1</code>. As we saw in
the previous part, we only want to accuse when all the numbers in the
<code>"Card"</code> column are 1, as this represents one unknown in each
category. This means the largest number in the <code>"Card"</code>
column must be 1, so we can fill in the blank with
<code>max()</code>.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 40%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<p class="meta"><em>Source:</em> wi25-final — Q2</p>
<h2 id="problem-39">Problem 39</h2>
<p>The Death Eaters are a powerful group of dark wizards who oppose
Harry Potter and his allies. Each Death Eater receives a unique
identification number based on their order of initiation, ranging from
<code>1</code> to <code>N</code>, where <code>N</code> represents the
total number of Death Eaters.</p>
<p>Your task is to estimate the value of <code>N</code> so you can
understand how many enemies you face. You have a random sample of
identification numbers in a DataFrame named <code>death_eaters</code>
containing a single column called <code>"ID"</code>.</p>
<p><br></p>
<h3 id="problem-39.1">Problem 39.1</h3>
<p>Which of the options below would be an appropriate estimate for the
total number of Death Eaters? Select all that apply.</p>
<ul class="task-list">
<li><p><input type="checkbox" disabled="" /> <code>death_eaters.get("ID").max()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>death_eaters.get("ID").sum()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>death_eaters.groupby("ID").count()</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>int(death_eaters.get("ID").mean() * 2)</code></p></li>
<li><p><input type="checkbox" disabled="" /> <code>death_eaters.shape[0]</code></p></li>
<li><p><input type="checkbox" disabled="" /> None of the above.</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_1" aria-expanded="true" aria-controls="collapse39_1">
Click to view the solution.
</button>
</h2>
<div id="collapse39_1" class="accordion-collapse collapse"
aria-labelledby="heading39_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> <code>death_eaters.get("ID").max()</code>
and <code>int(death_eaters.get("ID").mean() * 2)</code></p>
<ul>
<li><p>Option 1: <code>death_eaters.get("ID").max()</code> returns the
maximum ID from the sample. This is an appropriate estimate since the
population size must be at least the size of the largest ID in our
sample. For instance, if the maximum ID observed is 250, then the total
number of Death Eaters must be at least 250.</p></li>
<li><p>Option 2: <code>death_eaters.get("ID").sum()</code> returns the
sum of all ID numbers in the sample. The total sum of IDs has no
meaningful connection to the population size, which makes this an
inappropriate estimate.</p></li>
<li><p>Option 3: <code>death_eaters.groupby("ID").count()</code> groups
the data by ID and counts occurrences. Since each ID is unique and
<code>death_eaters</code> only includes the <code>"ID"</code> column,
grouping simply shows that each ID appears once. This is not an
appropriate estimate for <code>N</code>.</p></li>
<li><p>Option 4: <code>int(death_eaters.get("ID").mean() * 2)</code>
returns twice the mean of the sample IDs as an integer. The mean of a
random sample of the numbers 1 through <code>N</code> usually falls
about halfway between 1 and <code>N</code>. So we can appropriately
estimate <code>N</code> by doubling this mean.</p></li>
<li><p>Option 5: <code>death_eaters.shape[0]</code> returns the number
of rows in <code>death_eaters</code> (ie. the sample size). The sample
size does not reflect the total population size, making it an
inappropriate estimate.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 66%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-39.2">Problem 39.2</h3>
<p>Each box that you selected in part (a) is an example of what?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> a distribution</p></li>
<li><p><input type="radio" disabled="" /> a statistic</p></li>
<li><p><input type="radio" disabled="" /> a parameter</p></li>
<li><p><input type="radio" disabled="" /> a resample</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_2" aria-expanded="true" aria-controls="collapse39_2">
Click to view the solution.
</button>
</h2>
<div id="collapse39_2" class="accordion-collapse collapse"
aria-labelledby="heading39_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong> a statistic</p>
<p>The options in part (a) calculate a numerical value from the random
sample <code>death_eaters</code>. This fits the definition of a
statistic.</p>
<hr/>
<h5>Difficulty: ⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 82%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-39.3">Problem 39.3</h3>
<p>Suppose you have access to a function called <code>estimate</code>,
which takes in a Series of Death Eater ID numbers and returns an
estimate for <code>N</code>. Fill in the blanks below to do the
following:</p>
<ul>
<li><p>Create an array named <code>boot_estimates</code>, containing
10,000 of these bootstrapped estimates of <code>N</code>, based on the
data in <code>death_eaters</code>.</p></li>
<li><p>Set <code>left_72</code> to the <strong>left endpoint</strong> of
a 72% confidence interval for <code>N</code>.</p></li>
</ul>
<!-- -->
<pre><code>    boot_estimates = np.array([])
    
    for i in np.arange(10000):
        boot_estimates = np.append(boot_estimates, __(a)__)

    left_72 = __(b)__
    </code></pre>
<p>What goes in blank (a)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_3" aria-expanded="true" aria-controls="collapse39_3">
Click to view the solution.
</button>
</h2>
<div id="collapse39_3" class="accordion-collapse collapse"
aria-labelledby="heading39_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>estimate(death_eaters.sample(death_eaters.shape[0], replace=True).get("ID"))</code></p>
<p>In the given code, we use a for loop to generate 10,000 bootstrapped
estimates of <code>N</code> and append them to the array
<code>boot_estimates</code>. Blank (a) specifically computes one
bootstrapped estimate of <code>N</code>. Here’s how key parts of the
solution work:</p>
<ul>
<li><p><code>death_eaters.sample(death_eaters.shape[0], replace=True)</code>:
To bootstrap, we need to resample the data with replacement. The
<code>sample()</code> function
<a href="https://dsc-courses.github.io/bpd-reference/docs/statistical-inference/random%20sampling/df.sample()/" target="_blank">(see
here)</a> takes as arguments the sample size
(<code>death_eaters.shape[0]</code>) and whether to replace
(<code>replace=True</code>).</p></li>
<li><p><code>.get("ID")</code>: Since <code>estimate()</code> takes a
Series as input, we need to extract the ID column from the
resample.</p></li>
<li><p><code>estimate()</code>: The resampled ID column is passed into
the <code>estimate()</code> function to generate one bootstrapped
estimate of N.</p></li>
</ul>
<hr/>
<h5>Difficulty: ⭐️⭐️⭐️</h5>
<p>
</p>
<p>The average score on this problem was 62%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-39.4">Problem 39.4</h3>
<p>What goes in blank (b)?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading39_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse39_4" aria-expanded="true" aria-controls="collapse39_4">
Click to view the solution.
</button>
</h2>
<div id="collapse39_4" class="accordion-collapse collapse"
aria-labelledby="heading39_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>Answer:</strong>
<code>np.percentile(boot_estimates, 14)</code></p>
<p>A 72% confidence interval captures the middle 72% of our
distribution. This leaves 28% of the data outside the interval, with 14%
from the lower tail and 14% from the upper tail. Thus, the left endpoint
corresponds to the 14th percentile of <code>boot_estimates</code>. The
<code>np.percentile()</code> function
<a href="https://dsc-courses.github.io/bpd-reference/docs/documentation/arrays-and-numpy/np.percentile()/" target="_blank">(see
here)</a> takes as arguments the array to compute the percentile
(<code>boot_estimates</code>) and the desired percentile (14).</p>
<hr/>
<h5>Difficulty: ⭐️</h5>
<p>
</p>
<p>The average score on this problem was 91%.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
</body>
</html>
